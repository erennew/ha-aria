var Rr,ge,Dl,_s,Ca,Pl,Il,Rl,Nl,ws,gs,xs,Ol,Ir={},Hl=[],xu=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Nr=Array.isArray;function Yt(e,a){for(var r in a)e[r]=a[r];return e}function ks(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function t(e,a,r){var n,s,o,l={};for(o in a)o=="key"?n=a[o]:o=="ref"?s=a[o]:l[o]=a[o];if(arguments.length>2&&(l.children=arguments.length>3?Rr.call(arguments,2):r),typeof e=="function"&&e.defaultProps!=null)for(o in e.defaultProps)l[o]===void 0&&(l[o]=e.defaultProps[o]);return Dr(e,l,n,s,null)}function Dr(e,a,r,n,s){var o={type:e,props:a,key:r,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++Dl,__i:-1,__u:0};return s==null&&ge.vnode!=null&&ge.vnode(o),o}function V(e){return e.children}function Kt(e,a){this.props=e,this.context=a}function or(e,a){if(a==null)return e.__?or(e.__,e.__i+1):null;for(var r;a<e.__k.length;a++)if((r=e.__k[a])!=null&&r.__e!=null)return r.__e;return typeof e.type=="function"?or(e):null}function zl(e){var a,r;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,a=0;a<e.__k.length;a++)if((r=e.__k[a])!=null&&r.__e!=null){e.__e=e.__c.base=r.__e;break}return zl(e)}}function bs(e){(!e.__d&&(e.__d=!0)&&Ca.push(e)&&!pn.__r++||Pl!=ge.debounceRendering)&&((Pl=ge.debounceRendering)||Il)(pn)}function pn(){for(var e,a,r,n,s,o,l,i=1;Ca.length;)Ca.length>i&&Ca.sort(Rl),e=Ca.shift(),i=Ca.length,e.__d&&(r=void 0,n=void 0,s=(n=(a=e).__v).__e,o=[],l=[],a.__P&&((r=Yt({},n)).__v=n.__v+1,ge.vnode&&ge.vnode(r),Ss(a.__P,r,n,a.__n,a.__P.namespaceURI,32&n.__u?[s]:null,o,s??or(n),!!(32&n.__u),l),r.__v=n.__v,r.__.__k[r.__i]=r,Wl(o,r,l),n.__e=n.__=null,r.__e!=s&&zl(r)));pn.__r=0}function Fl(e,a,r,n,s,o,l,i,u,d,g){var f,m,b,h,C,A,M,_=n&&n.__k||Hl,S=a.length;for(u=bu(r,a,_,u,S),f=0;f<S;f++)(b=r.__k[f])!=null&&(m=b.__i==-1?Ir:_[b.__i]||Ir,b.__i=f,A=Ss(e,b,m,s,o,l,i,u,d,g),h=b.__e,b.ref&&m.ref!=b.ref&&(m.ref&&As(m.ref,null,b),g.push(b.ref,b.__c||h,b)),C==null&&h!=null&&(C=h),(M=!!(4&b.__u))||m.__k===b.__k?u=Bl(b,u,e,M):typeof b.type=="function"&&A!==void 0?u=A:h&&(u=h.nextSibling),b.__u&=-7);return r.__e=C,u}function bu(e,a,r,n,s){var o,l,i,u,d,g=r.length,f=g,m=0;for(e.__k=new Array(s),o=0;o<s;o++)(l=a[o])!=null&&typeof l!="boolean"&&typeof l!="function"?(typeof l=="string"||typeof l=="number"||typeof l=="bigint"||l.constructor==String?l=e.__k[o]=Dr(null,l,null,null,null):Nr(l)?l=e.__k[o]=Dr(V,{children:l},null,null,null):l.constructor===void 0&&l.__b>0?l=e.__k[o]=Dr(l.type,l.props,l.key,l.ref?l.ref:null,l.__v):e.__k[o]=l,u=o+m,l.__=e,l.__b=e.__b+1,i=null,(d=l.__i=hu(l,r,u,f))!=-1&&(f--,(i=r[d])&&(i.__u|=2)),i==null||i.__v==null?(d==-1&&(s>g?m--:s<g&&m++),typeof l.type!="function"&&(l.__u|=4)):d!=u&&(d==u-1?m--:d==u+1?m++:(d>u?m--:m++,l.__u|=4))):e.__k[o]=null;if(f)for(o=0;o<g;o++)(i=r[o])!=null&&(2&i.__u)==0&&(i.__e==n&&(n=or(i)),Ul(i,i));return n}function Bl(e,a,r,n){var s,o;if(typeof e.type=="function"){for(s=e.__k,o=0;s&&o<s.length;o++)s[o]&&(s[o].__=e,a=Bl(s[o],a,r,n));return a}e.__e!=a&&(n&&(a&&e.type&&!a.parentNode&&(a=or(e)),r.insertBefore(e.__e,a||null)),a=e.__e);do a=a&&a.nextSibling;while(a!=null&&a.nodeType==8);return a}function fn(e,a){return a=a||[],e==null||typeof e=="boolean"||(Nr(e)?e.some(function(r){fn(r,a)}):a.push(e)),a}function hu(e,a,r,n){var s,o,l,i=e.key,u=e.type,d=a[r],g=d!=null&&(2&d.__u)==0;if(d===null&&i==null||g&&i==d.key&&u==d.type)return r;if(n>(g?1:0)){for(s=r-1,o=r+1;s>=0||o<a.length;)if((d=a[l=s>=0?s--:o++])!=null&&(2&d.__u)==0&&i==d.key&&u==d.type)return l}return-1}function Ll(e,a,r){a[0]=="-"?e.setProperty(a,r??""):e[a]=r==null?"":typeof r!="number"||xu.test(a)?r:r+"px"}function un(e,a,r,n,s){var o,l;e:if(a=="style")if(typeof r=="string")e.style.cssText=r;else{if(typeof n=="string"&&(e.style.cssText=n=""),n)for(a in n)r&&a in r||Ll(e.style,a,"");if(r)for(a in r)n&&r[a]==n[a]||Ll(e.style,a,r[a])}else if(a[0]=="o"&&a[1]=="n")o=a!=(a=a.replace(Nl,"$1")),l=a.toLowerCase(),a=l in e||a=="onFocusOut"||a=="onFocusIn"?l.slice(2):a.slice(2),e.l||(e.l={}),e.l[a+o]=r,r?n?r.u=n.u:(r.u=ws,e.addEventListener(a,o?xs:gs,o)):e.removeEventListener(a,o?xs:gs,o);else{if(s=="http://www.w3.org/2000/svg")a=a.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(a!="width"&&a!="height"&&a!="href"&&a!="list"&&a!="form"&&a!="tabIndex"&&a!="download"&&a!="rowSpan"&&a!="colSpan"&&a!="role"&&a!="popover"&&a in e)try{e[a]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&a[4]!="-"?e.removeAttribute(a):e.setAttribute(a,a=="popover"&&r==1?"":r))}}function $l(e){return function(a){if(this.l){var r=this.l[a.type+e];if(a.t==null)a.t=ws++;else if(a.t<r.u)return;return r(ge.event?ge.event(a):a)}}}function Ss(e,a,r,n,s,o,l,i,u,d){var g,f,m,b,h,C,A,M,_,S,k,O,L,H,R,W,B,$=a.type;if(a.constructor!==void 0)return null;128&r.__u&&(u=!!(32&r.__u),o=[i=a.__e=r.__e]),(g=ge.__b)&&g(a);e:if(typeof $=="function")try{if(M=a.props,_="prototype"in $&&$.prototype.render,S=(g=$.contextType)&&n[g.__c],k=g?S?S.props.value:g.__:n,r.__c?A=(f=a.__c=r.__c).__=f.__E:(_?a.__c=f=new $(M,k):(a.__c=f=new Kt(M,k),f.constructor=$,f.render=wu),S&&S.sub(f),f.state||(f.state={}),f.__n=n,m=f.__d=!0,f.__h=[],f._sb=[]),_&&f.__s==null&&(f.__s=f.state),_&&$.getDerivedStateFromProps!=null&&(f.__s==f.state&&(f.__s=Yt({},f.__s)),Yt(f.__s,$.getDerivedStateFromProps(M,f.__s))),b=f.props,h=f.state,f.__v=a,m)_&&$.getDerivedStateFromProps==null&&f.componentWillMount!=null&&f.componentWillMount(),_&&f.componentDidMount!=null&&f.__h.push(f.componentDidMount);else{if(_&&$.getDerivedStateFromProps==null&&M!==b&&f.componentWillReceiveProps!=null&&f.componentWillReceiveProps(M,k),a.__v==r.__v||!f.__e&&f.shouldComponentUpdate!=null&&f.shouldComponentUpdate(M,f.__s,k)===!1){for(a.__v!=r.__v&&(f.props=M,f.state=f.__s,f.__d=!1),a.__e=r.__e,a.__k=r.__k,a.__k.some(function(q){q&&(q.__=a)}),O=0;O<f._sb.length;O++)f.__h.push(f._sb[O]);f._sb=[],f.__h.length&&l.push(f);break e}f.componentWillUpdate!=null&&f.componentWillUpdate(M,f.__s,k),_&&f.componentDidUpdate!=null&&f.__h.push(function(){f.componentDidUpdate(b,h,C)})}if(f.context=k,f.props=M,f.__P=e,f.__e=!1,L=ge.__r,H=0,_){for(f.state=f.__s,f.__d=!1,L&&L(a),g=f.render(f.props,f.state,f.context),R=0;R<f._sb.length;R++)f.__h.push(f._sb[R]);f._sb=[]}else do f.__d=!1,L&&L(a),g=f.render(f.props,f.state,f.context),f.state=f.__s;while(f.__d&&++H<25);f.state=f.__s,f.getChildContext!=null&&(n=Yt(Yt({},n),f.getChildContext())),_&&!m&&f.getSnapshotBeforeUpdate!=null&&(C=f.getSnapshotBeforeUpdate(b,h)),W=g,g!=null&&g.type===V&&g.key==null&&(W=jl(g.props.children)),i=Fl(e,Nr(W)?W:[W],a,r,n,s,o,l,i,u,d),f.base=a.__e,a.__u&=-161,f.__h.length&&l.push(f),A&&(f.__E=f.__=null)}catch(q){if(a.__v=null,u||o!=null)if(q.then){for(a.__u|=u?160:128;i&&i.nodeType==8&&i.nextSibling;)i=i.nextSibling;o[o.indexOf(i)]=null,a.__e=i}else{for(B=o.length;B--;)ks(o[B]);hs(a)}else a.__e=r.__e,a.__k=r.__k,q.then||hs(a);ge.__e(q,a,r)}else o==null&&a.__v==r.__v?(a.__k=r.__k,a.__e=r.__e):i=a.__e=_u(r.__e,a,r,n,s,o,l,u,d);return(g=ge.diffed)&&g(a),128&a.__u?void 0:i}function hs(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(hs)}function Wl(e,a,r){for(var n=0;n<r.length;n++)As(r[n],r[++n],r[++n]);ge.__c&&ge.__c(a,e),e.some(function(s){try{e=s.__h,s.__h=[],e.some(function(o){o.call(s)})}catch(o){ge.__e(o,s.__v)}})}function jl(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:Nr(e)?e.map(jl):Yt({},e)}function _u(e,a,r,n,s,o,l,i,u){var d,g,f,m,b,h,C,A=r.props||Ir,M=a.props,_=a.type;if(_=="svg"?s="http://www.w3.org/2000/svg":_=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),o!=null){for(d=0;d<o.length;d++)if((b=o[d])&&"setAttribute"in b==!!_&&(_?b.localName==_:b.nodeType==3)){e=b,o[d]=null;break}}if(e==null){if(_==null)return document.createTextNode(M);e=document.createElementNS(s,_,M.is&&M),i&&(ge.__m&&ge.__m(a,o),i=!1),o=null}if(_==null)A===M||i&&e.data==M||(e.data=M);else{if(o=o&&Rr.call(e.childNodes),!i&&o!=null)for(A={},d=0;d<e.attributes.length;d++)A[(b=e.attributes[d]).name]=b.value;for(d in A)if(b=A[d],d!="children"){if(d=="dangerouslySetInnerHTML")f=b;else if(!(d in M)){if(d=="value"&&"defaultValue"in M||d=="checked"&&"defaultChecked"in M)continue;un(e,d,null,b,s)}}for(d in M)b=M[d],d=="children"?m=b:d=="dangerouslySetInnerHTML"?g=b:d=="value"?h=b:d=="checked"?C=b:i&&typeof b!="function"||A[d]===b||un(e,d,b,A[d],s);if(g)i||f&&(g.__html==f.__html||g.__html==e.innerHTML)||(e.innerHTML=g.__html),a.__k=[];else if(f&&(e.innerHTML=""),Fl(a.type=="template"?e.content:e,Nr(m)?m:[m],a,r,n,_=="foreignObject"?"http://www.w3.org/1999/xhtml":s,o,l,o?o[0]:r.__k&&or(r,0),i,u),o!=null)for(d=o.length;d--;)ks(o[d]);i||(d="value",_=="progress"&&h==null?e.removeAttribute("value"):h!=null&&(h!==e[d]||_=="progress"&&!h||_=="option"&&h!=A[d])&&un(e,d,h,A[d],s),d="checked",C!=null&&C!=e[d]&&un(e,d,C,A[d],s))}return e}function As(e,a,r){try{if(typeof e=="function"){var n=typeof e.__u=="function";n&&e.__u(),n&&a==null||(e.__u=e(a))}else e.current=a}catch(s){ge.__e(s,r)}}function Ul(e,a,r){var n,s;if(ge.unmount&&ge.unmount(e),(n=e.ref)&&(n.current&&n.current!=e.__e||As(n,null,a)),(n=e.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(o){ge.__e(o,a)}n.base=n.__P=null}if(n=e.__k)for(s=0;s<n.length;s++)n[s]&&Ul(n[s],a,r||typeof e.type!="function");r||ks(e.__e),e.__c=e.__=e.__e=void 0}function wu(e,a,r){return this.constructor(e,r)}function Vl(e,a,r){var n,s,o,l;a==document&&(a=document.documentElement),ge.__&&ge.__(e,a),s=(n=typeof r=="function")?null:r&&r.__k||a.__k,o=[],l=[],Ss(a,e=(!n&&r||a).__k=t(V,null,[e]),s||Ir,Ir,a.namespaceURI,!n&&r?[r]:s?null:a.firstChild?Rr.call(a.childNodes):null,o,!n&&r?r:s?s.__e:a.firstChild,n,l),Wl(o,e,l)}function Gl(e,a,r){var n,s,o,l,i=Yt({},e.props);for(o in e.type&&e.type.defaultProps&&(l=e.type.defaultProps),a)o=="key"?n=a[o]:o=="ref"?s=a[o]:i[o]=a[o]===void 0&&l!=null?l[o]:a[o];return arguments.length>2&&(i.children=arguments.length>3?Rr.call(arguments,2):r),Dr(e.type,i,n||e.key,s||e.ref,null)}function ql(e){function a(r){var n,s;return this.getChildContext||(n=new Set,(s={})[a.__c]=this,this.getChildContext=function(){return s},this.componentWillUnmount=function(){n=null},this.shouldComponentUpdate=function(o){this.props.value!=o.value&&n.forEach(function(l){l.__e=!0,bs(l)})},this.sub=function(o){n.add(o);var l=o.componentWillUnmount;o.componentWillUnmount=function(){n&&n.delete(o),l&&l.call(o)}}),r.children}return a.__c="__cC"+Ol++,a.__=e,a.Provider=a.__l=(a.Consumer=function(r,n){return r.children(n)}).contextType=a,a}Rr=Hl.slice,ge={__e:function(e,a,r,n){for(var s,o,l;a=a.__;)if((s=a.__c)&&!s.__)try{if((o=s.constructor)&&o.getDerivedStateFromError!=null&&(s.setState(o.getDerivedStateFromError(e)),l=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(e,n||{}),l=s.__d),l)return s.__E=s}catch(i){e=i}throw e}},Dl=0,_s=function(e){return e!=null&&e.constructor===void 0},Kt.prototype.setState=function(e,a){var r;r=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Yt({},this.state),typeof e=="function"&&(e=e(Yt({},r),this.props)),e&&Yt(r,e),e!=null&&this.__v&&(a&&this._sb.push(a),bs(this))},Kt.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),bs(this))},Kt.prototype.render=V,Ca=[],Il=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Rl=function(e,a){return e.__v.__b-a.__v.__b},pn.__r=0,Nl=/(PointerCapture)$|Capture$/i,ws=0,gs=$l(!1),xs=$l(!0),Ol=0;var Or,He,Cs,Yl,Hr=0,ai=[],Be=ge,Kl=Be.__b,Jl=Be.__r,Zl=Be.diffed,Ql=Be.__c,Xl=Be.unmount,ei=Be.__;function Ms(e,a){Be.__h&&Be.__h(He,e,Hr||a),Hr=0;var r=He.__H||(He.__H={__:[],__h:[]});return e>=r.__.length&&r.__.push({}),r.__[e]}function N(e){return Hr=1,ku(si,e)}function ku(e,a,r){var n=Ms(Or++,2);if(n.t=e,!n.__c&&(n.__=[r?r(a):si(void 0,a),function(i){var u=n.__N?n.__N[0]:n.__[0],d=n.t(u,i);u!==d&&(n.__N=[d,n.__[1]],n.__c.setState({}))}],n.__c=He,!He.__f)){var s=function(i,u,d){if(!n.__c.__H)return!0;var g=n.__c.__H.__.filter(function(m){return!!m.__c});if(g.every(function(m){return!m.__N}))return!o||o.call(this,i,u,d);var f=n.__c.props!==i;return g.forEach(function(m){if(m.__N){var b=m.__[0];m.__=m.__N,m.__N=void 0,b!==m.__[0]&&(f=!0)}}),o&&o.call(this,i,u,d)||f};He.__f=!0;var o=He.shouldComponentUpdate,l=He.componentWillUpdate;He.componentWillUpdate=function(i,u,d){if(this.__e){var g=o;o=void 0,s(i,u,d),o=g}l&&l.call(this,i,u,d)},He.shouldComponentUpdate=s}return n.__N||n.__}function le(e,a){var r=Ms(Or++,3);!Be.__s&&ni(r.__H,a)&&(r.__=e,r.u=a,He.__H.__h.push(r))}function Pt(e){return Hr=5,Oe(function(){return{current:e}},[])}function Oe(e,a){var r=Ms(Or++,7);return ni(r.__H,a)&&(r.__=e(),r.__H=a,r.__h=e),r.__}function ri(e,a){return Hr=8,Oe(function(){return e},a)}function Su(){for(var e;e=ai.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(vn),e.__H.__h.forEach(Ts),e.__H.__h=[]}catch(a){e.__H.__h=[],Be.__e(a,e.__v)}}Be.__b=function(e){He=null,Kl&&Kl(e)},Be.__=function(e,a){e&&a.__k&&a.__k.__m&&(e.__m=a.__k.__m),ei&&ei(e,a)},Be.__r=function(e){Jl&&Jl(e),Or=0;var a=(He=e.__c).__H;a&&(Cs===He?(a.__h=[],He.__h=[],a.__.forEach(function(r){r.__N&&(r.__=r.__N),r.u=r.__N=void 0})):(a.__h.forEach(vn),a.__h.forEach(Ts),a.__h=[],Or=0)),Cs=He},Be.diffed=function(e){Zl&&Zl(e);var a=e.__c;a&&a.__H&&(a.__H.__h.length&&(ai.push(a)!==1&&Yl===Be.requestAnimationFrame||((Yl=Be.requestAnimationFrame)||Au)(Su)),a.__H.__.forEach(function(r){r.u&&(r.__H=r.u),r.u=void 0})),Cs=He=null},Be.__c=function(e,a){a.some(function(r){try{r.__h.forEach(vn),r.__h=r.__h.filter(function(n){return!n.__||Ts(n)})}catch(n){a.some(function(s){s.__h&&(s.__h=[])}),a=[],Be.__e(n,r.__v)}}),Ql&&Ql(e,a)},Be.unmount=function(e){Xl&&Xl(e);var a,r=e.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{vn(n)}catch(s){a=s}}),r.__H=void 0,a&&Be.__e(a,r.__v))};var ti=typeof requestAnimationFrame=="function";function Au(e){var a,r=function(){clearTimeout(n),ti&&cancelAnimationFrame(a),setTimeout(e)},n=setTimeout(r,35);ti&&(a=requestAnimationFrame(r))}function vn(e){var a=He,r=e.__c;typeof r=="function"&&(e.__c=void 0,r()),He=a}function Ts(e){var a=He;e.__c=e.__(),He=a}function ni(e,a){return!e||e.length!==a.length||a.some(function(r,n){return r!==e[n]})}function si(e,a){return typeof a=="function"?a(e):a}var Cu={};function mn(e,a){for(var r in a)e[r]=a[r];return e}function Tu(e,a,r){var n,s=/(?:\?([^#]*))?(#.*)?$/,o=e.match(s),l={};if(o&&o[1])for(var i=o[1].split("&"),u=0;u<i.length;u++){var d=i[u].split("=");l[decodeURIComponent(d[0])]=decodeURIComponent(d.slice(1).join("="))}e=Es(e.replace(s,"")),a=Es(a||"");for(var g=Math.max(e.length,a.length),f=0;f<g;f++)if(a[f]&&a[f].charAt(0)===":"){var m=a[f].replace(/(^:|[+*?]+$)/g,""),b=(a[f].match(/[+*?]+$/)||Cu)[0]||"",h=~b.indexOf("+"),C=~b.indexOf("*"),A=e[f]||"";if(!A&&!C&&(b.indexOf("?")<0||h)){n=!1;break}if(l[m]=decodeURIComponent(A),h||C){l[m]=e.slice(f).map(decodeURIComponent).join("/");break}}else if(a[f]!==e[f]){n=!1;break}return(r.default===!0||n!==!1)&&l}function Mu(e,a){return e.rank<a.rank?1:e.rank>a.rank?-1:e.index-a.index}function Eu(e,a){return e.index=a,e.rank=(function(r){return r.props.default?0:Es(r.props.path).map(Pu).join("")})(e),e.props}function Es(e){return e.replace(/(^\/+|\/+$)/g,"").split("/")}function Pu(e){return e.charAt(0)==":"?1+"*+?".indexOf(e.charAt(e.length-1))||4:5}var Lu={},Ta=[],oi=[],ht=null,ii={url:Ps()},$u=ql(ii);function Ps(){var e;return""+((e=ht&&ht.location?ht.location:ht&&ht.getCurrentLocation?ht.getCurrentLocation():typeof location<"u"?location:Lu).pathname||"")+(e.search||"")}function Du(e,a){return a===void 0&&(a=!1),typeof e!="string"&&e.url&&(a=e.replace,e=e.url),(function(r){for(var n=Ta.length;n--;)if(Ta[n].canRoute(r))return!0;return!1})(e)&&(function(r,n){n===void 0&&(n="push"),ht&&ht[n]?ht[n](r):typeof history<"u"&&history[n+"State"]&&history[n+"State"](null,null,r)})(e,a?"replace":"push"),ci(e)}function ci(e){for(var a=!1,r=0;r<Ta.length;r++)Ta[r].routeTo(e)&&(a=!0);return a}function Iu(e){if(e&&e.getAttribute){var a=e.getAttribute("href"),r=e.getAttribute("target");if(a&&a.match(/^\//g)&&(!r||r.match(/^_?self$/i)))return Du(a)}}function Ru(e){return e.stopImmediatePropagation&&e.stopImmediatePropagation(),e.stopPropagation&&e.stopPropagation(),e.preventDefault(),!1}function Nu(e){if(!(e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||e.button)){var a=e.target;do if(a.localName==="a"&&a.getAttribute("href")){if(a.hasAttribute("data-native")||a.hasAttribute("native"))return;if(Iu(a))return Ru(e)}while(a=a.parentNode)}}var li=!1;function Ls(e){e.history&&(ht=e.history),this.state={url:e.url||Ps()}}mn(Ls.prototype=new Kt,{shouldComponentUpdate:function(e){return e.static!==!0||e.url!==this.props.url||e.onChange!==this.props.onChange},canRoute:function(e){var a=fn(this.props.children);return this.g(a,e)!==void 0},routeTo:function(e){this.setState({url:e});var a=this.canRoute(e);return this.p||this.forceUpdate(),a},componentWillMount:function(){this.p=!0},componentDidMount:function(){var e=this;li||(li=!0,ht||addEventListener("popstate",function(){ci(Ps())}),addEventListener("click",Nu)),Ta.push(this),ht&&(this.u=ht.listen(function(a){var r=a.location||a;e.routeTo(""+(r.pathname||"")+(r.search||""))})),this.p=!1},componentWillUnmount:function(){typeof this.u=="function"&&this.u(),Ta.splice(Ta.indexOf(this),1)},componentWillUpdate:function(){this.p=!0},componentDidUpdate:function(){this.p=!1},g:function(e,a){e=e.filter(Eu).sort(Mu);for(var r=0;r<e.length;r++){var n=e[r],s=Tu(a,n.props.path,n.props);if(s)return[n,s]}},render:function(e,a){var r,n,s=e.onChange,o=a.url,l=this.c,i=this.g(fn(e.children),o);if(i&&(n=Gl(i[0],mn(mn({url:o,matches:r=i[1]},r),{key:void 0,ref:void 0}))),o!==(l&&l.url)){mn(ii,l=this.c={url:o,previous:l&&l.url,current:n,path:n?n.props.path:null,matches:r}),l.router=this,l.active=n?[n]:[];for(var u=oi.length;u--;)oi[u]({});typeof s=="function"&&s(l)}return t($u.Provider,{value:l},n)}});var Ou=Symbol.for("preact-signals");function gn(){if(ua>1)ua--;else{for(var e,a=!1;zr!==void 0;){var r=zr;for(zr=void 0,$s++;r!==void 0;){var n=r.o;if(r.o=void 0,r.f&=-3,!(8&r.f)&&pi(r))try{r.c()}catch(s){a||(e=s,a=!0)}r=n}}if($s=0,ua--,a)throw e}}function Ds(e){if(ua>0)return e();ua++;try{return e()}finally{gn()}}var xe=void 0;function Is(e){var a=xe;xe=void 0;try{return e()}finally{xe=a}}var di,zr=void 0,ua=0,$s=0,yn=0;function ui(e){if(xe!==void 0){var a=e.n;if(a===void 0||a.t!==xe)return a={i:0,S:e,p:xe.s,n:void 0,t:xe,e:void 0,x:void 0,r:a},xe.s!==void 0&&(xe.s.n=a),xe.s=a,e.n=a,32&xe.f&&e.S(a),a;if(a.i===-1)return a.i=0,a.n!==void 0&&(a.n.p=a.p,a.p!==void 0&&(a.p.n=a.n),a.p=xe.s,a.n=void 0,xe.s.n=a,xe.s=a),a}}function Ge(e,a){this.v=e,this.i=0,this.n=void 0,this.t=void 0,this.W=a?.watched,this.Z=a?.unwatched,this.name=a?.name}Ge.prototype.brand=Ou;Ge.prototype.h=function(){return!0};Ge.prototype.S=function(e){var a=this,r=this.t;r!==e&&e.e===void 0&&(e.x=r,this.t=e,r!==void 0?r.e=e:Is(function(){var n;(n=a.W)==null||n.call(a)}))};Ge.prototype.U=function(e){var a=this;if(this.t!==void 0){var r=e.e,n=e.x;r!==void 0&&(r.x=n,e.e=void 0),n!==void 0&&(n.e=r,e.x=void 0),e===this.t&&(this.t=n,n===void 0&&Is(function(){var s;(s=a.Z)==null||s.call(a)}))}};Ge.prototype.subscribe=function(e){var a=this;return Ea(function(){var r=a.value,n=xe;xe=void 0;try{e(r)}finally{xe=n}},{name:"sub"})};Ge.prototype.valueOf=function(){return this.value};Ge.prototype.toString=function(){return this.value+""};Ge.prototype.toJSON=function(){return this.value};Ge.prototype.peek=function(){var e=xe;xe=void 0;try{return this.value}finally{xe=e}};Object.defineProperty(Ge.prototype,"value",{get:function(){var e=ui(this);return e!==void 0&&(e.i=this.i),this.v},set:function(e){if(e!==this.v){if($s>100)throw new Error("Cycle detected");this.v=e,this.i++,yn++,ua++;try{for(var a=this.t;a!==void 0;a=a.x)a.t.N()}finally{gn()}}}});function aa(e,a){return new Ge(e,a)}function pi(e){for(var a=e.s;a!==void 0;a=a.n)if(a.S.i!==a.i||!a.S.h()||a.S.i!==a.i)return!0;return!1}function fi(e){for(var a=e.s;a!==void 0;a=a.n){var r=a.S.n;if(r!==void 0&&(a.r=r),a.S.n=a,a.i=-1,a.n===void 0){e.s=a;break}}}function vi(e){for(var a=e.s,r=void 0;a!==void 0;){var n=a.p;a.i===-1?(a.S.U(a),n!==void 0&&(n.n=a.n),a.n!==void 0&&(a.n.p=n)):r=a,a.S.n=a.r,a.r!==void 0&&(a.r=void 0),a=n}e.s=r}function Ma(e,a){Ge.call(this,void 0),this.x=e,this.s=void 0,this.g=yn-1,this.f=4,this.W=a?.watched,this.Z=a?.unwatched,this.name=a?.name}Ma.prototype=new Ge;Ma.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===yn))return!0;if(this.g=yn,this.f|=1,this.i>0&&!pi(this))return this.f&=-2,!0;var e=xe;try{fi(this),xe=this;var a=this.x();(16&this.f||this.v!==a||this.i===0)&&(this.v=a,this.f&=-17,this.i++)}catch(r){this.v=r,this.f|=16,this.i++}return xe=e,vi(this),this.f&=-2,!0};Ma.prototype.S=function(e){if(this.t===void 0){this.f|=36;for(var a=this.s;a!==void 0;a=a.n)a.S.S(a)}Ge.prototype.S.call(this,e)};Ma.prototype.U=function(e){if(this.t!==void 0&&(Ge.prototype.U.call(this,e),this.t===void 0)){this.f&=-33;for(var a=this.s;a!==void 0;a=a.n)a.S.U(a)}};Ma.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var e=this.t;e!==void 0;e=e.x)e.t.N()}};Object.defineProperty(Ma.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var e=ui(this);if(this.h(),e!==void 0&&(e.i=this.i),16&this.f)throw this.v;return this.v}});function xn(e,a){return new Ma(e,a)}function mi(e){var a=e.u;if(e.u=void 0,typeof a=="function"){ua++;var r=xe;xe=void 0;try{a()}catch(n){throw e.f&=-2,e.f|=8,Rs(e),n}finally{xe=r,gn()}}}function Rs(e){for(var a=e.s;a!==void 0;a=a.n)a.S.U(a);e.x=void 0,e.s=void 0,mi(e)}function Hu(e){if(xe!==this)throw new Error("Out-of-order effect");vi(this),xe=e,this.f&=-2,8&this.f&&Rs(this),gn()}function lr(e,a){this.x=e,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32,this.name=a?.name,di&&di.push(this)}lr.prototype.c=function(){var e=this.S();try{if(8&this.f||this.x===void 0)return;var a=this.x();typeof a=="function"&&(this.u=a)}finally{e()}};lr.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,mi(this),fi(this),ua++;var e=xe;return xe=this,Hu.bind(this,e)};lr.prototype.N=function(){2&this.f||(this.f|=2,this.o=zr,zr=this)};lr.prototype.d=function(){this.f|=8,1&this.f||Rs(this)};lr.prototype.dispose=function(){this.d()};function Ea(e,a){var r=new lr(e,a);try{r.c()}catch(s){throw r.d(),s}var n=r.d.bind(r);return n[Symbol.dispose]=n,n}var yi,Ns,bn,zu=typeof window<"u"&&!!window.__PREACT_SIGNALS_DEVTOOLS__;var gi=[];Ea(function(){yi=this.N})();function ir(e,a){ge[e]=a.bind(null,ge[e]||function(){})}function hn(e){if(bn){var a=bn;bn=void 0,a()}bn=e&&e.S()}function xi(e){var a=this,r=e.data,n=Bu(r);n.value=r;var s=Oe(function(){for(var i=a,u=a.__v;u=u.__;)if(u.__c){u.__c.__$f|=4;break}var d=xn(function(){var b=n.value.value;return b===0?0:b===!0?"":b||""}),g=xn(function(){return!Array.isArray(d.value)&&!_s(d.value)}),f=Ea(function(){if(this.N=bi,g.value){var b=d.value;i.__v&&i.__v.__e&&i.__v.__e.nodeType===3&&(i.__v.__e.data=b)}}),m=a.__$u.d;return a.__$u.d=function(){f(),m.call(this)},[g,d]},[]),o=s[0],l=s[1];return o.value?l.peek():l.value}xi.displayName="ReactiveTextNode";Object.defineProperties(Ge.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:xi},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});ir("__b",function(e,a){if(typeof a.type=="string"){var r,n=a.props;for(var s in n)if(s!=="children"){var o=n[s];o instanceof Ge&&(r||(a.__np=r={}),r[s]=o,n[s]=o.peek())}}e(a)});ir("__r",function(e,a){if(e(a),a.type!==V){hn();var r,n=a.__c;n&&(n.__$f&=-2,(r=n.__$u)===void 0&&(n.__$u=r=(function(s,o){var l;return Ea(function(){l=this},{name:o}),l.c=s,l})(function(){var s;zu&&((s=r.y)==null||s.call(r)),n.__$f|=1,n.setState({})},typeof a.type=="function"?a.type.displayName||a.type.name:""))),Ns=n,hn(r)}});ir("__e",function(e,a,r,n){hn(),Ns=void 0,e(a,r,n)});ir("diffed",function(e,a){hn(),Ns=void 0;var r;if(typeof a.type=="string"&&(r=a.__e)){var n=a.__np,s=a.props;if(n){var o=r.U;if(o)for(var l in o){var i=o[l];i!==void 0&&!(l in n)&&(i.d(),o[l]=void 0)}else o={},r.U=o;for(var u in n){var d=o[u],g=n[u];d===void 0?(d=Fu(r,u,g,s),o[u]=d):d.o(g,s)}}}e(a)});function Fu(e,a,r,n){var s=a in e&&e.ownerSVGElement===void 0,o=aa(r);return{o:function(l,i){o.value=l,n=i},d:Ea(function(){this.N=bi;var l=o.value.value;n[a]!==l&&(n[a]=l,s?e[a]=l:l!=null&&(l!==!1||a[4]==="-")?e.setAttribute(a,l):e.removeAttribute(a))})}}ir("unmount",function(e,a){if(typeof a.type=="string"){var r=a.__e;if(r){var n=r.U;if(n){r.U=void 0;for(var s in n){var o=n[s];o&&o.d()}}}}else{var l=a.__c;if(l){var i=l.__$u;i&&(l.__$u=void 0,i.d())}}e(a)});ir("__h",function(e,a,r,n){(n<3||n===9)&&(a.__$f|=2),e(a,r,n)});Kt.prototype.shouldComponentUpdate=function(e,a){if(this.__R)return!0;var r=this.__$u,n=r&&r.s!==void 0;for(var s in a)return!0;if(this.__f||typeof this.u=="boolean"&&this.u===!0){var o=2&this.__$f;if(!(n||o||4&this.__$f)||1&this.__$f)return!0}else if(!(n||4&this.__$f)||3&this.__$f)return!0;for(var l in e)if(l!=="__source"&&e[l]!==this.props[l])return!0;for(var i in this.props)if(!(i in e))return!0;return!1};function Bu(e,a){return Oe(function(){return aa(e,a)},[])}var Wu=function(e){queueMicrotask(function(){queueMicrotask(e)})};function ju(){Ds(function(){for(var e;e=gi.shift();)yi.call(e)})}function bi(){gi.push(this)===1&&(ge.requestAnimationFrame||Wu)(ju)}var Uu=window.location.pathname.replace(/\/ui(\/.*)?$/,""),pa=window.location.origin+Uu,_n=new Map;function ce(e){if(_n.has(e))return _n.get(e);let a=fetch(`${pa}${e}`).then(r=>{if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);return r.json()}).finally(()=>{_n.delete(e)});return _n.set(e,a),a}function fa(e,a){return fetch(`${pa}${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(r=>{if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);return r.json()})}function wn(e,a){return fetch(`${pa}${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(r=>{if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);return r.json()})}var kn=new Map;function Pa(e){return kn.has(e)||kn.set(e,aa({data:null,loading:!1,error:null,stale:!1,lastFetched:0})),kn.get(e)}async function ur(e){let a=Pa(e),r=a.value;if(r.loading||r.lastFetched&&Date.now()-r.lastFetched<2e3)return;r.data!==null&&r.stale||(a.value={...r,loading:!0,error:null});try{let o=await ce(`/api/cache/${e}`);a.value={data:o,loading:!1,error:null,stale:!1,lastFetched:Date.now()}}catch(o){let l=o.message&&o.message.startsWith("HTTP 404");a.value={...a.value,data:l?{data:{}}:a.value.data,loading:!1,error:l?null:o.message,stale:!1,lastFetched:Date.now()}}}var dr=aa(!1),cr=aa(""),La=aa(Vu());function Vu(){if(typeof window>"u")return"light";let e=localStorage.getItem("aria-theme");return e==="light"||e==="dark"?e:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Gu(e){La.value=e,document.documentElement.setAttribute("data-theme",e),localStorage.setItem("aria-theme",e)}function Sn(){Gu(La.value==="dark"?"light":"dark")}typeof document<"u"&&document.documentElement.setAttribute("data-theme",La.value);var dt=null,Fr=1e3,qu=3e4,Br=null,Wr=null;function Os(){if(dt&&(dt.readyState===WebSocket.CONNECTING||dt.readyState===WebSocket.OPEN))return;let e=window.location.protocol==="https:"?"wss:":"ws:",a=window.location.pathname.replace(/\/ui(\/.*)?$/,""),r=`${e}//${window.location.host}${a}/ws`;dt=new WebSocket(r),dt.onopen=()=>{Fr=1e3,dr.value=!0,cr.value="Connected",Ku(),clearInterval(Br),Br=setInterval(()=>{dt&&dt.readyState===WebSocket.OPEN&&dt.send(JSON.stringify({type:"ping"}))},3e4)},dt.onmessage=n=>{try{let s=JSON.parse(n.data);if(s.type==="cache_updated"&&s.data&&s.data.category){let o=s.data.category,l=Pa(o);l.value={...l.value,stale:!0},ur(o)}}catch{}},dt.onclose=()=>{dr.value=!1,cr.value=`Disconnected \u2014 reconnecting in ${(Fr/1e3).toFixed(0)}s`,clearInterval(Br),Yu()},dt.onerror=()=>{cr.value="Connection error"}}function Yu(){clearTimeout(Wr),Wr=setTimeout(()=>{Wr=null,Os()},Fr),Fr=Math.min(Fr*2,qu)}function hi(){clearInterval(Br),Br=null,clearTimeout(Wr),Wr=null,dt&&(dt.onclose=null,dt.close(),dt=null),dr.value=!1,cr.value=""}function Ku(){for(let[e,a]of kn)a.value={...a.value,stale:!0},ur(e)}var Ju=[[1,0],[2,0],[3,0],[0,1],[1,1],[3,1],[4,1],[0,2],[1,2],[2,2],[3,2],[4,2],[0,3],[1,3],[3,3],[4,3],[0,4],[1,4],[3,4],[4,4],[7,0],[8,0],[9,0],[10,0],[11,0],[7,1],[8,1],[10,1],[11,1],[7,2],[8,2],[9,2],[10,2],[7,3],[8,3],[10,3],[7,4],[8,4],[11,4],[14,0],[14,1],[14,2],[14,3],[14,4],[18,0],[19,0],[20,0],[17,1],[18,1],[20,1],[21,1],[17,2],[18,2],[19,2],[20,2],[21,2],[17,3],[18,3],[20,3],[21,3],[17,4],[18,4],[20,4],[21,4]],Hs=10,zs=2,_i=Hs-zs,Zu=1;function pr({className:e="",color:a="currentColor"}){return t("svg",{viewBox:"0 0 220 50",class:e,fill:a,role:"img","aria-label":"ARIA"},Ju.map(([r,n],s)=>t("rect",{key:s,x:r*Hs+zs/2,y:n*Hs+zs/2,width:_i,height:_i,rx:Zu})))}var An=[{path:"/",label:"Home",icon:ki},{section:"Data Collection"},{path:"/discovery",label:"Discovery",icon:ep},{path:"/capabilities",label:"Capabilities",icon:tp},{path:"/data-curation",label:"Data Curation",icon:op},{section:"Learning"},{path:"/intelligence",label:"Intelligence",icon:Ai},{path:"/ml-engine",label:"ML Engine",icon:sp},{path:"/predictions",label:"Predictions",icon:Si},{path:"/patterns",label:"Patterns",icon:ap},{section:"Actions"},{path:"/shadow",label:"Shadow Mode",icon:Ci},{path:"/automations",label:"Automations",icon:rp},{path:"/settings",label:"Settings",icon:np}],Qu=[{path:"/",label:"Home",icon:ki},{path:"/intelligence",label:"Intel",icon:Ai},{path:"/predictions",label:"Predict",icon:Si},{path:"/shadow",label:"Shadow",icon:Ci},{key:"more",label:"More",icon:lp}],Xu=An.filter(e=>!e.section&&!["/","/intelligence","/predictions","/shadow"].includes(e.path));function ki(){return t("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},t("rect",{x:"3",y:"3",width:"7",height:"7"}),t("rect",{x:"14",y:"3",width:"7",height:"7"}),t("rect",{x:"3",y:"14",width:"7",height:"7"}),t("rect",{x:"14",y:"14",width:"7",height:"7"}))}function ep(){return t("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},t("circle",{cx:"11",cy:"11",r:"8"}),t("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}))}function tp(){return t("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},t("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"}))}function Si(){return t("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},t("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),t("polyline",{points:"17 6 23 6 23 12"}))}function ap(){return t("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},t("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),t("polyline",{points:"2 17 12 22 22 17"}),t("polyline",{points:"2 12 12 17 22 12"}))}function Ai(){return t("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},t("path",{d:"M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7z"}),t("line",{x1:"9",y1:"21",x2:"15",y2:"21"}),t("line",{x1:"10",y1:"19",x2:"14",y2:"19"}))}function Ci(){return t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round","aria-hidden":"true"},t("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),t("circle",{cx:"12",cy:"12",r:"3"}))}function rp(){return t("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},t("circle",{cx:"12",cy:"12",r:"3"}),t("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"}))}function np(){return t("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},t("line",{x1:"4",y1:"21",x2:"4",y2:"14"}),t("line",{x1:"4",y1:"10",x2:"4",y2:"3"}),t("line",{x1:"12",y1:"21",x2:"12",y2:"12"}),t("line",{x1:"12",y1:"8",x2:"12",y2:"3"}),t("line",{x1:"20",y1:"21",x2:"20",y2:"16"}),t("line",{x1:"20",y1:"12",x2:"20",y2:"3"}),t("line",{x1:"1",y1:"14",x2:"7",y2:"14"}),t("line",{x1:"9",y1:"8",x2:"15",y2:"8"}),t("line",{x1:"17",y1:"16",x2:"23",y2:"16"}))}function sp(){return t("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},t("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),t("rect",{x:"9",y:"9",width:"6",height:"6"}),t("line",{x1:"9",y1:"1",x2:"9",y2:"4"}),t("line",{x1:"15",y1:"1",x2:"15",y2:"4"}),t("line",{x1:"9",y1:"20",x2:"9",y2:"23"}),t("line",{x1:"15",y1:"20",x2:"15",y2:"23"}),t("line",{x1:"20",y1:"9",x2:"23",y2:"9"}),t("line",{x1:"20",y1:"15",x2:"23",y2:"15"}),t("line",{x1:"1",y1:"9",x2:"4",y2:"9"}),t("line",{x1:"1",y1:"15",x2:"4",y2:"15"}))}function op(){return t("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},t("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"}))}function Fs(){return t("svg",{class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},t("circle",{cx:"12",cy:"12",r:"5"}),t("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),t("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),t("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),t("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),t("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),t("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),t("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),t("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"}))}function Bs(){return t("svg",{class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},t("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"}))}function lp(){return t("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},t("circle",{cx:"12",cy:"5",r:"1.5",fill:"currentColor"}),t("circle",{cx:"12",cy:"12",r:"1.5",fill:"currentColor"}),t("circle",{cx:"12",cy:"19",r:"1.5",fill:"currentColor"}))}function ip(){return t("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},t("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),t("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),t("line",{x1:"3",y1:"18",x2:"21",y2:"18"}))}function Ti(){return t("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))}function Ws(){return t("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},t("path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"}),t("path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"}))}function wi(){let a=(window.location.hash||"#/").replace(/^#/,"")||"/",r=a.indexOf("?");return r>=0?a.slice(0,r):a}function cp({currentPath:e}){let[a,r]=N(!1),n=La.value==="dark";return le(()=>{r(!1)},[e]),t("nav",{class:"sm:hidden fixed bottom-0 left-0 right-0 z-40","aria-label":"Primary navigation"},a&&t("div",{class:"fixed inset-0 z-40",style:"background: rgba(0,0,0,0.5);",onClick:()=>r(!1)},t("div",{class:"absolute bottom-14 left-0 right-0",style:"background: var(--bg-surface); border-top: 1px solid var(--border-subtle); border-top-left-radius: 12px; border-top-right-radius: 12px; box-shadow: 0 -4px 20px rgba(0,0,0,0.15); max-height: 60vh; overflow-y: auto;",onClick:s=>s.stopPropagation()},t("div",{class:"flex items-center justify-between",style:"padding: 12px 16px; border-bottom: 1px solid var(--border-subtle);"},t("span",{style:"font-size: 13px; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.05em;"},"More"),t("button",{onClick:()=>r(!1),"aria-label":"Close menu",style:"color: var(--text-tertiary); padding: 4px; cursor: pointer; background: none; border: none;"},t(Ti,null))),t("div",{style:"padding: 8px 0;"},Xu.map(s=>{let o=e===s.path;return t("a",{key:s.path,href:`#${s.path}`,class:"flex items-center gap-3",style:`padding: 12px 20px; font-size: 14px; font-weight: 500; text-decoration: none; ${o?"color: var(--accent); background: var(--bg-surface-raised);":"color: var(--text-secondary);"}`},t(s.icon,null),s.label)}),t("a",{href:"#/guide",class:"flex items-center gap-3",style:`padding: 12px 20px; font-size: 14px; font-weight: 500; text-decoration: none; ${e==="/guide"?"color: var(--accent); background: var(--bg-surface-raised);":"color: var(--accent);"}`},t(Ws,null),"How to Use ARIA"),t("div",{style:"padding: 12px 20px; border-top: 1px solid var(--border-subtle); margin-top: 4px;"},t("button",{onClick:Sn,class:"flex items-center gap-2",style:"background: var(--bg-surface-raised); color: var(--text-secondary); border: 1px solid var(--border-subtle); border-radius: var(--radius); padding: 6px 12px; font-size: 13px; cursor: pointer;","aria-label":n?"Switch to light mode":"Switch to dark mode"},n?t(Fs,null):t(Bs,null),t("span",null,n?"Light mode":"Dark mode")))))),t("div",{style:"background: var(--bg-surface); border-top: 1px solid var(--border-subtle); min-height: 56px; padding-bottom: env(safe-area-inset-bottom);",class:"flex justify-around items-center"},Qu.map(s=>{let o=s.key==="more",i=(o?a:e===s.path)?"color: var(--accent); border-top: 2px solid var(--accent); margin-top: -2px;":"color: var(--text-tertiary); border-top: 2px solid transparent; margin-top: -2px;";return o?t("button",{key:"more",class:"flex flex-col items-center justify-center",style:`${i} min-width: 48px; min-height: 48px; background: none; border-left: none; border-right: none; border-bottom: none; cursor: pointer; font-size: 10px; font-weight: 500; gap: 2px;`,onClick:()=>r(!a),"aria-label":"More navigation options","aria-expanded":a},t(s.icon,null),t("span",null,s.label)):t("a",{key:s.path,href:`#${s.path}`,class:"flex flex-col items-center justify-center",style:`${i} min-width: 48px; min-height: 48px; text-decoration: none; font-size: 10px; font-weight: 500; gap: 2px;`,"aria-label":s.label},t(s.icon,null),t("span",null,s.label))})))}function dp({currentPath:e}){let[a,r]=N(!1),n=dr.value,s=La.value==="dark";le(()=>{r(!1)},[e]);let o=An.filter(i=>!i.section);return t(V,null,a&&t("div",{class:"hidden sm:block lg:hidden fixed inset-0",style:"z-index: 29;",onClick:()=>r(!1)}),t("nav",{class:"hidden sm:flex lg:hidden fixed left-0 top-0 bottom-0 flex-col z-30",style:`width: ${a?"240px":"56px"}; background: var(--bg-surface); border-right: 1px solid var(--border-subtle); box-shadow: 2px 0 8px rgba(0,0,0,0.06); transition: width 0.2s ease; overflow: hidden;`,"aria-label":"Primary navigation"},t("button",{class:"flex items-center justify-center",style:`width: 56px; height: 56px; flex-shrink: 0; background: none; border: none; color: var(--text-secondary); cursor: pointer;${a?" background: var(--bg-surface-raised);":""}`,onClick:()=>r(!a),"aria-label":a?"Collapse navigation":"Expand navigation","aria-expanded":a},a?t(Ti,null):t(ip,null)),t("div",{class:"flex-1 overflow-y-auto",style:"padding: 4px 0;"},a?An.map((i,u)=>{if(i.section)return t("div",{key:i.section,style:`padding: 0 16px; padding-top: 14px; padding-bottom: 4px; font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-tertiary); white-space: nowrap;${u>0?" border-top: 1px solid var(--border-subtle); margin-top: 6px;":""}`},i.section);let d=e===i.path;return t("a",{key:i.path,href:`#${i.path}`,class:"flex items-center gap-3",style:`padding: 8px 16px; font-size: 14px; font-weight: 500; text-decoration: none; white-space: nowrap; transition: background 0.15s ease; ${d?"color: var(--text-primary); background: var(--bg-surface-raised); border-left: 2px solid var(--accent); padding-left: 14px;":"color: var(--text-tertiary); border-left: 2px solid transparent; padding-left: 14px;"}`,"aria-label":i.label},t(i.icon,null),i.label)}):o.map(i=>{let u=e===i.path;return t("a",{key:i.path,href:`#${i.path}`,class:"flex items-center justify-center",style:`width: 56px; height: 44px; text-decoration: none; transition: background 0.15s ease; ${u?"color: var(--accent); border-left: 2px solid var(--accent);":"color: var(--text-tertiary); border-left: 2px solid transparent;"}`,title:i.label,"aria-label":i.label},t(i.icon,null))})),t("div",{style:"border-top: 1px solid var(--border-subtle); padding: 4px 0; flex-shrink: 0;"},t("a",{href:"#/guide",class:"flex items-center justify-center",style:`width: 56px; height: 44px; text-decoration: none; ${e==="/guide"?"color: var(--accent);":"color: var(--accent); opacity: 0.7;"}`,title:"How to Use ARIA","aria-label":"How to Use ARIA"},t(Ws,null)),t("button",{onClick:Sn,class:"flex items-center justify-center",style:"width: 56px; height: 44px; background: none; border: none; color: var(--text-secondary); cursor: pointer;",title:s?"Switch to light mode":"Switch to dark mode","aria-label":s?"Switch to light mode":"Switch to dark mode"},s?t(Fs,null):t(Bs,null)),t("div",{class:"flex items-center justify-center",style:"width: 56px; height: 28px;",title:n?"Connected":"Disconnected","aria-label":n?"WebSocket connected":"WebSocket disconnected"},t("span",{style:`display: inline-block; width: 8px; height: 8px; border-radius: 50%; background: ${n?"var(--status-healthy)":"var(--status-error)"};`})))))}function up({currentPath:e}){let a=dr.value,r=cr.value,n=La.value==="dark";return t("nav",{class:"hidden lg:flex fixed left-0 top-0 bottom-0 w-60 flex-col z-30 t-terminal-bg",style:"background: var(--bg-surface); border-right: 1px solid var(--border-subtle); box-shadow: 2px 0 8px rgba(0,0,0,0.06);","aria-label":"Primary navigation"},t("div",{class:"px-5 py-5"},t(pr,{className:"w-28",color:"var(--accent)"}),t("p",{style:"font-size: 10px; color: var(--text-tertiary); margin-top: 6px; letter-spacing: 0.05em;"},"Adaptive Residence Intelligence")),t("div",{class:"flex-1 px-3 space-y-0.5 overflow-y-auto"},An.map((s,o)=>{if(s.section)return t("div",{key:s.section,style:`padding: 0 12px; padding-top: 16px; padding-bottom: 4px; font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-tertiary);${o>0?" border-top: 1px solid var(--border-subtle); margin-top: 8px;":""}`},s.section);let l=e===s.path;return t("a",{key:s.path,href:`#${s.path}`,class:"flex items-center gap-3 text-sm font-medium",style:l?"background: var(--bg-surface-raised); color: var(--text-primary); border-left: 2px solid var(--accent); padding: 8px 12px; border-radius: var(--radius); transition: background 0.15s ease, color 0.15s ease;":"color: var(--text-tertiary); padding: 8px 12px; border-left: 2px solid transparent; border-radius: var(--radius); transition: background 0.15s ease, color 0.15s ease;",onMouseEnter:i=>{l||(i.currentTarget.style.background="var(--bg-surface-raised)"),i.currentTarget.style.color="var(--text-primary)"},onMouseLeave:i=>{l||(i.currentTarget.style.background="transparent",i.currentTarget.style.color="var(--text-tertiary)")},"aria-label":s.label},t(s.icon,null),s.label)})),t("div",{style:"padding: 12px; border-top: 1px solid var(--border-subtle);",class:"space-y-2"},t("a",{href:"#/guide",class:"flex items-center gap-3 text-sm font-medium",style:e==="/guide"?"background: var(--bg-surface-raised); color: var(--text-primary); border-left: 2px solid var(--accent); padding: 8px 12px; border-radius: var(--radius);":"color: var(--accent); padding: 8px 12px; border-left: 2px solid transparent; border-radius: var(--radius); transition: background 0.15s ease, color 0.15s ease;",onMouseEnter:s=>{e!=="/guide"&&(s.currentTarget.style.background="var(--bg-surface-raised)")},onMouseLeave:s=>{e!=="/guide"&&(s.currentTarget.style.background="transparent")},"aria-label":"How to Use ARIA"},t(Ws,null),"How to Use ARIA"),t("div",{style:"padding: 0 12px; font-size: 10px; color: var(--text-tertiary); line-height: 1.6;"},t("p",{style:"font-weight: 600; color: var(--text-secondary);"},"ARIA v1.0.0"),t("p",{style:"margin-top: 2px;"},"Local ML + real-time monitoring for Home Assistant. No cloud required.")),t("button",{onClick:Sn,style:"background: var(--bg-surface-raised); color: var(--text-secondary); border: 1px solid var(--border-subtle); border-radius: var(--radius); padding: 4px 8px; margin: 0 12px; display: flex; align-items: center; gap: 6px; font-size: 0.75rem; cursor: pointer; transition: border-color 0.2s ease;",title:n?"Switch to light mode":"Switch to dark mode","aria-label":n?"Switch to light mode":"Switch to dark mode",onMouseEnter:s=>{s.currentTarget.style.borderColor="var(--border-primary)"},onMouseLeave:s=>{s.currentTarget.style.borderColor="var(--border-subtle)"}},n?t(Fs,null):t(Bs,null),t("span",null,n?"Light":"Dark")),t("div",{class:"flex items-center gap-2",style:"padding: 0 12px; font-size: 0.75rem; color: var(--text-tertiary);"},t("span",{style:`display: inline-block; width: 8px; height: 8px; border-radius: 50%; background: ${a?"var(--status-healthy)":"var(--status-error)"};`,"aria-label":a?"WebSocket connected":"WebSocket disconnected"}),t("span",{class:"truncate"},r||(a?"Connected":"Disconnected")))))}function js(){let[e,a]=N(wi);return le(()=>{function r(){a(wi())}return window.addEventListener("hashchange",r),()=>window.removeEventListener("hashchange",r)},[]),t(V,null,t(cp,{currentPath:e}),t(dp,{currentPath:e}),t(up,{currentPath:e}))}function we({error:e,onRetry:a}){let r=e instanceof Error?e.message:String(e||"Unknown error");return t("div",{style:"background: var(--bg-surface); border: 1px solid var(--status-error); border-left-width: 3px; border-radius: var(--radius); padding: 16px;"},t("div",{class:"flex items-start gap-3"},t("svg",{class:"w-5 h-5 mt-0.5 shrink-0",style:"color: var(--status-error);",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},t("circle",{cx:"12",cy:"12",r:"10"}),t("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),t("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})),t("div",{class:"flex-1"},t("p",{class:"text-sm",style:"color: var(--status-error);"},r)),a&&t("button",{onClick:a,class:"text-sm font-medium transition-colors",style:"color: var(--status-error); background: var(--bg-surface-raised); border-radius: var(--radius); padding: 4px 12px;"},"Retry")))}function We(e){let a=Pa(e),r=a.value,n=ri(()=>ur(e),[e]);return le(()=>{let s=a.value;s.data===null&&!s.loading&&ur(e)},[e]),le(()=>{r.stale&&!r.loading&&ur(e)},[r.stale,r.loading,e]),{data:r.data,loading:r.loading,error:r.error,refetch:n}}function pe(e,a){return Oe(e,a)}function Pe({type:e="full"}){return e==="stats"?t("div",{class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4"},[...Array(5)].map((a,r)=>t("div",{key:r,class:"t-card",style:"padding: 16px;"},t("div",{class:"h-8 w-16 animate-pulse mb-2",style:"background: var(--bg-inset); border-radius: var(--radius);"}),t("div",{class:"h-4 w-24 animate-pulse",style:"background: var(--bg-inset); border-radius: var(--radius);"})))):e==="table"?t("div",{class:"t-card",style:"overflow: hidden;"},t("div",{class:"flex gap-4 px-4 py-3",style:"border-bottom: 1px solid var(--border-subtle);"},[...Array(4)].map((a,r)=>t("div",{key:r,class:"h-4 animate-pulse flex-1",style:"background: var(--bg-inset); border-radius: var(--radius);"}))),[...Array(6)].map((a,r)=>t("div",{key:r,class:"flex gap-4 px-4 py-3",style:"border-bottom: 1px solid var(--border-subtle);"},[...Array(4)].map((n,s)=>t("div",{key:s,class:"h-4 animate-pulse flex-1",style:"background: var(--bg-surface-raised); border-radius: var(--radius);"}))))):e==="cards"?t("div",{class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},[...Array(6)].map((a,r)=>t("div",{key:r,class:"t-card",style:"padding: 16px;"},t("div",{class:"h-5 w-32 animate-pulse mb-3",style:"background: var(--bg-inset); border-radius: var(--radius);"}),t("div",{class:"h-4 w-full animate-pulse mb-2",style:"background: var(--bg-surface-raised); border-radius: var(--radius);"}),t("div",{class:"h-4 w-3/4 animate-pulse",style:"background: var(--bg-surface-raised); border-radius: var(--radius);"})))):t("div",{class:"space-y-6"},t("div",{class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4"},[...Array(5)].map((a,r)=>t("div",{key:r,class:"t-card",style:"padding: 16px;"},t("div",{class:"h-8 w-16 animate-pulse mb-2",style:"background: var(--bg-inset); border-radius: var(--radius);"}),t("div",{class:"h-4 w-24 animate-pulse",style:"background: var(--bg-inset); border-radius: var(--radius);"})))),t("div",{class:"t-card",style:"overflow: hidden;"},[...Array(4)].map((a,r)=>t("div",{key:r,class:"flex gap-4 px-4 py-3",style:"border-bottom: 1px solid var(--border-subtle);"},[...Array(4)].map((n,s)=>t("div",{key:s,class:"h-4 animate-pulse flex-1",style:"background: var(--bg-surface-raised); border-radius: var(--radius);"}))))))}var pp="uplot",fp="u-hz",vp="u-vt",mp="u-title",yp="u-wrap",gp="u-under",xp="u-over",bp="u-axis",Ia="u-off",hp="u-select",_p="u-cursor-x",wp="u-cursor-y",kp="u-cursor-pt",Sp="u-legend",Ap="u-live",Cp="u-inline",Tp="u-series",Mp="u-marker",Mi="u-label",Ep="u-value",Ur="width",Vr="height";var Ei="bottom",fr="left",Us="right",lo="#000",Pi=lo+"0",Vs="mousemove",Li="mousedown",Gs="mouseup",$i="mouseenter",Di="mouseleave",Ii="dblclick",Pp="resize",Lp="scroll",Ri="change",Pn="dppxchange",io="--",hr=typeof window<"u",Zs=hr?document:null,mr=hr?window:null,$p=hr?navigator:null,fe,Cn;function Qs(){let e=devicePixelRatio;fe!=e&&(fe=e,Cn&&eo(Ri,Cn,Qs),Cn=matchMedia(`(min-resolution: ${fe-.001}dppx) and (max-resolution: ${fe+.001}dppx)`),Ra(Ri,Cn,Qs),mr.dispatchEvent(new CustomEvent(Pn)))}function _t(e,a){if(a!=null){let r=e.classList;!r.contains(a)&&r.add(a)}}function Xs(e,a){let r=e.classList;r.contains(a)&&r.remove(a)}function Le(e,a,r){e.style[a]=r+"px"}function Ht(e,a,r,n){let s=Zs.createElement(e);return a!=null&&_t(s,a),r?.insertBefore(s,n),s}function Lt(e,a){return Ht("div",e,a)}var Ni=new WeakMap;function Jt(e,a,r,n,s){let o="translate("+a+"px,"+r+"px)",l=Ni.get(e);o!=l&&(e.style.transform=o,Ni.set(e,o),a<0||r<0||a>n||r>s?_t(e,Ia):Xs(e,Ia))}var Oi=new WeakMap;function Hi(e,a,r){let n=a+r,s=Oi.get(e);n!=s&&(Oi.set(e,n),e.style.background=a,e.style.borderColor=r)}var zi=new WeakMap;function Fi(e,a,r,n){let s=a+""+r,o=zi.get(e);s!=o&&(zi.set(e,s),e.style.height=r+"px",e.style.width=a+"px",e.style.marginLeft=n?-a/2+"px":0,e.style.marginTop=n?-r/2+"px":0)}var co={passive:!0},Dp={...co,capture:!0};function Ra(e,a,r,n){a.addEventListener(e,r,n?Dp:co)}function eo(e,a,r,n){a.removeEventListener(e,r,co)}hr&&Qs();function zt(e,a,r,n){let s;r=r||0,n=n||a.length-1;let o=n<=2147483647;for(;n-r>1;)s=o?r+n>>1:wt((r+n)/2),a[s]<e?r=s:n=s;return e-a[r]<=a[n]-e?r:n}function vc(e){return(r,n,s)=>{let o=-1,l=-1;for(let i=n;i<=s;i++)if(e(r[i])){o=i;break}for(let i=s;i>=n;i--)if(e(r[i])){l=i;break}return[o,l]}}var mc=e=>e!=null,yc=e=>e!=null&&e>0,Dn=vc(mc),Ip=vc(yc);function Rp(e,a,r,n=0,s=!1){let o=s?Ip:Dn,l=s?yc:mc;[a,r]=o(e,a,r);let i=e[a],u=e[a];if(a>-1)if(n==1)i=e[a],u=e[r];else if(n==-1)i=e[r],u=e[a];else for(let d=a;d<=r;d++){let g=e[d];l(g)&&(g<i?i=g:g>u&&(u=g))}return[i??ke,u??-ke]}function In(e,a,r,n){let s=ji(e),o=ji(a);e==a&&(s==-1?(e*=r,a/=r):(e/=r,a*=r));let l=r==10?ra:gc,i=s==1?wt:$t,u=o==1?$t:wt,d=i(l(Ye(e))),g=u(l(Ye(a))),f=yr(r,d),m=yr(r,g);return r==10&&(d<0&&(f=Se(f,-d)),g<0&&(m=Se(m,-g))),n||r==2?(e=f*s,a=m*o):(e=_c(e,f),a=Rn(a,m)),[e,a]}function uo(e,a,r,n){let s=In(e,a,r,n);return e==0&&(s[0]=0),a==0&&(s[1]=0),s}var po=.1,Bi={mode:3,pad:po},qr={pad:0,soft:null,mode:0},Np={min:qr,max:qr};function Ln(e,a,r,n){return Nn(r)?Wi(e,a,r):(qr.pad=r,qr.soft=n?0:null,qr.mode=n?3:0,Wi(e,a,Np))}function de(e,a){return e??a}function Op(e,a,r){for(a=de(a,0),r=de(r,e.length-1);a<=r;){if(e[a]!=null)return!0;a++}return!1}function Wi(e,a,r){let n=r.min,s=r.max,o=de(n.pad,0),l=de(s.pad,0),i=de(n.hard,-ke),u=de(s.hard,ke),d=de(n.soft,ke),g=de(s.soft,-ke),f=de(n.mode,0),m=de(s.mode,0),b=a-e,h=ra(b),C=ut(Ye(e),Ye(a)),A=ra(C),M=Ye(A-h);(b<1e-24||M>10)&&(b=0,(e==0||a==0)&&(b=1e-24,f==2&&d!=ke&&(o=0),m==2&&g!=-ke&&(l=0)));let _=b||C||1e3,S=ra(_),k=yr(10,wt(S)),O=_*(b==0?e==0?.1:1:o),L=Se(_c(e-O,k/10),24),H=e>=d&&(f==1||f==3&&L<=d||f==2&&L>=d)?d:ke,R=ut(i,L<H&&e>=H?H:Ft(H,L)),W=_*(b==0?a==0?.1:1:l),B=Se(Rn(a+W,k/10),24),$=a<=g&&(m==1||m==3&&B>=g||m==2&&B<=g)?g:-ke,q=Ft(u,B>$&&a<=$?$:ut($,B));return R==q&&R==0&&(q=100),[R,q]}var Hp=new Intl.NumberFormat(hr?$p.language:"en-US"),fo=e=>Hp.format(e),kt=Math,En=kt.PI,Ye=kt.abs,wt=kt.floor,qe=kt.round,$t=kt.ceil,Ft=kt.min,ut=kt.max,yr=kt.pow,ji=kt.sign,ra=kt.log10,gc=kt.log2,zp=(e,a=1)=>kt.sinh(e)*a,qs=(e,a=1)=>kt.asinh(e/a),ke=1/0;function Ui(e){return(ra((e^e>>31)-(e>>31))|0)+1}function to(e,a,r){return Ft(ut(e,a),r)}function xc(e){return typeof e=="function"}function se(e){return xc(e)?e:()=>e}var Fp=()=>{},bc=e=>e,hc=(e,a)=>a,Bp=e=>null,Vi=e=>!0,Gi=(e,a)=>e==a,Wp=/\.\d*?(?=9{6,}|0{6,})/gm,Na=e=>{if(kc(e)||ma.has(e))return e;let a=`${e}`,r=a.match(Wp);if(r==null)return e;let n=r[0].length-1;if(a.indexOf("e-")!=-1){let[s,o]=a.split("e");return+`${Na(s)}e${o}`}return Se(e,n)};function $a(e,a){return Na(Se(Na(e/a))*a)}function Rn(e,a){return Na($t(Na(e/a))*a)}function _c(e,a){return Na(wt(Na(e/a))*a)}function Se(e,a=0){if(kc(e))return e;let r=10**a,n=e*r*(1+Number.EPSILON);return qe(n)/r}var ma=new Map;function wc(e){return((""+e).split(".")[1]||"").length}function Kr(e,a,r,n){let s=[],o=n.map(wc);for(let l=a;l<r;l++){let i=Ye(l),u=Se(yr(e,l),i);for(let d=0;d<n.length;d++){let g=e==10?+`${n[d]}e${l}`:n[d]*u,f=(l>=0?0:i)+(l>=o[d]?0:o[d]),m=e==10?g:Se(g,f);s.push(m),ma.set(m,f)}}return s}var Yr={},vo=[],gr=[null,null],va=Array.isArray,kc=Number.isInteger,jp=e=>e===void 0;function qi(e){return typeof e=="string"}function Nn(e){let a=!1;if(e!=null){let r=e.constructor;a=r==null||r==Object}return a}function Up(e){return e!=null&&typeof e=="object"}var Vp=Object.getPrototypeOf(Uint8Array),Sc="__proto__";function xr(e,a=Nn){let r;if(va(e)){let n=e.find(s=>s!=null);if(va(n)||a(n)){r=Array(e.length);for(let s=0;s<e.length;s++)r[s]=xr(e[s],a)}else r=e.slice()}else if(e instanceof Vp)r=e.slice();else if(a(e)){r={};for(let n in e)n!=Sc&&(r[n]=xr(e[n],a))}else r=e;return r}function je(e){let a=arguments;for(let r=1;r<a.length;r++){let n=a[r];for(let s in n)s!=Sc&&(Nn(e[s])?je(e[s],xr(n[s])):e[s]=xr(n[s]))}return e}var Gp=0,qp=1,Yp=2;function Kp(e,a,r){for(let n=0,s,o=-1;n<a.length;n++){let l=a[n];if(l>o){for(s=l-1;s>=0&&e[s]==null;)e[s--]=null;for(s=l+1;s<r&&e[s]==null;)e[o=s++]=null}}}function Jp(e,a){if(Xp(e)){let l=e[0].slice();for(let i=1;i<e.length;i++)l.push(...e[i].slice(1));return ef(l[0])||(l=Qp(l)),l}let r=new Set;for(let l=0;l<e.length;l++){let u=e[l][0],d=u.length;for(let g=0;g<d;g++)r.add(u[g])}let n=[Array.from(r).sort((l,i)=>l-i)],s=n[0].length,o=new Map;for(let l=0;l<s;l++)o.set(n[0][l],l);for(let l=0;l<e.length;l++){let i=e[l],u=i[0];for(let d=1;d<i.length;d++){let g=i[d],f=Array(s).fill(void 0),m=a?a[l][d]:qp,b=[];for(let h=0;h<g.length;h++){let C=g[h],A=o.get(u[h]);C===null?m!=Gp&&(f[A]=C,m==Yp&&b.push(A)):f[A]=C}Kp(f,b,s),n.push(f)}}return n}var Zp=typeof queueMicrotask>"u"?e=>Promise.resolve().then(e):queueMicrotask;function Qp(e){let a=e[0],r=a.length,n=Array(r);for(let o=0;o<n.length;o++)n[o]=o;n.sort((o,l)=>a[o]-a[l]);let s=[];for(let o=0;o<e.length;o++){let l=e[o],i=Array(r);for(let u=0;u<r;u++)i[u]=l[n[u]];s.push(i)}return s}function Xp(e){let a=e[0][0],r=a.length;for(let n=1;n<e.length;n++){let s=e[n][0];if(s.length!=r)return!1;if(s!=a){for(let o=0;o<r;o++)if(s[o]!=a[o])return!1}}return!0}function ef(e,a=100){let r=e.length;if(r<=1)return!0;let n=0,s=r-1;for(;n<=s&&e[n]==null;)n++;for(;s>=n&&e[s]==null;)s--;if(s<=n)return!0;let o=ut(1,wt((s-n+1)/a));for(let l=e[n],i=n+o;i<=s;i+=o){let u=e[i];if(u!=null){if(u<=l)return!1;l=u}}return!0}var Ac=["January","February","March","April","May","June","July","August","September","October","November","December"],Cc=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function Tc(e){return e.slice(0,3)}var tf=Cc.map(Tc),af=Ac.map(Tc),rf={MMMM:Ac,MMM:af,WWWW:Cc,WWW:tf};function jr(e){return(e<10?"0":"")+e}function nf(e){return(e<10?"00":e<100?"0":"")+e}var sf={YYYY:e=>e.getFullYear(),YY:e=>(e.getFullYear()+"").slice(2),MMMM:(e,a)=>a.MMMM[e.getMonth()],MMM:(e,a)=>a.MMM[e.getMonth()],MM:e=>jr(e.getMonth()+1),M:e=>e.getMonth()+1,DD:e=>jr(e.getDate()),D:e=>e.getDate(),WWWW:(e,a)=>a.WWWW[e.getDay()],WWW:(e,a)=>a.WWW[e.getDay()],HH:e=>jr(e.getHours()),H:e=>e.getHours(),h:e=>{let a=e.getHours();return a==0?12:a>12?a-12:a},AA:e=>e.getHours()>=12?"PM":"AM",aa:e=>e.getHours()>=12?"pm":"am",a:e=>e.getHours()>=12?"p":"a",mm:e=>jr(e.getMinutes()),m:e=>e.getMinutes(),ss:e=>jr(e.getSeconds()),s:e=>e.getSeconds(),fff:e=>nf(e.getMilliseconds())};function mo(e,a){a=a||rf;let r=[],n=/\{([a-z]+)\}|[^{]+/gi,s;for(;s=n.exec(e);)r.push(s[0][0]=="{"?sf[s[1]]:s[0]);return o=>{let l="";for(let i=0;i<r.length;i++)l+=typeof r[i]=="string"?r[i]:r[i](o,a);return l}}var of=new Intl.DateTimeFormat().resolvedOptions().timeZone;function lf(e,a){let r;return a=="UTC"||a=="Etc/UTC"?r=new Date(+e+e.getTimezoneOffset()*6e4):a==of?r=e:(r=new Date(e.toLocaleString("en-US",{timeZone:a})),r.setMilliseconds(e.getMilliseconds())),r}var Mc=e=>e%1==0,$n=[1,2,2.5,5],cf=Kr(10,-32,0,$n),Ec=Kr(10,0,32,$n),df=Ec.filter(Mc),Da=cf.concat(Ec),yo=`
`,Pc="{YYYY}",Yi=yo+Pc,Lc="{M}/{D}",Gr=yo+Lc,Tn=Gr+"/{YY}",$c="{aa}",uf="{h}:{mm}",vr=uf+$c,Ki=yo+vr,Ji=":{ss}",be=null;function Dc(e){let a=e*1e3,r=a*60,n=r*60,s=n*24,o=s*30,l=s*365,u=(e==1?Kr(10,0,3,$n).filter(Mc):Kr(10,-3,0,$n)).concat([a,a*5,a*10,a*15,a*30,r,r*5,r*10,r*15,r*30,n,n*2,n*3,n*4,n*6,n*8,n*12,s,s*2,s*3,s*4,s*5,s*6,s*7,s*8,s*9,s*10,s*15,o,o*2,o*3,o*4,o*6,l,l*2,l*5,l*10,l*25,l*50,l*100]),d=[[l,Pc,be,be,be,be,be,be,1],[s*28,"{MMM}",Yi,be,be,be,be,be,1],[s,Lc,Yi,be,be,be,be,be,1],[n,"{h}"+$c,Tn,be,Gr,be,be,be,1],[r,vr,Tn,be,Gr,be,be,be,1],[a,Ji,Tn+" "+vr,be,Gr+" "+vr,be,Ki,be,1],[e,Ji+".{fff}",Tn+" "+vr,be,Gr+" "+vr,be,Ki,be,1]];function g(f){return(m,b,h,C,A,M)=>{let _=[],S=A>=l,k=A>=o&&A<l,O=f(h),L=Se(O*e,3),H=Ys(O.getFullYear(),S?0:O.getMonth(),k||S?1:O.getDate()),R=Se(H*e,3);if(k||S){let W=k?A/o:0,B=S?A/l:0,$=L==R?L:Se(Ys(H.getFullYear()+B,H.getMonth()+W,1)*e,3),q=new Date(qe($/e)),G=q.getFullYear(),Z=q.getMonth();for(let Y=0;$<=C;Y++){let E=Ys(G+B*Y,Z+W*Y,1),P=E-f(Se(E*e,3));$=Se((+E+P)*e,3),$<=C&&_.push($)}}else{let W=A>=s?s:A,B=wt(h)-wt(L),$=R+B+Rn(L-R,W);_.push($);let q=f($),G=q.getHours()+q.getMinutes()/r+q.getSeconds()/n,Z=A/n,Y=m.axes[b]._space,E=M/Y;for(;$=Se($+A,e==1?0:3),!($>C);)if(Z>1){let P=wt(Se(G+Z,6))%24,re=f($).getHours()-P;re>1&&(re=-1),$-=re*n,G=(G+Z)%24;let me=_[_.length-1];Se(($-me)/A,3)*E>=.7&&_.push($)}else _.push($)}return _}}return[u,d,g]}var[pf,ff,vf]=Dc(1),[mf,yf,gf]=Dc(.001);Kr(2,-53,53,[1]);function Zi(e,a){return e.map(r=>r.map((n,s)=>s==0||s==8||n==null?n:a(s==1||r[8]==0?n:r[1]+n)))}function Qi(e,a){return(r,n,s,o,l)=>{let i=a.find(h=>l>=h[0])||a[a.length-1],u,d,g,f,m,b;return n.map(h=>{let C=e(h),A=C.getFullYear(),M=C.getMonth(),_=C.getDate(),S=C.getHours(),k=C.getMinutes(),O=C.getSeconds(),L=A!=u&&i[2]||M!=d&&i[3]||_!=g&&i[4]||S!=f&&i[5]||k!=m&&i[6]||O!=b&&i[7]||i[1];return u=A,d=M,g=_,f=S,m=k,b=O,L(C)})}}function xf(e,a){let r=mo(a);return(n,s,o,l,i)=>s.map(u=>r(e(u)))}function Ys(e,a,r){return new Date(e,a,r)}function Xi(e,a){return a(e)}var bf="{YYYY}-{MM}-{DD} {h}:{mm}{aa}";function ec(e,a){return(r,n,s,o)=>o==null?io:a(e(n))}function hf(e,a){let r=e.series[a];return r.width?r.stroke(e,a):r.points.width?r.points.stroke(e,a):null}function _f(e,a){return e.series[a].fill(e,a)}var wf={show:!0,live:!0,isolate:!1,mount:Fp,markers:{show:!0,width:2,stroke:hf,fill:_f,dash:"solid"},idx:null,idxs:null,values:[]};function kf(e,a){let r=e.cursor.points,n=Lt(),s=r.size(e,a);Le(n,Ur,s),Le(n,Vr,s);let o=s/-2;Le(n,"marginLeft",o),Le(n,"marginTop",o);let l=r.width(e,a,s);return l&&Le(n,"borderWidth",l),n}function Sf(e,a){let r=e.series[a].points;return r._fill||r._stroke}function Af(e,a){let r=e.series[a].points;return r._stroke||r._fill}function Cf(e,a){return e.series[a].points.size}var Ks=[0,0];function Tf(e,a,r){return Ks[0]=a,Ks[1]=r,Ks}function Mn(e,a,r,n=!0){return s=>{s.button==0&&(!n||s.target==a)&&r(s)}}function Js(e,a,r,n=!0){return s=>{(!n||s.target==a)&&r(s)}}var Mf={show:!0,x:!0,y:!0,lock:!1,move:Tf,points:{one:!1,show:kf,size:Cf,width:0,stroke:Af,fill:Sf},bind:{mousedown:Mn,mouseup:Mn,click:Mn,dblclick:Mn,mousemove:Js,mouseleave:Js,mouseenter:Js},drag:{setScale:!0,x:!0,y:!1,dist:0,uni:null,click:(e,a)=>{a.stopPropagation(),a.stopImmediatePropagation()},_x:!1,_y:!1},focus:{dist:(e,a,r,n,s)=>n-s,prox:-1,bias:0},hover:{skip:[void 0],prox:null,bias:0},left:-10,top:-10,idx:null,dataIdx:null,idxs:null,event:null},Ic={show:!0,stroke:"rgba(0,0,0,0.07)",width:2},go=je({},Ic,{filter:hc}),Rc=je({},go,{size:10}),Nc=je({},Ic,{show:!1}),xo='12px system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',Oc="bold "+xo,Hc=1.5,tc={show:!0,scale:"x",stroke:lo,space:50,gap:5,alignTo:1,size:50,labelGap:0,labelSize:30,labelFont:Oc,side:2,grid:go,ticks:Rc,border:Nc,font:xo,lineGap:Hc,rotate:0},Ef="Value",Pf="Time",ac={show:!0,scale:"x",auto:!1,sorted:1,min:ke,max:-ke,idxs:[]};function Lf(e,a,r,n,s){return a.map(o=>o==null?"":fo(o))}function $f(e,a,r,n,s,o,l){let i=[],u=ma.get(s)||0;r=l?r:Se(Rn(r,s),u);for(let d=r;d<=n;d=Se(d+s,u))i.push(Object.is(d,-0)?0:d);return i}function ao(e,a,r,n,s,o,l){let i=[],u=e.scales[e.axes[a].scale].log,d=u==10?ra:gc,g=wt(d(r));s=yr(u,g),u==10&&(s=Da[zt(s,Da)]);let f=r,m=s*u;u==10&&(m=Da[zt(m,Da)]);do i.push(f),f=f+s,u==10&&!ma.has(f)&&(f=Se(f,ma.get(s))),f>=m&&(s=f,m=s*u,u==10&&(m=Da[zt(m,Da)]));while(f<=n);return i}function Df(e,a,r,n,s,o,l){let u=e.scales[e.axes[a].scale].asinh,d=n>u?ao(e,a,ut(u,r),n,s):[u],g=n>=0&&r<=0?[0]:[];return(r<-u?ao(e,a,ut(u,-n),-r,s):[u]).reverse().map(m=>-m).concat(g,d)}var zc=/./,If=/[12357]/,Rf=/[125]/,rc=/1/,ro=(e,a,r,n)=>e.map((s,o)=>a==4&&s==0||o%n==0&&r.test(s.toExponential()[s<0?1:0])?s:null);function Nf(e,a,r,n,s){let o=e.axes[r],l=o.scale,i=e.scales[l],u=e.valToPos,d=o._space,g=u(10,l),f=u(9,l)-g>=d?zc:u(7,l)-g>=d?If:u(5,l)-g>=d?Rf:rc;if(f==rc){let m=Ye(u(1,l)-g);if(m<d)return ro(a.slice().reverse(),i.distr,f,$t(d/m)).reverse()}return ro(a,i.distr,f,1)}function Of(e,a,r,n,s){let o=e.axes[r],l=o.scale,i=o._space,u=e.valToPos,d=Ye(u(1,l)-u(2,l));return d<i?ro(a.slice().reverse(),3,zc,$t(i/d)).reverse():a}function Hf(e,a,r,n){return n==null?io:a==null?"":fo(a)}var nc={show:!0,scale:"y",stroke:lo,space:30,gap:5,alignTo:1,size:50,labelGap:0,labelSize:30,labelFont:Oc,side:3,grid:go,ticks:Rc,border:Nc,font:xo,lineGap:Hc,rotate:0};function zf(e,a){let r=3+(e||1)*2;return Se(r*a,3)}function Ff(e,a){let{scale:r,idxs:n}=e.series[0],s=e._data[0],o=e.valToPos(s[n[0]],r,!0),l=e.valToPos(s[n[1]],r,!0),i=Ye(l-o),u=e.series[a],d=i/(u.points.space*fe);return n[1]-n[0]<=d}var sc={scale:null,auto:!0,sorted:0,min:ke,max:-ke},Fc=(e,a,r,n,s)=>s,oc={show:!0,auto:!0,sorted:0,gaps:Fc,alpha:1,facets:[je({},sc,{scale:"x"}),je({},sc,{scale:"y"})]},lc={scale:"y",auto:!0,sorted:0,show:!0,spanGaps:!1,gaps:Fc,alpha:1,points:{show:Ff,filter:null},values:null,min:ke,max:-ke,idxs:[],path:null,clip:null};function Bf(e,a,r,n,s){return r/10}var Bc={time:!0,auto:!0,distr:1,log:10,asinh:1,min:null,max:null,dir:1,ori:0},Wf=je({},Bc,{time:!1,ori:1}),ic={};function Wc(e,a){let r=ic[e];return r||(r={key:e,plots:[],sub(n){r.plots.push(n)},unsub(n){r.plots=r.plots.filter(s=>s!=n)},pub(n,s,o,l,i,u,d){for(let g=0;g<r.plots.length;g++)r.plots[g]!=s&&r.plots[g].pub(n,s,o,l,i,u,d)}},e!=null&&(ic[e]=r)),r}var br=1,no=2;function Oa(e,a,r){let n=e.mode,s=e.series[a],o=n==2?e._data[a]:e._data,l=e.scales,i=e.bbox,u=o[0],d=n==2?o[1]:o[a],g=n==2?l[s.facets[0].scale]:l[e.series[0].scale],f=n==2?l[s.facets[1].scale]:l[s.scale],m=i.left,b=i.top,h=i.width,C=i.height,A=e.valToPosH,M=e.valToPosV;return g.ori==0?r(s,u,d,g,f,A,M,m,b,h,C,Hn,_r,Fn,Uc,Gc):r(s,u,d,g,f,M,A,b,m,C,h,zn,wr,_o,Vc,qc)}function bo(e,a){let r=0,n=0,s=de(e.bands,vo);for(let o=0;o<s.length;o++){let l=s[o];l.series[0]==a?r=l.dir:l.series[1]==a&&(l.dir==1?n|=1:n|=2)}return[r,n==1?-1:n==2?1:n==3?2:0]}function jf(e,a,r,n,s){let o=e.mode,l=e.series[a],i=o==2?l.facets[1].scale:l.scale,u=e.scales[i];return s==-1?u.min:s==1?u.max:u.distr==3?u.dir==1?u.min:u.max:0}function na(e,a,r,n,s,o){return Oa(e,a,(l,i,u,d,g,f,m,b,h,C,A)=>{let M=l.pxRound,_=d.dir*(d.ori==0?1:-1),S=d.ori==0?_r:wr,k,O;_==1?(k=r,O=n):(k=n,O=r);let L=M(f(i[k],d,C,b)),H=M(m(u[k],g,A,h)),R=M(f(i[O],d,C,b)),W=M(m(o==1?g.max:g.min,g,A,h)),B=new Path2D(s);return S(B,R,W),S(B,L,W),S(B,L,H),B})}function On(e,a,r,n,s,o){let l=null;if(e.length>0){l=new Path2D;let i=a==0?Fn:_o,u=r;for(let f=0;f<e.length;f++){let m=e[f];if(m[1]>m[0]){let b=m[0]-u;b>0&&i(l,u,n,b,n+o),u=m[1]}}let d=r+s-u,g=10;d>0&&i(l,u,n-g/2,d,n+o+g)}return l}function Uf(e,a,r){let n=e[e.length-1];n&&n[0]==a?n[1]=r:e.push([a,r])}function ho(e,a,r,n,s,o,l){let i=[],u=e.length;for(let d=s==1?r:n;d>=r&&d<=n;d+=s)if(a[d]===null){let f=d,m=d;if(s==1)for(;++d<=n&&a[d]===null;)m=d;else for(;--d>=r&&a[d]===null;)m=d;let b=o(e[f]),h=m==f?b:o(e[m]),C=f-s;b=l<=0&&C>=0&&C<u?o(e[C]):b;let M=m+s;h=l>=0&&M>=0&&M<u?o(e[M]):h,h>=b&&i.push([b,h])}return i}function cc(e){return e==0?bc:e==1?qe:a=>$a(a,e)}function jc(e){let a=e==0?Hn:zn,r=e==0?(s,o,l,i,u,d)=>{s.arcTo(o,l,i,u,d)}:(s,o,l,i,u,d)=>{s.arcTo(l,o,u,i,d)},n=e==0?(s,o,l,i,u)=>{s.rect(o,l,i,u)}:(s,o,l,i,u)=>{s.rect(l,o,u,i)};return(s,o,l,i,u,d=0,g=0)=>{d==0&&g==0?n(s,o,l,i,u):(d=Ft(d,i/2,u/2),g=Ft(g,i/2,u/2),a(s,o+d,l),r(s,o+i,l,o+i,l+u,d),r(s,o+i,l+u,o,l+u,g),r(s,o,l+u,o,l,g),r(s,o,l,o+i,l,d),s.closePath())}}var Hn=(e,a,r)=>{e.moveTo(a,r)},zn=(e,a,r)=>{e.moveTo(r,a)},_r=(e,a,r)=>{e.lineTo(a,r)},wr=(e,a,r)=>{e.lineTo(r,a)},Fn=jc(0),_o=jc(1),Uc=(e,a,r,n,s,o)=>{e.arc(a,r,n,s,o)},Vc=(e,a,r,n,s,o)=>{e.arc(r,a,n,s,o)},Gc=(e,a,r,n,s,o,l)=>{e.bezierCurveTo(a,r,n,s,o,l)},qc=(e,a,r,n,s,o,l)=>{e.bezierCurveTo(r,a,s,n,l,o)};function Yc(e){return(a,r,n,s,o)=>Oa(a,r,(l,i,u,d,g,f,m,b,h,C,A)=>{let{pxRound:M,points:_}=l,S,k;d.ori==0?(S=Hn,k=Uc):(S=zn,k=Vc);let O=Se(_.width*fe,3),L=(_.size-_.width)/2*fe,H=Se(L*2,3),R=new Path2D,W=new Path2D,{left:B,top:$,width:q,height:G}=a.bbox;Fn(W,B-H,$-H,q+H*2,G+H*2);let Z=Y=>{if(u[Y]!=null){let E=M(f(i[Y],d,C,b)),P=M(m(u[Y],g,A,h));S(R,E+L,P),k(R,E,P,L,0,En*2)}};if(o)o.forEach(Z);else for(let Y=n;Y<=s;Y++)Z(Y);return{stroke:O>0?R:null,fill:R,clip:W,flags:br|no}})}function Kc(e){return(a,r,n,s,o,l)=>{n!=s&&(o!=n&&l!=n&&e(a,r,n),o!=s&&l!=s&&e(a,r,s),e(a,r,l))}}var Vf=Kc(_r),Gf=Kc(wr);function Jc(e){let a=de(e?.alignGaps,0);return(r,n,s,o)=>Oa(r,n,(l,i,u,d,g,f,m,b,h,C,A)=>{[s,o]=Dn(u,s,o);let M=l.pxRound,_=G=>M(f(G,d,C,b)),S=G=>M(m(G,g,A,h)),k,O;d.ori==0?(k=_r,O=Vf):(k=wr,O=Gf);let L=d.dir*(d.ori==0?1:-1),H={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:br},R=H.stroke,W=!1;if(o-s>=C*4){let G=K=>r.posToVal(K,d.key,!0),Z=null,Y=null,E,P,ae,he=_(i[L==1?s:o]),re=_(i[s]),me=_(i[o]),te=G(L==1?re+1:me-1);for(let K=L==1?s:o;K>=s&&K<=o;K+=L){let Ue=i[K],$e=(L==1?Ue<te:Ue>te)?he:_(Ue),ye=u[K];$e==he?ye!=null?(P=ye,Z==null?(k(R,$e,S(P)),E=Z=Y=P):P<Z?Z=P:P>Y&&(Y=P)):ye===null&&(W=!0):(Z!=null&&O(R,he,S(Z),S(Y),S(E),S(P)),ye!=null?(P=ye,k(R,$e,S(P)),Z=Y=E=P):(Z=Y=null,ye===null&&(W=!0)),he=$e,te=G(he+L))}Z!=null&&Z!=Y&&ae!=he&&O(R,he,S(Z),S(Y),S(E),S(P))}else for(let G=L==1?s:o;G>=s&&G<=o;G+=L){let Z=u[G];Z===null?W=!0:Z!=null&&k(R,_(i[G]),S(Z))}let[$,q]=bo(r,n);if(l.fill!=null||$!=0){let G=H.fill=new Path2D(R),Z=l.fillTo(r,n,l.min,l.max,$),Y=S(Z),E=_(i[s]),P=_(i[o]);L==-1&&([P,E]=[E,P]),k(G,P,Y),k(G,E,Y)}if(!l.spanGaps){let G=[];W&&G.push(...ho(i,u,s,o,L,_,a)),H.gaps=G=l.gaps(r,n,s,o,G),H.clip=On(G,d.ori,b,h,C,A)}return q!=0&&(H.band=q==2?[na(r,n,s,o,R,-1),na(r,n,s,o,R,1)]:na(r,n,s,o,R,q)),H})}function qf(e){let a=de(e.align,1),r=de(e.ascDesc,!1),n=de(e.alignGaps,0),s=de(e.extend,!1);return(o,l,i,u)=>Oa(o,l,(d,g,f,m,b,h,C,A,M,_,S)=>{[i,u]=Dn(f,i,u);let k=d.pxRound,{left:O,width:L}=o.bbox,H=re=>k(h(re,m,_,A)),R=re=>k(C(re,b,S,M)),W=m.ori==0?_r:wr,B={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:br},$=B.stroke,q=m.dir*(m.ori==0?1:-1),G=R(f[q==1?i:u]),Z=H(g[q==1?i:u]),Y=Z,E=Z;s&&a==-1&&(E=O,W($,E,G)),W($,Z,G);for(let re=q==1?i:u;re>=i&&re<=u;re+=q){let me=f[re];if(me==null)continue;let te=H(g[re]),K=R(me);a==1?W($,te,G):W($,Y,K),W($,te,K),G=K,Y=te}let P=Y;s&&a==1&&(P=O+L,W($,P,G));let[ae,he]=bo(o,l);if(d.fill!=null||ae!=0){let re=B.fill=new Path2D($),me=d.fillTo(o,l,d.min,d.max,ae),te=R(me);W(re,P,te),W(re,E,te)}if(!d.spanGaps){let re=[];re.push(...ho(g,f,i,u,q,H,n));let me=d.width*fe/2,te=r||a==1?me:-me,K=r||a==-1?-me:me;re.forEach(Ue=>{Ue[0]+=te,Ue[1]+=K}),B.gaps=re=d.gaps(o,l,i,u,re),B.clip=On(re,m.ori,A,M,_,S)}return he!=0&&(B.band=he==2?[na(o,l,i,u,$,-1),na(o,l,i,u,$,1)]:na(o,l,i,u,$,he)),B})}function dc(e,a,r,n,s,o,l=ke){if(e.length>1){let i=null;for(let u=0,d=1/0;u<e.length;u++)if(a[u]!==void 0){if(i!=null){let g=Ye(e[u]-e[i]);g<d&&(d=g,l=Ye(r(e[u],n,s,o)-r(e[i],n,s,o)))}i=u}}return l}function Yf(e){e=e||Yr;let a=de(e.size,[.6,ke,1]),r=e.align||0,n=e.gap||0,s=e.radius;s=s==null?[0,0]:typeof s=="number"?[s,0]:s;let o=se(s),l=1-a[0],i=de(a[1],ke),u=de(a[2],1),d=de(e.disp,Yr),g=de(e.each,b=>{}),{fill:f,stroke:m}=d;return(b,h,C,A)=>Oa(b,h,(M,_,S,k,O,L,H,R,W,B,$)=>{let q=M.pxRound,G=r,Z=n*fe,Y=i*fe,E=u*fe,P,ae;k.ori==0?[P,ae]=o(b,h):[ae,P]=o(b,h);let he=k.dir*(k.ori==0?1:-1),re=k.ori==0?Fn:_o,me=k.ori==0?g:(j,Ae,Ve,Ua,xa,Wt,ba)=>{g(j,Ae,Ve,xa,Ua,ba,Wt)},te=de(b.bands,vo).find(j=>j.series[0]==h),K=te!=null?te.dir:0,Ue=M.fillTo(b,h,M.min,M.max,K),st=q(H(Ue,O,$,W)),$e,ye,Dt,mt=B,Ie=q(M.width*fe),Bt=!1,Xt=null,St=null,sa=null,Ba=null;f!=null&&(Ie==0||m!=null)&&(Bt=!0,Xt=f.values(b,h,C,A),St=new Map,new Set(Xt).forEach(j=>{j!=null&&St.set(j,new Path2D)}),Ie>0&&(sa=m.values(b,h,C,A),Ba=new Map,new Set(sa).forEach(j=>{j!=null&&Ba.set(j,new Path2D)})));let{x0:Wa,size:Ar}=d;if(Wa!=null&&Ar!=null){G=1,_=Wa.values(b,h,C,A),Wa.unit==2&&(_=_.map(Ve=>b.posToVal(R+Ve*B,k.key,!0)));let j=Ar.values(b,h,C,A);Ar.unit==2?ye=j[0]*B:ye=L(j[0],k,B,R)-L(0,k,B,R),mt=dc(_,S,L,k,B,R,mt),Dt=mt-ye+Z}else mt=dc(_,S,L,k,B,R,mt),Dt=mt*l+Z,ye=mt-Dt;Dt<1&&(Dt=0),Ie>=ye/2&&(Ie=0),Dt<5&&(q=bc);let en=Dt>0,ya=mt-Dt-(en?Ie:0);ye=q(to(ya,E,Y)),$e=(G==0?ye/2:G==he?0:ye)-G*he*((G==0?Z/2:0)+(en?Ie/2:0));let ot={stroke:null,fill:null,clip:null,band:null,gaps:null,flags:0},ja=Bt?null:new Path2D,ea=null;if(te!=null)ea=b.data[te.series[1]];else{let{y0:j,y1:Ae}=d;j!=null&&Ae!=null&&(S=Ae.values(b,h,C,A),ea=j.values(b,h,C,A))}let ga=P*ye,ee=ae*ye;for(let j=he==1?C:A;j>=C&&j<=A;j+=he){let Ae=S[j];if(Ae==null)continue;if(ea!=null){let pt=ea[j]??0;if(Ae-pt==0)continue;st=H(pt,O,$,W)}let Ve=k.distr!=2||d!=null?_[j]:j,Ua=L(Ve,k,B,R),xa=H(de(Ae,Ue),O,$,W),Wt=q(Ua-$e),ba=q(ut(xa,st)),yt=q(Ft(xa,st)),At=ba-yt;if(Ae!=null){let pt=Ae<0?ee:ga,It=Ae<0?ga:ee;Bt?(Ie>0&&sa[j]!=null&&re(Ba.get(sa[j]),Wt,yt+wt(Ie/2),ye,ut(0,At-Ie),pt,It),Xt[j]!=null&&re(St.get(Xt[j]),Wt,yt+wt(Ie/2),ye,ut(0,At-Ie),pt,It)):re(ja,Wt,yt+wt(Ie/2),ye,ut(0,At-Ie),pt,It),me(b,h,j,Wt-Ie/2,yt,ye+Ie,At)}}return Ie>0?ot.stroke=Bt?Ba:ja:Bt||(ot._fill=M.width==0?M._fill:M._stroke??M._fill,ot.width=0),ot.fill=Bt?St:ja,ot})}function Kf(e,a){let r=de(a?.alignGaps,0);return(n,s,o,l)=>Oa(n,s,(i,u,d,g,f,m,b,h,C,A,M)=>{[o,l]=Dn(d,o,l);let _=i.pxRound,S=P=>_(m(P,g,A,h)),k=P=>_(b(P,f,M,C)),O,L,H;g.ori==0?(O=Hn,H=_r,L=Gc):(O=zn,H=wr,L=qc);let R=g.dir*(g.ori==0?1:-1),W=S(u[R==1?o:l]),B=W,$=[],q=[];for(let P=R==1?o:l;P>=o&&P<=l;P+=R)if(d[P]!=null){let he=u[P],re=S(he);$.push(B=re),q.push(k(d[P]))}let G={stroke:e($,q,O,H,L,_),fill:null,clip:null,band:null,gaps:null,flags:br},Z=G.stroke,[Y,E]=bo(n,s);if(i.fill!=null||Y!=0){let P=G.fill=new Path2D(Z),ae=i.fillTo(n,s,i.min,i.max,Y),he=k(ae);H(P,B,he),H(P,W,he)}if(!i.spanGaps){let P=[];P.push(...ho(u,d,o,l,R,S,r)),G.gaps=P=i.gaps(n,s,o,l,P),G.clip=On(P,g.ori,h,C,A,M)}return E!=0&&(G.band=E==2?[na(n,s,o,l,Z,-1),na(n,s,o,l,Z,1)]:na(n,s,o,l,Z,E)),G})}function Jf(e){return Kf(Zf,e)}function Zf(e,a,r,n,s,o){let l=e.length;if(l<2)return null;let i=new Path2D;if(r(i,e[0],a[0]),l==2)n(i,e[1],a[1]);else{let u=Array(l),d=Array(l-1),g=Array(l-1),f=Array(l-1);for(let m=0;m<l-1;m++)g[m]=a[m+1]-a[m],f[m]=e[m+1]-e[m],d[m]=g[m]/f[m];u[0]=d[0];for(let m=1;m<l-1;m++)d[m]===0||d[m-1]===0||d[m-1]>0!=d[m]>0?u[m]=0:(u[m]=3*(f[m-1]+f[m])/((2*f[m]+f[m-1])/d[m-1]+(f[m]+2*f[m-1])/d[m]),isFinite(u[m])||(u[m]=0));u[l-1]=d[l-2];for(let m=0;m<l-1;m++)s(i,e[m]+f[m]/3,a[m]+u[m]*f[m]/3,e[m+1]-f[m]/3,a[m+1]-u[m+1]*f[m]/3,e[m+1],a[m+1])}return i}var so=new Set;function uc(){for(let e of so)e.syncRect(!0)}hr&&(Ra(Pp,mr,uc),Ra(Lp,mr,uc,!0),Ra(Pn,mr,()=>{rt.pxRatio=fe}));var Qf=Jc(),Xf=Yc();function pc(e,a,r,n){return(n?[e[0],e[1]].concat(e.slice(2)):[e[0]].concat(e.slice(1))).map((o,l)=>oo(o,l,a,r))}function ev(e,a){return e.map((r,n)=>n==0?{}:je({},a,r))}function oo(e,a,r,n){return je({},a==0?r:n,e)}function Zc(e,a,r){return a==null?gr:[a,r]}var tv=Zc;function av(e,a,r){return a==null?gr:Ln(a,r,po,!0)}function Qc(e,a,r,n){return a==null?gr:In(a,r,e.scales[n].log,!1)}var rv=Qc;function Xc(e,a,r,n){return a==null?gr:uo(a,r,e.scales[n].log,!1)}var nv=Xc;function sv(e,a,r,n,s){let o=ut(Ui(e),Ui(a)),l=a-e,i=zt(s/n*l,r);do{let u=r[i],d=n*u/l;if(d>=s&&o+(u<5?ma.get(u):0)<=17)return[u,d]}while(++i<r.length);return[0,0]}function fc(e){let a,r;return e=e.replace(/(\d+)px/,(n,s)=>(a=qe((r=+s)*fe))+"px"),[e,a,r]}function ov(e){e.show&&[e.font,e.labelFont].forEach(a=>{let r=Se(a[2]*fe,1);a[0]=a[0].replace(/[0-9.]+px/,r+"px"),a[1]=r})}function rt(e,a,r){let n={mode:de(e.mode,1)},s=n.mode;function o(c,p,v,y){let x=p.valToPct(c);return y+v*(p.dir==-1?1-x:x)}function l(c,p,v,y){let x=p.valToPct(c);return y+v*(p.dir==-1?x:1-x)}function i(c,p,v,y){return p.ori==0?o(c,p,v,y):l(c,p,v,y)}n.valToPosH=o,n.valToPosV=l;let u=!1;n.status=0;let d=n.root=Lt(pp);if(e.id!=null&&(d.id=e.id),_t(d,e.class),e.title){let c=Lt(mp,d);c.textContent=e.title}let g=Ht("canvas"),f=n.ctx=g.getContext("2d"),m=Lt(yp,d);Ra("click",m,c=>{c.target===h&&(Te!=tr||De!=ar)&&at.click(n,c)},!0);let b=n.under=Lt(gp,m);m.appendChild(g);let h=n.over=Lt(xp,m);e=xr(e);let C=+de(e.pxAlign,1),A=cc(C);(e.plugins||[]).forEach(c=>{c.opts&&(e=c.opts(n,e)||e)});let M=e.ms||.001,_=n.series=s==1?pc(e.series||[],ac,lc,!1):ev(e.series||[null],oc),S=n.axes=pc(e.axes||[],tc,nc,!0),k=n.scales={},O=n.bands=e.bands||[];O.forEach(c=>{c.fill=se(c.fill||null),c.dir=de(c.dir,-1)});let L=s==2?_[1].facets[0].scale:_[0].scale,H={axes:ru,series:Qd},R=(e.drawOrder||["axes","series"]).map(c=>H[c]);function W(c){let p=c.distr==3?v=>ra(v>0?v:c.clamp(n,v,c.min,c.max,c.key)):c.distr==4?v=>qs(v,c.asinh):c.distr==100?v=>c.fwd(v):v=>v;return v=>{let y=p(v),{_min:x,_max:w}=c,T=w-x;return(y-x)/T}}function B(c){let p=k[c];if(p==null){let v=(e.scales||Yr)[c]||Yr;if(v.from!=null){B(v.from);let y=je({},k[v.from],v,{key:c});y.valToPct=W(y),k[c]=y}else{p=k[c]=je({},c==L?Bc:Wf,v),p.key=c;let y=p.time,x=p.range,w=va(x);if((c!=L||s==2&&!y)&&(w&&(x[0]==null||x[1]==null)&&(x={min:x[0]==null?Bi:{mode:1,hard:x[0],soft:x[0]},max:x[1]==null?Bi:{mode:1,hard:x[1],soft:x[1]}},w=!1),!w&&Nn(x))){let T=x;x=(D,I,z)=>I==null?gr:Ln(I,z,T)}p.range=se(x||(y?tv:c==L?p.distr==3?rv:p.distr==4?nv:Zc:p.distr==3?Qc:p.distr==4?Xc:av)),p.auto=se(w?!1:p.auto),p.clamp=se(p.clamp||Bf),p._min=p._max=null,p.valToPct=W(p)}}}B("x"),B("y"),s==1&&_.forEach(c=>{B(c.scale)}),S.forEach(c=>{B(c.scale)});for(let c in e.scales)B(c);let $=k[L],q=$.distr,G,Z;$.ori==0?(_t(d,fp),G=o,Z=l):(_t(d,vp),G=l,Z=o);let Y={};for(let c in k){let p=k[c];(p.min!=null||p.max!=null)&&(Y[c]={min:p.min,max:p.max},p.min=p.max=null)}let E=e.tzDate||(c=>new Date(qe(c/M))),P=e.fmtDate||mo,ae=M==1?vf(E):gf(E),he=Qi(E,Zi(M==1?ff:yf,P)),re=ec(E,Xi(bf,P)),me=[],te=n.legend=je({},wf,e.legend),K=n.cursor=je({},Mf,{drag:{y:s==2}},e.cursor),Ue=te.show,st=K.show,$e=te.markers;te.idxs=me,$e.width=se($e.width),$e.dash=se($e.dash),$e.stroke=se($e.stroke),$e.fill=se($e.fill);let ye,Dt,mt,Ie=[],Bt=[],Xt,St=!1,sa={};if(te.live){let c=_[1]?_[1].values:null;St=c!=null,Xt=St?c(n,1,0):{_:0};for(let p in Xt)sa[p]=io}if(Ue)if(ye=Ht("table",Sp,d),mt=Ht("tbody",null,ye),te.mount(n,ye),St){Dt=Ht("thead",null,ye,mt);let c=Ht("tr",null,Dt);Ht("th",null,c);for(var Ba in Xt)Ht("th",Mi,c).textContent=Ba}else _t(ye,Cp),te.live&&_t(ye,Ap);let Wa={show:!0},Ar={show:!1};function en(c,p){if(p==0&&(St||!te.live||s==2))return gr;let v=[],y=Ht("tr",Tp,mt,mt.childNodes[p]);_t(y,c.class),c.show||_t(y,Ia);let x=Ht("th",null,y);if($e.show){let D=Lt(Mp,x);if(p>0){let I=$e.width(n,p);I&&(D.style.border=I+"px "+$e.dash(n,p)+" "+$e.stroke(n,p)),D.style.background=$e.fill(n,p)}}let w=Lt(Mi,x);c.label instanceof HTMLElement?w.appendChild(c.label):w.textContent=c.label,p>0&&($e.show||(w.style.color=c.width>0?$e.stroke(n,p):$e.fill(n,p)),ot("click",x,D=>{if(K._lock)return;_a(D);let I=_.indexOf(c);if((D.ctrlKey||D.metaKey)!=te.isolate){let z=_.some((F,U)=>U>0&&U!=I&&F.show);_.forEach((F,U)=>{U>0&&Ut(U,z?U==I?Wa:Ar:Wa,!0,Fe.setSeries)})}else Ut(I,{show:!c.show},!0,Fe.setSeries)},!1),Ga&&ot($i,x,D=>{K._lock||(_a(D),Ut(_.indexOf(c),nr,!0,Fe.setSeries))},!1));for(var T in Xt){let D=Ht("td",Ep,y);D.textContent="--",v.push(D)}return[y,v]}let ya=new Map;function ot(c,p,v,y=!0){let x=ya.get(p)||{},w=K.bind[c](n,p,v,y);w&&(Ra(c,p,x[c]=w),ya.set(p,x))}function ja(c,p,v){let y=ya.get(p)||{};for(let x in y)(c==null||x==c)&&(eo(x,p,y[x]),delete y[x]);c==null&&ya.delete(p)}let ea=0,ga=0,ee=0,j=0,Ae=0,Ve=0,Ua=Ae,xa=Ve,Wt=ee,ba=j,yt=0,At=0,pt=0,It=0;n.bbox={};let Yn=!1,tn=!1,Va=!1,ha=!1,an=!1,Ct=!1;function Kn(c,p,v){(v||c!=n.width||p!=n.height)&&el(c,p),Za(!1),Va=!0,tn=!0,Qa()}function el(c,p){n.width=ea=ee=c,n.height=ga=j=p,Ae=Ve=0,Vd(),Gd();let v=n.bbox;yt=v.left=$a(Ae*fe,.5),At=v.top=$a(Ve*fe,.5),pt=v.width=$a(ee*fe,.5),It=v.height=$a(j*fe,.5)}let Wd=3;function jd(){let c=!1,p=0;for(;!c;){p++;let v=tu(p),y=au(p);c=p==Wd||v&&y,c||(el(n.width,n.height),tn=!0)}}function Ud({width:c,height:p}){Kn(c,p)}n.setSize=Ud;function Vd(){let c=!1,p=!1,v=!1,y=!1;S.forEach((x,w)=>{if(x.show&&x._show){let{side:T,_size:D}=x,I=T%2,z=x.label!=null?x.labelSize:0,F=D+z;F>0&&(I?(ee-=F,T==3?(Ae+=F,y=!0):v=!0):(j-=F,T==0?(Ve+=F,c=!0):p=!0))}}),wa[0]=c,wa[1]=v,wa[2]=p,wa[3]=y,ee-=oa[1]+oa[3],Ae+=oa[3],j-=oa[2]+oa[0],Ve+=oa[0]}function Gd(){let c=Ae+ee,p=Ve+j,v=Ae,y=Ve;function x(w,T){switch(w){case 1:return c+=T,c-T;case 2:return p+=T,p-T;case 3:return v-=T,v+T;case 0:return y-=T,y+T}}S.forEach((w,T)=>{if(w.show&&w._show){let D=w.side;w._pos=x(D,w._size),w.label!=null&&(w._lpos=x(D,w.labelSize))}})}if(K.dataIdx==null){let c=K.hover,p=c.skip=new Set(c.skip??[]);p.add(void 0);let v=c.prox=se(c.prox),y=c.bias??=0;K.dataIdx=(x,w,T,D)=>{if(w==0)return T;let I=T,z=v(x,w,T,D)??ke,F=z>=0&&z<ke,U=$.ori==0?ee:j,X=K.left,ue=a[0],ie=a[w];if(p.has(ie[T])){I=null;let ne=null,Q=null,J;if(y==0||y==-1)for(J=T;ne==null&&J-- >0;)p.has(ie[J])||(ne=J);if(y==0||y==1)for(J=T;Q==null&&J++<ie.length;)p.has(ie[J])||(Q=J);if(ne!=null||Q!=null)if(F){let Ee=ne==null?-1/0:G(ue[ne],$,U,0),Re=Q==null?1/0:G(ue[Q],$,U,0),et=X-Ee,_e=Re-X;et<=_e?et<=z&&(I=ne):_e<=z&&(I=Q)}else I=Q==null?ne:ne==null?Q:T-ne<=Q-T?ne:Q}else F&&Ye(X-G(ue[T],$,U,0))>z&&(I=null);return I}}let _a=c=>{K.event=c};K.idxs=me,K._lock=!1;let nt=K.points;nt.show=se(nt.show),nt.size=se(nt.size),nt.stroke=se(nt.stroke),nt.width=se(nt.width),nt.fill=se(nt.fill);let jt=n.focus=je({},e.focus||{alpha:.3},K.focus),Ga=jt.prox>=0,qa=Ga&&nt.one,Tt=[],Ya=[],Ka=[];function tl(c,p){let v=nt.show(n,p);if(v instanceof HTMLElement)return _t(v,kp),_t(v,c.class),Jt(v,-10,-10,ee,j),h.insertBefore(v,Tt[p]),v}function al(c,p){if(s==1||p>0){let v=s==1&&k[c.scale].time,y=c.value;c.value=v?qi(y)?ec(E,Xi(y,P)):y||re:y||Hf,c.label=c.label||(v?Pf:Ef)}if(qa||p>0){c.width=c.width==null?1:c.width,c.paths=c.paths||Qf||Bp,c.fillTo=se(c.fillTo||jf),c.pxAlign=+de(c.pxAlign,C),c.pxRound=cc(c.pxAlign),c.stroke=se(c.stroke||null),c.fill=se(c.fill||null),c._stroke=c._fill=c._paths=c._focus=null;let v=zf(ut(1,c.width),1),y=c.points=je({},{size:v,width:ut(1,v*.2),stroke:c.stroke,space:v*2,paths:Xf,_stroke:null,_fill:null},c.points);y.show=se(y.show),y.filter=se(y.filter),y.fill=se(y.fill),y.stroke=se(y.stroke),y.paths=se(y.paths),y.pxAlign=c.pxAlign}if(Ue){let v=en(c,p);Ie.splice(p,0,v[0]),Bt.splice(p,0,v[1]),te.values.push(null)}if(st){me.splice(p,0,null);let v=null;qa?p==0&&(v=tl(c,p)):p>0&&(v=tl(c,p)),Tt.splice(p,0,v),Ya.splice(p,0,0),Ka.splice(p,0,0)}Xe("addSeries",p)}function qd(c,p){p=p??_.length,c=s==1?oo(c,p,ac,lc):oo(c,p,{},oc),_.splice(p,0,c),al(_[p],p)}n.addSeries=qd;function Yd(c){if(_.splice(c,1),Ue){te.values.splice(c,1),Bt.splice(c,1);let p=Ie.splice(c,1)[0];ja(null,p.firstChild),p.remove()}st&&(me.splice(c,1),Tt.splice(c,1)[0].remove(),Ya.splice(c,1),Ka.splice(c,1)),Xe("delSeries",c)}n.delSeries=Yd;let wa=[!1,!1,!1,!1];function Kd(c,p){if(c._show=c.show,c.show){let v=c.side%2,y=k[c.scale];y==null&&(c.scale=v?_[1].scale:L,y=k[c.scale]);let x=y.time;c.size=se(c.size),c.space=se(c.space),c.rotate=se(c.rotate),va(c.incrs)&&c.incrs.forEach(T=>{!ma.has(T)&&ma.set(T,wc(T))}),c.incrs=se(c.incrs||(y.distr==2?df:x?M==1?pf:mf:Da)),c.splits=se(c.splits||(x&&y.distr==1?ae:y.distr==3?ao:y.distr==4?Df:$f)),c.stroke=se(c.stroke),c.grid.stroke=se(c.grid.stroke),c.ticks.stroke=se(c.ticks.stroke),c.border.stroke=se(c.border.stroke);let w=c.values;c.values=va(w)&&!va(w[0])?se(w):x?va(w)?Qi(E,Zi(w,P)):qi(w)?xf(E,w):w||he:w||Lf,c.filter=se(c.filter||(y.distr>=3&&y.log==10?Nf:y.distr==3&&y.log==2?Of:hc)),c.font=fc(c.font),c.labelFont=fc(c.labelFont),c._size=c.size(n,null,p,0),c._space=c._rotate=c._incrs=c._found=c._splits=c._values=null,c._size>0&&(wa[p]=!0,c._el=Lt(bp,m))}}function Cr(c,p,v,y){let[x,w,T,D]=v,I=p%2,z=0;return I==0&&(D||w)&&(z=p==0&&!x||p==2&&!T?qe(tc.size/3):0),I==1&&(x||T)&&(z=p==1&&!w||p==3&&!D?qe(nc.size/2):0),z}let rl=n.padding=(e.padding||[Cr,Cr,Cr,Cr]).map(c=>se(de(c,Cr))),oa=n._padding=rl.map((c,p)=>c(n,p,wa,0)),tt,Ke=null,Je=null,rn=s==1?_[0].idxs:null,Rt=null,Tr=!1;function nl(c,p){if(a=c??[],n.data=n._data=a,s==2){tt=0;for(let v=1;v<_.length;v++)tt+=a[v][0].length}else{a.length==0&&(n.data=n._data=a=[[]]),Rt=a[0],tt=Rt.length;let v=a;if(q==2){v=a.slice();let y=v[0]=Array(tt);for(let x=0;x<tt;x++)y[x]=x}n._data=a=v}if(Za(!0),Xe("setData"),q==2&&(Va=!0),p!==!1){let v=$;v.auto(n,Tr)?Jn():ia(L,v.min,v.max),ha=ha||K.left>=0,Ct=!0,Qa()}}n.setData=nl;function Jn(){Tr=!0;let c,p;s==1&&(tt>0?(Ke=rn[0]=0,Je=rn[1]=tt-1,c=a[0][Ke],p=a[0][Je],q==2?(c=Ke,p=Je):c==p&&(q==3?[c,p]=In(c,c,$.log,!1):q==4?[c,p]=uo(c,c,$.log,!1):$.time?p=c+qe(86400/M):[c,p]=Ln(c,p,po,!0))):(Ke=rn[0]=c=null,Je=rn[1]=p=null)),ia(L,c,p)}let nn,Ja,Zn,Qn,Xn,es,ts,as,rs,ft;function sl(c,p,v,y,x,w){c??=Pi,v??=vo,y??="butt",x??=Pi,w??="round",c!=nn&&(f.strokeStyle=nn=c),x!=Ja&&(f.fillStyle=Ja=x),p!=Zn&&(f.lineWidth=Zn=p),w!=Xn&&(f.lineJoin=Xn=w),y!=es&&(f.lineCap=es=y),v!=Qn&&f.setLineDash(Qn=v)}function ol(c,p,v,y){p!=Ja&&(f.fillStyle=Ja=p),c!=ts&&(f.font=ts=c),v!=as&&(f.textAlign=as=v),y!=rs&&(f.textBaseline=rs=y)}function ns(c,p,v,y,x=0){if(y.length>0&&c.auto(n,Tr)&&(p==null||p.min==null)){let w=de(Ke,0),T=de(Je,y.length-1),D=v.min==null?Rp(y,w,T,x,c.distr==3):[v.min,v.max];c.min=Ft(c.min,v.min=D[0]),c.max=ut(c.max,v.max=D[1])}}let ll={min:null,max:null};function Jd(){for(let y in k){let x=k[y];Y[y]==null&&(x.min==null||Y[L]!=null&&x.auto(n,Tr))&&(Y[y]=ll)}for(let y in k){let x=k[y];Y[y]==null&&x.from!=null&&Y[x.from]!=null&&(Y[y]=ll)}Y[L]!=null&&Za(!0);let c={};for(let y in Y){let x=Y[y];if(x!=null){let w=c[y]=xr(k[y],Up);if(x.min!=null)je(w,x);else if(y!=L||s==2)if(tt==0&&w.from==null){let T=w.range(n,null,null,y);w.min=T[0],w.max=T[1]}else w.min=ke,w.max=-ke}}if(tt>0){_.forEach((y,x)=>{if(s==1){let w=y.scale,T=Y[w];if(T==null)return;let D=c[w];if(x==0){let I=D.range(n,D.min,D.max,w);D.min=I[0],D.max=I[1],Ke=zt(D.min,a[0]),Je=zt(D.max,a[0]),Je-Ke>1&&(a[0][Ke]<D.min&&Ke++,a[0][Je]>D.max&&Je--),y.min=Rt[Ke],y.max=Rt[Je]}else y.show&&y.auto&&ns(D,T,y,a[x],y.sorted);y.idxs[0]=Ke,y.idxs[1]=Je}else if(x>0&&y.show&&y.auto){let[w,T]=y.facets,D=w.scale,I=T.scale,[z,F]=a[x],U=c[D],X=c[I];U!=null&&ns(U,Y[D],w,z,w.sorted),X!=null&&ns(X,Y[I],T,F,T.sorted),y.min=T.min,y.max=T.max}});for(let y in c){let x=c[y],w=Y[y];if(x.from==null&&(w==null||w.min==null)){let T=x.range(n,x.min==ke?null:x.min,x.max==-ke?null:x.max,y);x.min=T[0],x.max=T[1]}}}for(let y in c){let x=c[y];if(x.from!=null){let w=c[x.from];if(w.min==null)x.min=x.max=null;else{let T=x.range(n,w.min,w.max,y);x.min=T[0],x.max=T[1]}}}let p={},v=!1;for(let y in c){let x=c[y],w=k[y];if(w.min!=x.min||w.max!=x.max){w.min=x.min,w.max=x.max;let T=w.distr;w._min=T==3?ra(w.min):T==4?qs(w.min,w.asinh):T==100?w.fwd(w.min):w.min,w._max=T==3?ra(w.max):T==4?qs(w.max,w.asinh):T==100?w.fwd(w.max):w.max,p[y]=v=!0}}if(v){_.forEach((y,x)=>{s==2?x>0&&p.y&&(y._paths=null):p[y.scale]&&(y._paths=null)});for(let y in p)Va=!0,Xe("setScale",y);st&&K.left>=0&&(ha=Ct=!0)}for(let y in Y)Y[y]=null}function Zd(c){let p=to(Ke-1,0,tt-1),v=to(Je+1,0,tt-1);for(;c[p]==null&&p>0;)p--;for(;c[v]==null&&v<tt-1;)v++;return[p,v]}function Qd(){if(tt>0){let c=_.some(p=>p._focus)&&ft!=jt.alpha;c&&(f.globalAlpha=ft=jt.alpha),_.forEach((p,v)=>{if(v>0&&p.show&&(il(v,!1),il(v,!0),p._paths==null)){let y=ft;ft!=p.alpha&&(f.globalAlpha=ft=p.alpha);let x=s==2?[0,a[v][0].length-1]:Zd(a[v]);p._paths=p.paths(n,v,x[0],x[1]),ft!=y&&(f.globalAlpha=ft=y)}}),_.forEach((p,v)=>{if(v>0&&p.show){let y=ft;ft!=p.alpha&&(f.globalAlpha=ft=p.alpha),p._paths!=null&&cl(v,!1);{let x=p._paths!=null?p._paths.gaps:null,w=p.points.show(n,v,Ke,Je,x),T=p.points.filter(n,v,w,x);(w||T)&&(p.points._paths=p.points.paths(n,v,Ke,Je,T),cl(v,!0))}ft!=y&&(f.globalAlpha=ft=y),Xe("drawSeries",v)}}),c&&(f.globalAlpha=ft=1)}}function il(c,p){let v=p?_[c].points:_[c];v._stroke=v.stroke(n,c),v._fill=v.fill(n,c)}function cl(c,p){let v=p?_[c].points:_[c],{stroke:y,fill:x,clip:w,flags:T,_stroke:D=v._stroke,_fill:I=v._fill,_width:z=v.width}=v._paths;z=Se(z*fe,3);let F=null,U=z%2/2;p&&I==null&&(I=z>0?"#fff":D);let X=v.pxAlign==1&&U>0;if(X&&f.translate(U,U),!p){let ue=yt-z/2,ie=At-z/2,ne=pt+z,Q=It+z;F=new Path2D,F.rect(ue,ie,ne,Q)}p?ss(D,z,v.dash,v.cap,I,y,x,T,w):Xd(c,D,z,v.dash,v.cap,I,y,x,T,F,w),X&&f.translate(-U,-U)}function Xd(c,p,v,y,x,w,T,D,I,z,F){let U=!1;I!=0&&O.forEach((X,ue)=>{if(X.series[0]==c){let ie=_[X.series[1]],ne=a[X.series[1]],Q=(ie._paths||Yr).band;va(Q)&&(Q=X.dir==1?Q[0]:Q[1]);let J,Ee=null;ie.show&&Q&&Op(ne,Ke,Je)?(Ee=X.fill(n,ue)||w,J=ie._paths.clip):Q=null,ss(p,v,y,x,Ee,T,D,I,z,F,J,Q),U=!0}}),U||ss(p,v,y,x,w,T,D,I,z,F)}let dl=br|no;function ss(c,p,v,y,x,w,T,D,I,z,F,U){sl(c,p,v,y,x),(I||z||U)&&(f.save(),I&&f.clip(I),z&&f.clip(z)),U?(D&dl)==dl?(f.clip(U),F&&f.clip(F),on(x,T),sn(c,w,p)):D&no?(on(x,T),f.clip(U),sn(c,w,p)):D&br&&(f.save(),f.clip(U),F&&f.clip(F),on(x,T),f.restore(),sn(c,w,p)):(on(x,T),sn(c,w,p)),(I||z||U)&&f.restore()}function sn(c,p,v){v>0&&(p instanceof Map?p.forEach((y,x)=>{f.strokeStyle=nn=x,f.stroke(y)}):p!=null&&c&&f.stroke(p))}function on(c,p){p instanceof Map?p.forEach((v,y)=>{f.fillStyle=Ja=y,f.fill(v)}):p!=null&&c&&f.fill(p)}function eu(c,p,v,y){let x=S[c],w;if(y<=0)w=[0,0];else{let T=x._space=x.space(n,c,p,v,y),D=x._incrs=x.incrs(n,c,p,v,y,T);w=sv(p,v,D,y,T)}return x._found=w}function os(c,p,v,y,x,w,T,D,I,z){let F=T%2/2;C==1&&f.translate(F,F),sl(D,T,I,z,D),f.beginPath();let U,X,ue,ie,ne=x+(y==0||y==3?-w:w);v==0?(X=x,ie=ne):(U=x,ue=ne);for(let Q=0;Q<c.length;Q++)p[Q]!=null&&(v==0?U=ue=c[Q]:X=ie=c[Q],f.moveTo(U,X),f.lineTo(ue,ie));f.stroke(),C==1&&f.translate(-F,-F)}function tu(c){let p=!0;return S.forEach((v,y)=>{if(!v.show)return;let x=k[v.scale];if(x.min==null){v._show&&(p=!1,v._show=!1,Za(!1));return}else v._show||(p=!1,v._show=!0,Za(!1));let w=v.side,T=w%2,{min:D,max:I}=x,[z,F]=eu(y,D,I,T==0?ee:j);if(F==0)return;let U=x.distr==2,X=v._splits=v.splits(n,y,D,I,z,F,U),ue=x.distr==2?X.map(J=>Rt[J]):X,ie=x.distr==2?Rt[X[1]]-Rt[X[0]]:z,ne=v._values=v.values(n,v.filter(n,ue,y,F,ie),y,F,ie);v._rotate=w==2?v.rotate(n,ne,y,F):0;let Q=v._size;v._size=$t(v.size(n,ne,y,c)),Q!=null&&v._size!=Q&&(p=!1)}),p}function au(c){let p=!0;return rl.forEach((v,y)=>{let x=v(n,y,wa,c);x!=oa[y]&&(p=!1),oa[y]=x}),p}function ru(){for(let c=0;c<S.length;c++){let p=S[c];if(!p.show||!p._show)continue;let v=p.side,y=v%2,x,w,T=p.stroke(n,c),D=v==0||v==3?-1:1,[I,z]=p._found;if(p.label!=null){let it=p.labelGap*D,bt=qe((p._lpos+it)*fe);ol(p.labelFont[0],T,"center",v==2?"top":Ei),f.save(),y==1?(x=w=0,f.translate(bt,qe(At+It/2)),f.rotate((v==3?-En:En)/2)):(x=qe(yt+pt/2),w=bt);let Aa=xc(p.label)?p.label(n,c,I,z):p.label;f.fillText(Aa,x,w),f.restore()}if(z==0)continue;let F=k[p.scale],U=y==0?pt:It,X=y==0?yt:At,ue=p._splits,ie=F.distr==2?ue.map(it=>Rt[it]):ue,ne=F.distr==2?Rt[ue[1]]-Rt[ue[0]]:I,Q=p.ticks,J=p.border,Ee=Q.show?Q.size:0,Re=qe(Ee*fe),et=qe((p.alignTo==2?p._size-Ee-p.gap:p.gap)*fe),_e=p._rotate*-En/180,Ne=A(p._pos*fe),gt=(Re+et)*D,lt=Ne+gt;w=y==0?lt:0,x=y==1?lt:0;let Mt=p.font[0],Nt=p.align==1?fr:p.align==2?Us:_e>0?fr:_e<0?Us:y==0?"center":v==3?Us:fr,Gt=_e||y==1?"middle":v==2?"top":Ei;ol(Mt,T,Nt,Gt);let xt=p.font[1]*p.lineGap,Et=ue.map(it=>A(i(it,F,U,X))),Ot=p._values;for(let it=0;it<Ot.length;it++){let bt=Ot[it];if(bt!=null){y==0?x=Et[it]:w=Et[it],bt=""+bt;let Aa=bt.indexOf(`
`)==-1?[bt]:bt.split(/\n/gm);for(let ct=0;ct<Aa.length;ct++){let El=Aa[ct];_e?(f.save(),f.translate(x,w+ct*xt),f.rotate(_e),f.fillText(El,0,0),f.restore()):f.fillText(El,x,w+ct*xt)}}}Q.show&&os(Et,Q.filter(n,ie,c,z,ne),y,v,Ne,Re,Se(Q.width*fe,3),Q.stroke(n,c),Q.dash,Q.cap);let qt=p.grid;qt.show&&os(Et,qt.filter(n,ie,c,z,ne),y,y==0?2:1,y==0?At:yt,y==0?It:pt,Se(qt.width*fe,3),qt.stroke(n,c),qt.dash,qt.cap),J.show&&os([Ne],[1],y==0?1:0,y==0?1:2,y==1?At:yt,y==1?It:pt,Se(J.width*fe,3),J.stroke(n,c),J.dash,J.cap)}Xe("drawAxes")}function Za(c){_.forEach((p,v)=>{v>0&&(p._paths=null,c&&(s==1?(p.min=null,p.max=null):p.facets.forEach(y=>{y.min=null,y.max=null})))})}let ln=!1,ls=!1,Mr=[];function nu(){ls=!1;for(let c=0;c<Mr.length;c++)Xe(...Mr[c]);Mr.length=0}function Qa(){ln||(Zp(ul),ln=!0)}function su(c,p=!1){ln=!0,ls=p,c(n),ul(),p&&Mr.length>0&&queueMicrotask(nu)}n.batch=su;function ul(){if(Yn&&(Jd(),Yn=!1),Va&&(jd(),Va=!1),tn){if(Le(b,fr,Ae),Le(b,"top",Ve),Le(b,Ur,ee),Le(b,Vr,j),Le(h,fr,Ae),Le(h,"top",Ve),Le(h,Ur,ee),Le(h,Vr,j),Le(m,Ur,ea),Le(m,Vr,ga),g.width=qe(ea*fe),g.height=qe(ga*fe),S.forEach(({_el:c,_show:p,_size:v,_pos:y,side:x})=>{if(c!=null)if(p){let w=x===3||x===0?v:0,T=x%2==1;Le(c,T?"left":"top",y-w),Le(c,T?"width":"height",v),Le(c,T?"top":"left",T?Ve:Ae),Le(c,T?"height":"width",T?j:ee),Xs(c,Ia)}else _t(c,Ia)}),nn=Ja=Zn=Xn=es=ts=as=rs=Qn=null,ft=1,Lr(!0),Ae!=Ua||Ve!=xa||ee!=Wt||j!=ba){Za(!1);let c=ee/Wt,p=j/ba;if(st&&!ha&&K.left>=0){K.left*=c,K.top*=p,Xa&&Jt(Xa,qe(K.left),0,ee,j),er&&Jt(er,0,qe(K.top),ee,j);for(let v=0;v<Tt.length;v++){let y=Tt[v];y!=null&&(Ya[v]*=c,Ka[v]*=p,Jt(y,$t(Ya[v]),$t(Ka[v]),ee,j))}}if(Me.show&&!an&&Me.left>=0&&Me.width>0){Me.left*=c,Me.width*=c,Me.top*=p,Me.height*=p;for(let v in fs)Le(rr,v,Me[v])}Ua=Ae,xa=Ve,Wt=ee,ba=j}Xe("setSize"),tn=!1}ea>0&&ga>0&&(f.clearRect(0,0,g.width,g.height),Xe("drawClear"),R.forEach(c=>c()),Xe("draw")),Me.show&&an&&(cn(Me),an=!1),st&&ha&&(Sa(null,!0,!1),ha=!1),te.show&&te.live&&Ct&&(us(),Ct=!1),u||(u=!0,n.status=1,Xe("ready")),Tr=!1,ln=!1}n.redraw=(c,p)=>{Va=p||!1,c!==!1?ia(L,$.min,$.max):Qa()};function is(c,p){let v=k[c];if(v.from==null){if(tt==0){let y=v.range(n,p.min,p.max,c);p.min=y[0],p.max=y[1]}if(p.min>p.max){let y=p.min;p.min=p.max,p.max=y}if(tt>1&&p.min!=null&&p.max!=null&&p.max-p.min<1e-16)return;c==L&&v.distr==2&&tt>0&&(p.min=zt(p.min,a[0]),p.max=zt(p.max,a[0]),p.min==p.max&&p.max++),Y[c]=p,Yn=!0,Qa()}}n.setScale=is;let cs,ds,Xa,er,pl,fl,tr,ar,vl,ml,Te,De,la=!1,at=K.drag,Ze=at.x,Qe=at.y;st&&(K.x&&(cs=Lt(_p,h)),K.y&&(ds=Lt(wp,h)),$.ori==0?(Xa=cs,er=ds):(Xa=ds,er=cs),Te=K.left,De=K.top);let Me=n.select=je({show:!0,over:!0,left:0,width:0,top:0,height:0},e.select),rr=Me.show?Lt(hp,Me.over?h:b):null;function cn(c,p){if(Me.show){for(let v in c)Me[v]=c[v],v in fs&&Le(rr,v,c[v]);p!==!1&&Xe("setSelect")}}n.setSelect=cn;function ou(c){if(_[c].show)Ue&&Xs(Ie[c],Ia);else if(Ue&&_t(Ie[c],Ia),st){let v=qa?Tt[0]:Tt[c];v!=null&&Jt(v,-10,-10,ee,j)}}function ia(c,p,v){is(c,{min:p,max:v})}function Ut(c,p,v,y){p.focus!=null&&uu(c),p.show!=null&&_.forEach((x,w)=>{w>0&&(c==w||c==null)&&(x.show=p.show,ou(w),s==2?(ia(x.facets[0].scale,null,null),ia(x.facets[1].scale,null,null)):ia(x.scale,null,null),Qa())}),v!==!1&&Xe("setSeries",c,p),y&&$r("setSeries",n,c,p)}n.setSeries=Ut;function lu(c,p){je(O[c],p)}function iu(c,p){c.fill=se(c.fill||null),c.dir=de(c.dir,-1),p=p??O.length,O.splice(p,0,c)}function cu(c){c==null?O.length=0:O.splice(c,1)}n.addBand=iu,n.setBand=lu,n.delBand=cu;function du(c,p){_[c].alpha=p,st&&Tt[c]!=null&&(Tt[c].style.opacity=p),Ue&&Ie[c]&&(Ie[c].style.opacity=p)}let ta,ca,ka,nr={focus:!0};function uu(c){if(c!=ka){let p=c==null,v=jt.alpha!=1;_.forEach((y,x)=>{if(s==1||x>0){let w=p||x==0||x==c;y._focus=p?null:w,v&&du(x,w?1:jt.alpha)}}),ka=c,v&&Qa()}}Ue&&Ga&&ot(Di,ye,c=>{K._lock||(_a(c),ka!=null&&Ut(null,nr,!0,Fe.setSeries))});function Vt(c,p,v){let y=k[p];v&&(c=c/fe-(y.ori==1?Ve:Ae));let x=ee;y.ori==1&&(x=j,c=x-c),y.dir==-1&&(c=x-c);let w=y._min,T=y._max,D=c/x,I=w+(T-w)*D,z=y.distr;return z==3?yr(10,I):z==4?zp(I,y.asinh):z==100?y.bwd(I):I}function pu(c,p){let v=Vt(c,L,p);return zt(v,a[0],Ke,Je)}n.valToIdx=c=>zt(c,a[0]),n.posToIdx=pu,n.posToVal=Vt,n.valToPos=(c,p,v)=>k[p].ori==0?o(c,k[p],v?pt:ee,v?yt:0):l(c,k[p],v?It:j,v?At:0),n.setCursor=(c,p,v)=>{Te=c.left,De=c.top,Sa(null,p,v)};function yl(c,p){Le(rr,fr,Me.left=c),Le(rr,Ur,Me.width=p)}function gl(c,p){Le(rr,"top",Me.top=c),Le(rr,Vr,Me.height=p)}let Er=$.ori==0?yl:gl,Pr=$.ori==1?yl:gl;function fu(){if(Ue&&te.live)for(let c=s==2?1:0;c<_.length;c++){if(c==0&&St)continue;let p=te.values[c],v=0;for(let y in p)Bt[c][v++].firstChild.nodeValue=p[y]}}function us(c,p){if(c!=null&&(c.idxs?c.idxs.forEach((v,y)=>{me[y]=v}):jp(c.idx)||me.fill(c.idx),te.idx=me[0]),Ue&&te.live){for(let v=0;v<_.length;v++)(v>0||s==1&&!St)&&vu(v,me[v]);fu()}Ct=!1,p!==!1&&Xe("setLegend")}n.setLegend=us;function vu(c,p){let v=_[c],y=c==0&&q==2?Rt:a[c],x;St?x=v.values(n,c,p)??sa:(x=v.value(n,p==null?null:y[p],c,p),x=x==null?sa:{_:x}),te.values[c]=x}function Sa(c,p,v){vl=Te,ml=De,[Te,De]=K.move(n,Te,De),K.left=Te,K.top=De,st&&(Xa&&Jt(Xa,qe(Te),0,ee,j),er&&Jt(er,0,qe(De),ee,j));let y,x=Ke>Je;ta=ke,ca=null;let w=$.ori==0?ee:j,T=$.ori==1?ee:j;if(Te<0||tt==0||x){y=K.idx=null;for(let D=0;D<_.length;D++){let I=Tt[D];I!=null&&Jt(I,-10,-10,ee,j)}Ga&&Ut(null,nr,!0,c==null&&Fe.setSeries),te.live&&(me.fill(y),Ct=!0)}else{let D,I,z;s==1&&(D=$.ori==0?Te:De,I=Vt(D,L),y=K.idx=zt(I,a[0],Ke,Je),z=G(a[0][y],$,w,0));let F=-10,U=-10,X=0,ue=0,ie=!0,ne="",Q="";for(let J=s==2?1:0;J<_.length;J++){let Ee=_[J],Re=me[J],et=Re==null?null:s==1?a[J][Re]:a[J][1][Re],_e=K.dataIdx(n,J,y,I),Ne=_e==null?null:s==1?a[J][_e]:a[J][1][_e];if(Ct=Ct||Ne!=et||_e!=Re,me[J]=_e,J>0&&Ee.show){let gt=_e==null?-10:_e==y?z:G(s==1?a[0][_e]:a[J][0][_e],$,w,0),lt=Ne==null?-10:Z(Ne,s==1?k[Ee.scale]:k[Ee.facets[1].scale],T,0);if(Ga&&Ne!=null){let Mt=$.ori==1?Te:De,Nt=Ye(jt.dist(n,J,_e,lt,Mt));if(Nt<ta){let Gt=jt.bias;if(Gt!=0){let xt=Vt(Mt,Ee.scale),Et=Ne>=0?1:-1,Ot=xt>=0?1:-1;Ot==Et&&(Ot==1?Gt==1?Ne>=xt:Ne<=xt:Gt==1?Ne<=xt:Ne>=xt)&&(ta=Nt,ca=J)}else ta=Nt,ca=J}}if(Ct||qa){let Mt,Nt;$.ori==0?(Mt=gt,Nt=lt):(Mt=lt,Nt=gt);let Gt,xt,Et,Ot,qt,it,bt=!0,Aa=nt.bbox;if(Aa!=null){bt=!1;let ct=Aa(n,J);Et=ct.left,Ot=ct.top,Gt=ct.width,xt=ct.height}else Et=Mt,Ot=Nt,Gt=xt=nt.size(n,J);if(it=nt.fill(n,J),qt=nt.stroke(n,J),qa)J==ca&&ta<=jt.prox&&(F=Et,U=Ot,X=Gt,ue=xt,ie=bt,ne=it,Q=qt);else{let ct=Tt[J];ct!=null&&(Ya[J]=Et,Ka[J]=Ot,Fi(ct,Gt,xt,bt),Hi(ct,it,qt),Jt(ct,$t(Et),$t(Ot),ee,j))}}}}if(qa){let J=jt.prox,Ee=ka==null?ta<=J:ta>J||ca!=ka;if(Ct||Ee){let Re=Tt[0];Re!=null&&(Ya[0]=F,Ka[0]=U,Fi(Re,X,ue,ie),Hi(Re,ne,Q),Jt(Re,$t(F),$t(U),ee,j))}}}if(Me.show&&la)if(c!=null){let[D,I]=Fe.scales,[z,F]=Fe.match,[U,X]=c.cursor.sync.scales,ue=c.cursor.drag;if(Ze=ue._x,Qe=ue._y,Ze||Qe){let{left:ie,top:ne,width:Q,height:J}=c.select,Ee=c.scales[U].ori,Re=c.posToVal,et,_e,Ne,gt,lt,Mt=D!=null&&z(D,U),Nt=I!=null&&F(I,X);Mt&&Ze?(Ee==0?(et=ie,_e=Q):(et=ne,_e=J),Ne=k[D],gt=G(Re(et,U),Ne,w,0),lt=G(Re(et+_e,U),Ne,w,0),Er(Ft(gt,lt),Ye(lt-gt))):Er(0,w),Nt&&Qe?(Ee==1?(et=ie,_e=Q):(et=ne,_e=J),Ne=k[I],gt=Z(Re(et,X),Ne,T,0),lt=Z(Re(et+_e,X),Ne,T,0),Pr(Ft(gt,lt),Ye(lt-gt))):Pr(0,T)}else vs()}else{let D=Ye(vl-pl),I=Ye(ml-fl);if($.ori==1){let X=D;D=I,I=X}Ze=at.x&&D>=at.dist,Qe=at.y&&I>=at.dist;let z=at.uni;z!=null?Ze&&Qe&&(Ze=D>=z,Qe=I>=z,!Ze&&!Qe&&(I>D?Qe=!0:Ze=!0)):at.x&&at.y&&(Ze||Qe)&&(Ze=Qe=!0);let F,U;Ze&&($.ori==0?(F=tr,U=Te):(F=ar,U=De),Er(Ft(F,U),Ye(U-F)),Qe||Pr(0,T)),Qe&&($.ori==1?(F=tr,U=Te):(F=ar,U=De),Pr(Ft(F,U),Ye(U-F)),Ze||Er(0,w)),!Ze&&!Qe&&(Er(0,0),Pr(0,0))}if(at._x=Ze,at._y=Qe,c==null){if(v){if(Ml!=null){let[D,I]=Fe.scales;Fe.values[0]=D!=null?Vt($.ori==0?Te:De,D):null,Fe.values[1]=I!=null?Vt($.ori==1?Te:De,I):null}$r(Vs,n,Te,De,ee,j,y)}if(Ga){let D=v&&Fe.setSeries,I=jt.prox;ka==null?ta<=I&&Ut(ca,nr,!0,D):ta>I?Ut(null,nr,!0,D):ca!=ka&&Ut(ca,nr,!0,D)}}Ct&&(te.idx=y,us()),p!==!1&&Xe("setCursor")}let da=null;Object.defineProperty(n,"rect",{get(){return da==null&&Lr(!1),da}});function Lr(c=!1){c?da=null:(da=h.getBoundingClientRect(),Xe("syncRect",da))}function xl(c,p,v,y,x,w,T){K._lock||la&&c!=null&&c.movementX==0&&c.movementY==0||(ps(c,p,v,y,x,w,T,!1,c!=null),c!=null?Sa(null,!0,!0):Sa(p,!0,!1))}function ps(c,p,v,y,x,w,T,D,I){if(da==null&&Lr(!1),_a(c),c!=null)v=c.clientX-da.left,y=c.clientY-da.top;else{if(v<0||y<0){Te=-10,De=-10;return}let[z,F]=Fe.scales,U=p.cursor.sync,[X,ue]=U.values,[ie,ne]=U.scales,[Q,J]=Fe.match,Ee=p.axes[0].side%2==1,Re=$.ori==0?ee:j,et=$.ori==1?ee:j,_e=Ee?w:x,Ne=Ee?x:w,gt=Ee?y:v,lt=Ee?v:y;if(ie!=null?v=Q(z,ie)?i(X,k[z],Re,0):-10:v=Re*(gt/_e),ne!=null?y=J(F,ne)?i(ue,k[F],et,0):-10:y=et*(lt/Ne),$.ori==1){let Mt=v;v=y,y=Mt}}I&&(p==null||p.cursor.event.type==Vs)&&((v<=1||v>=ee-1)&&(v=$a(v,ee)),(y<=1||y>=j-1)&&(y=$a(y,j))),D?(pl=v,fl=y,[tr,ar]=K.move(n,v,y)):(Te=v,De=y)}let fs={width:0,height:0,left:0,top:0};function vs(){cn(fs,!1)}let bl,hl,_l,wl;function kl(c,p,v,y,x,w,T){la=!0,Ze=Qe=at._x=at._y=!1,ps(c,p,v,y,x,w,T,!0,!1),c!=null&&(ot(Gs,Zs,Sl,!1),$r(Li,n,tr,ar,ee,j,null));let{left:D,top:I,width:z,height:F}=Me;bl=D,hl=I,_l=z,wl=F}function Sl(c,p,v,y,x,w,T){la=at._x=at._y=!1,ps(c,p,v,y,x,w,T,!1,!0);let{left:D,top:I,width:z,height:F}=Me,U=z>0||F>0,X=bl!=D||hl!=I||_l!=z||wl!=F;if(U&&X&&cn(Me),at.setScale&&U&&X){let ue=D,ie=z,ne=I,Q=F;if($.ori==1&&(ue=I,ie=F,ne=D,Q=z),Ze&&ia(L,Vt(ue,L),Vt(ue+ie,L)),Qe)for(let J in k){let Ee=k[J];J!=L&&Ee.from==null&&Ee.min!=ke&&ia(J,Vt(ne+Q,J),Vt(ne,J))}vs()}else K.lock&&(K._lock=!K._lock,Sa(p,!0,c!=null));c!=null&&(ja(Gs,Zs),$r(Gs,n,Te,De,ee,j,null))}function mu(c,p,v,y,x,w,T){if(K._lock)return;_a(c);let D=la;if(la){let I=!0,z=!0,F=10,U,X;$.ori==0?(U=Ze,X=Qe):(U=Qe,X=Ze),U&&X&&(I=Te<=F||Te>=ee-F,z=De<=F||De>=j-F),U&&I&&(Te=Te<tr?0:ee),X&&z&&(De=De<ar?0:j),Sa(null,!0,!0),la=!1}Te=-10,De=-10,me.fill(null),Sa(null,!0,!0),D&&(la=D)}function Al(c,p,v,y,x,w,T){K._lock||(_a(c),Jn(),vs(),c!=null&&$r(Ii,n,Te,De,ee,j,null))}function Cl(){S.forEach(ov),Kn(n.width,n.height,!0)}Ra(Pn,mr,Cl);let sr={};sr.mousedown=kl,sr.mousemove=xl,sr.mouseup=Sl,sr.dblclick=Al,sr.setSeries=(c,p,v,y)=>{let x=Fe.match[2];v=x(n,p,v),v!=-1&&Ut(v,y,!0,!1)},st&&(ot(Li,h,kl),ot(Vs,h,xl),ot($i,h,c=>{_a(c),Lr(!1)}),ot(Di,h,mu),ot(Ii,h,Al),so.add(n),n.syncRect=Lr);let dn=n.hooks=e.hooks||{};function Xe(c,p,v){ls?Mr.push([c,p,v]):c in dn&&dn[c].forEach(y=>{y.call(null,n,p,v)})}(e.plugins||[]).forEach(c=>{for(let p in c.hooks)dn[p]=(dn[p]||[]).concat(c.hooks[p])});let Tl=(c,p,v)=>v,Fe=je({key:null,setSeries:!1,filters:{pub:Vi,sub:Vi},scales:[L,_[1]?_[1].scale:null],match:[Gi,Gi,Tl],values:[null,null]},K.sync);Fe.match.length==2&&Fe.match.push(Tl),K.sync=Fe;let Ml=Fe.key,ms=Wc(Ml);function $r(c,p,v,y,x,w,T){Fe.filters.pub(c,p,v,y,x,w,T)&&ms.pub(c,p,v,y,x,w,T)}ms.sub(n);function yu(c,p,v,y,x,w,T){Fe.filters.sub(c,p,v,y,x,w,T)&&sr[c](null,p,v,y,x,w,T)}n.pub=yu;function gu(){ms.unsub(n),so.delete(n),ya.clear(),eo(Pn,mr,Cl),d.remove(),ye?.remove(),Xe("destroy")}n.destroy=gu;function ys(){Xe("init",e,a),nl(a||e.data,!1),Y[L]?is(L,Y[L]):Jn(),an=Me.show&&(Me.width>0||Me.height>0),ha=Ct=!0,Kn(e.width,e.height)}return _.forEach(al),S.forEach(Kd),r?r instanceof HTMLElement?(r.appendChild(d),ys()):r(n,ys):ys(),n}rt.assign=je;rt.fmtNum=fo;rt.rangeNum=Ln;rt.rangeLog=In;rt.rangeAsinh=uo;rt.orient=Oa;rt.pxRatio=fe;rt.join=Jp;rt.fmtDate=mo,rt.tzDate=lf;rt.sync=Wc;{rt.addGap=Uf,rt.clipGaps=On;let e=rt.paths={points:Yc};e.linear=Jc,e.stepped=qf,e.bars=Yf,e.spline=Jf}function Ha({data:e,series:a,height:r,className:n,compact:s=!1}){r===void 0&&(r=s?32:120);let o=Pt(null),l=Pt(null);return le(()=>{if(!o.current||!e||e.length===0)return;let i=getComputedStyle(document.documentElement),u=i.getPropertyValue("--text-tertiary").trim(),d=i.getPropertyValue("--border-subtle").trim(),g=i.getPropertyValue("--font-mono").trim()||"monospace";function f(b){return b.startsWith("var(")?i.getPropertyValue(b.slice(4,-1)).trim():b}let m={width:o.current.clientWidth,height:r,cursor:s?{show:!1}:{show:!0,drag:{x:!1,y:!1}},legend:{show:!1},padding:s?[0,0,0,0]:void 0,axes:s?[{show:!1},{show:!1}]:[{stroke:u,grid:{stroke:d,width:1},font:`10px ${g}`,ticks:{stroke:d,width:1}},{stroke:u,grid:{stroke:d,width:1},font:`10px ${g}`,ticks:{stroke:d,width:1},size:50}],series:[{},...a.map(b=>{let h=f(b.color);return{label:b.label,stroke:h,width:b.width||2,fill:s?void 0:h+"15"}})]};return l.current&&l.current.destroy(),l.current=new rt(m,e,o.current),()=>{l.current&&(l.current.destroy(),l.current=null)}},[e,a,r,s]),le(()=>{if(!o.current)return;let i=new ResizeObserver(()=>{l.current&&o.current&&l.current.setSize({width:o.current.clientWidth,height:r})});return i.observe(o.current),()=>i.disconnect()},[r]),s?t("div",{ref:o,class:n||"",role:"img","aria-label":e&&e.length>1?`Sparkline: ${a.map(i=>i.label).join(", ")}`:"Sparkline loading"}):t("figure",null,t("div",{ref:o,class:n||"",role:"img","aria-label":e&&e.length>1?`Chart: ${a.map(i=>i.label).join(", ")}`:"Chart loading"}),e&&e.length>1&&t("figcaption",{class:"sr-only"},a.map(i=>i.label).join(", ")," \u2014 ",e[0].length," data points"))}function ze({value:e,label:a,unit:r,delta:n,warning:s,loading:o,sparkData:l,sparkColor:i}){return t("div",{class:`t-frame ${o?"cursor-working":"cursor-active"}`,"data-label":a,style:s?"border-left: 3px solid var(--status-warning);":""},t("div",{class:"flex items-baseline gap-2",style:"justify-content: space-between;"},t("div",{class:"flex items-baseline gap-2"},t("span",{class:"data-mono",style:`font-size: var(--type-hero); font-weight: 600; color: ${s?"var(--status-warning)":"var(--accent)"}; line-height: 1;`},e??"\u2014"),r&&t("span",{class:"data-mono",style:"font-size: var(--type-headline); color: var(--text-tertiary);"},r)),l&&l.length>1&&l[0].length>1&&t("div",{style:"width: 80px; height: 32px; flex-shrink: 0;"},t(Ha,{data:l,series:[{label:a||"trend",color:i||"var(--accent)",width:1.5}],compact:!0}))),n&&t("div",{style:"font-size: var(--type-label); color: var(--text-secondary); margin-top: 8px; font-family: var(--font-mono);"},n))}var lv={A:["01110","11011","11111","11011","11011"],B:["11110","11011","11110","11011","11110"],C:["0111","1100","1100","1100","0111"],D:["11110","11011","11011","11011","11110"],E:["1111","1100","1110","1100","1111"],F:["1111","1100","1110","1100","1100"],G:["01110","11000","11011","11011","01110"],H:["11011","11011","11111","11011","11011"],I:["1","1","1","1","1"],J:["0111","0011","0011","1011","0110"],K:["11001","11010","11100","11010","11001"],L:["1100","1100","1100","1100","1111"],M:["10001","11011","10101","10001","10001"],N:["10001","11001","10101","10011","10001"],O:["01110","11011","11011","11011","01110"],P:["11110","11011","11110","11000","11000"],Q:["01110","11011","11011","11010","01101"],R:["11111","11011","11110","11010","11001"],S:["0111","1100","0110","0011","1110"],T:["11111","00100","00100","00100","00100"],U:["11011","11011","11011","11011","01110"],V:["10001","10001","01010","01010","00100"],W:["10001","10001","10101","10101","01010"],X:["10001","01010","00100","01010","10001"],Y:["10001","01010","00100","00100","00100"],Z:["11111","00010","00100","01000","11111"]},iv=["000","010","111","010","000"],Zt=10,za=2,kr=Zt-za,wo=1,ed=2,td=3;function ad(e){let a=0,r=[];for(let n=0;n<e.length;n++){let s=e[n],o=lv[s];if(!o)continue;let l=o[0].length;for(let i=0;i<5;i++)for(let u=0;u<l;u++)o[i][u]==="1"&&r.push([a+u,i]);a+=l+ed}return{pixels:r,endX:a>0?a-ed:0}}function cv(e){let a=[];for(let r=0;r<5;r++)for(let n=0;n<3;n++)iv[r][n]==="1"&&a.push([e+n,r]);return{pixels:a,endX:e+3}}function ve({page:e,subtitle:a}){let r=Oe(()=>{let n=ad("ARIA"),s=n.endX+td,o=cv(s),l=o.endX+td,i=ad(e),u=i.pixels.map(([g,f])=>[g+l,f]),d=(l+i.endX)*Zt+Zt;return{ariaPixels:n.pixels,sepPixels:o.pixels,pagePixels:u,totalWidth:d}},[e]);return t("div",{style:"margin-bottom: 1.5rem"},t("svg",{viewBox:`0 0 ${r.totalWidth} ${5*Zt}`,style:"height: 2rem; max-width: 100%; width: auto; display: block;",role:"img","aria-label":`ARIA ${e}`},r.ariaPixels.map(([n,s],o)=>t("rect",{key:`a${o}`,x:n*Zt+za/2,y:s*Zt+za/2,width:kr,height:kr,rx:wo,fill:"var(--accent)"})),r.sepPixels.map(([n,s],o)=>t("rect",{key:`s${o}`,x:n*Zt+za/2,y:s*Zt+za/2,width:kr,height:kr,rx:wo,fill:"var(--text-tertiary)"})),r.pagePixels.map(([n,s],o)=>t("rect",{key:`p${o}`,x:n*Zt+za/2,y:s*Zt+za/2,width:kr,height:kr,rx:wo,fill:"var(--text-primary)"}))),a&&t("p",{style:"margin-top: 0.5rem; font-size: var(--type-label); color: var(--text-secondary)"},a))}var ko=["collecting","baselines","ml-training","ml-active"],dv=["Collecting","Baselines","ML Training","ML Active"],rd=["Gathering daily snapshots","Statistical baselines active","Training ML models","Full intelligence active"],uv={data:{label:"DATA PLANE",nodes:[{id:"discovery",label:"Discovery",metricKey:"entity_count"},{id:"activity_monitor",label:"Activity",metricKey:"event_rate"},{id:"data_quality",label:"Curation",metricKey:"included_count"},{id:"activity_labeler",label:"Labeler",metricKey:"current_activity"}]},learning:{label:"LEARNING PLANE",nodes:[{id:"intelligence",label:"Intel.",metricKey:"day_count"},{id:"ml_engine",label:"ML Engine",metricKey:"mean_r2"},{id:"pattern_recognition",label:"Patterns",metricKey:"sequence_count"},{id:"drift_monitor",label:"Drift",metricKey:"drift_count"}]},action:{label:"ACTION PLANE",nodes:[{id:"shadow_engine",label:"Shadow",metricKey:"accuracy"},{id:"orchestrator",label:"Orchestr.",metricKey:"pending_count"},{id:"pipeline_gates",label:"Gates",metricKey:"pipeline_stage"},{id:"feedback_health",label:"Feedback",metricKey:"feedback_fresh"}]}};function pv(e,a){let r=e?.[a];return r==="running"?"healthy":r==="failed"?"blocked":"waiting"}function fv(e,a){let r=e?.capabilities?.data||{},n=e?.pipeline?.data||{},s=e?.shadow_accuracy?.data||{},o=e?.activity_labels?.data||{},l=e?.feedback_health||{};switch(a.id){case"discovery":{let i=Object.values(r).filter(u=>u&&typeof u=="object"&&u.entities).reduce((u,d)=>u+(d.entities?.length||0),0);return i?`${i} entities`:"\u2014"}case"activity_monitor":return n?.events_per_minute?`${n.events_per_minute.toFixed(1)} ev/m`:"\u2014";case"data_quality":return n?.included_entities?`${n.included_entities} incl.`:"\u2014";case"activity_labeler":return o?.current_activity?.predicted||"\u2014";case"intelligence":return n?.intelligence_day?`Day ${n.intelligence_day}`:"\u2014";case"ml_engine":{let i=Object.values(r).filter(d=>d?.ml_accuracy);return i.length===0?"\u2014":`R\xB2: ${(i.reduce((d,g)=>d+(g.ml_accuracy.mean_r2||0),0)/i.length).toFixed(2)}`}case"pattern_recognition":return"\u2014";case"drift_monitor":return`${Object.values(r).filter(u=>u?.drift_flagged).length} flagged`;case"shadow_engine":return s?.overall_accuracy?`${(s.overall_accuracy*100).toFixed(0)}%`:"\u2014";case"orchestrator":return"\u2014";case"pipeline_gates":return n?.stage||"shadow";case"feedback_health":return`${(l?.capabilities_with_ml_feedback||0)+(l?.capabilities_with_shadow_feedback||0)} fresh`;default:return"\u2014"}}function vv({x:e,y:a,status:r,label:n,metric:s,glowing:o,animateMetric:l}){let i={healthy:"var(--status-healthy)",waiting:"var(--status-waiting)",blocked:"var(--status-error)",review:"var(--status-warning)"},u=i[r]||i.waiting;return t("g",{transform:`translate(${e}, ${a})`},t("rect",{width:"180",height:"55",rx:"4",fill:"var(--bg-surface)",stroke:o?"var(--accent)":"var(--border-primary)","stroke-width":o?"2":"1"}),o&&t("rect",{width:"180",height:"55",rx:"4",fill:"none",stroke:"var(--accent)","stroke-width":"1",opacity:"0.3"},t("animate",{attributeName:"opacity",values:"0.3;0.1;0.3",dur:"2s",repeatCount:"1"})),t("circle",{cx:"16",cy:"16",r:"5",fill:u,filter:"url(#led-glow)"},(r==="healthy"||o)&&t("animate",{attributeName:"opacity",values:"1;0.6;1",dur:o?"1s":"3s",repeatCount:"indefinite"})),t("text",{x:"28",y:"20",fill:"var(--text-primary)","font-size":"11","font-weight":"600","font-family":"var(--font-mono)"},n),t("text",{x:"16",y:"42",fill:"var(--text-tertiary)","font-size":"10","font-family":"var(--font-mono)",class:l?"t2-typewriter":""},s))}function mv({x:e,y:a,label:r}){return t("text",{x:e,y:a,"text-anchor":"middle",fill:"var(--text-tertiary)","font-size":"10","font-weight":"700","font-family":"var(--font-mono)","letter-spacing":"2"},r)}function Bn({x:e,y1:a,y2:r,label:n,stale:s,flashing:o}){return t("g",{class:o?" animate-data-refresh":""},t("line",{x1:e,y1:a,x2:e,y2:r,class:s?"":"bus-connector-line",stroke:s?"var(--status-error)":"var(--border-primary)","stroke-width":"1","stroke-dasharray":s?"2 4":void 0}),s&&t("g",{transform:`translate(${e-4}, ${(a+r)/2-6})`},t("circle",{cx:"4",cy:"4",r:"6",fill:"var(--status-error)",opacity:"0.2"}),t("text",{x:"4",y:"7","text-anchor":"middle",fill:"var(--status-error)","font-size":"9","font-weight":"bold","font-family":"var(--font-mono)"},"!")),n&&t("text",{x:e+4,y:(a+r)/2,fill:s?"var(--status-error)":"var(--text-tertiary)","font-size":"8","font-family":"var(--font-mono)"},n))}var nd={capabilities:{section:"data",index:0},entities:{section:"data",index:0},activity_summary:{section:"data",index:1},entity_curation:{section:"data",index:2},activity_labels:{section:"data",index:3},ml_accuracy:{section:"learning",index:1},shadow_accuracy:{section:"learning",index:1}},yv=2880*60*1e3;function So(e){if(!e)return!0;let a=typeof e=="string"?new Date(e).getTime():e;return isNaN(a)?!0:Date.now()-a>yv}function gv(e){if(!e)return 1.5;let r=[e.capabilities_with_ml_feedback,e.capabilities_with_shadow_feedback,e.total_feedback_entries,e.feedback_sources_active,e.capabilities_with_drift_feedback].filter(n=>n&&n>0).length;return r>=5?3:r>=3?2.5:r>=1?2:1.5}function xv({moduleStatuses:e,cacheData:a,feedbackHealth:r}){let n=[50,260,470,680],s=["entities","events","rules","labels"],o=["","accuracy","",""],[l,i]=N({}),u=Pt({});le(()=>{let L=Object.keys(nd),H={};L.forEach(W=>{let B=Pa(W);H[W]=B.value.lastFetched||0});let R=setInterval(()=>{L.forEach(W=>{let $=Pa(W).value.lastFetched||0;if($>H[W]&&H[W]>0){let q=nd[W],G=`${q.section}-${q.index}`;i(Z=>({...Z,[G]:!0})),clearTimeout(u.current[G]),u.current[G]=setTimeout(()=>{i(Z=>({...Z,[G]:!1}))},300)}H[W]=$})},200);return()=>{clearInterval(R),Object.values(u.current).forEach(clearTimeout)}},[]);let d=Pt(null),[g,f]=N(!1),[m,b]=N(!1),h=Pt(null),C=a?.activity_labels?.data?.current_activity?.predicted||null;le(()=>(d.current!==null&&C!==d.current&&C!==null&&(f(!0),b(!0),clearTimeout(h.current),h.current=setTimeout(()=>{f(!1),b(!1)},2e3)),d.current=C,()=>clearTimeout(h.current)),[C]);let A=r||{},M=[!1,So(A.last_ml_feedback_at),!1,!1],_=[So(A.last_shadow_feedback_at),!1,!1,So(A.last_feedback_at)],S=gv(r);function k(L,H){let R=uv[L];return t("g",{transform:`translate(0, ${H})`},t(mv,{x:450,y:15,label:R.label}),R.nodes.map((W,B)=>{let $=W.id==="activity_labeler";return t(vv,{key:W.id,x:n[B],y:25,status:pv(e,W.id),label:W.label,metric:fv(a,W),glowing:$&&g,animateMetric:$&&m})}))}let O="M350,230 L350,272 L140,272 L140,122 L870,122 L870,175";return t("section",{class:"t-terminal-bg rounded-lg p-4 overflow-x-auto"},t("svg",{viewBox:"0 0 900 530",class:"w-full",style:"min-width: 700px; max-width: 100%;"},t("defs",null,t("pattern",{id:"bus-flow",width:"20",height:"4",patternUnits:"userSpaceOnUse"},t("rect",{width:"10",height:"4",fill:"var(--accent)",opacity:"0.5"},t("animate",{attributeName:"x",from:"-20",to:"20",dur:"1.5s",repeatCount:"indefinite"}))),t("pattern",{id:"feedback-flow",width:"20",height:"4",patternUnits:"userSpaceOnUse"},t("rect",{width:"10",height:"4",fill:"var(--status-healthy)",opacity:"0.5"},t("animate",{attributeName:"x",from:"20",to:"-20",dur:"2s",repeatCount:"indefinite"}))),t("filter",{id:"led-glow"},t("feGaussianBlur",{stdDeviation:"2",result:"blur"}),t("feMerge",null,t("feMergeNode",{in:"blur"}),t("feMergeNode",{in:"SourceGraphic"}))),t("filter",{id:"tracer-glow"},t("feGaussianBlur",{stdDeviation:"4",result:"blur"}),t("feMerge",null,t("feMergeNode",{in:"blur"}),t("feMergeNode",{in:"SourceGraphic"})))),k("data",0),n.map((L,H)=>t(Bn,{key:`dc${H}`,x:L+90,y1:80,y2:110,label:s[H],flashing:l[`data-${H}`]})),t("g",{transform:"translate(0, 110)"},t("rect",{x:"30",y:"0",width:"840",height:"24",rx:"4",fill:"url(#bus-flow)"}),t("rect",{x:"30",y:"0",width:"840",height:"24",rx:"4",fill:"none",stroke:"var(--accent)","stroke-width":S,opacity:"0.4",style:"transition: stroke-width 0.5s ease;"}),t("text",{x:"450",y:"16","text-anchor":"middle",fill:"var(--accent)","font-size":"9","font-family":"var(--font-mono)"},"CAPABILITIES BUS  [entities] [activity] [curation] [labels] [usefulness]"),t("circle",{r:"3",fill:"var(--accent)"},t("animateMotion",{dur:"3s",repeatCount:"indefinite",path:"M30,12 L870,12"}))),n.map((L,H)=>t(Bn,{key:`cl${H}`,x:L+90,y1:134,y2:160})),k("learning",150),n.map((L,H)=>t(Bn,{key:`lf${H}`,x:L+90,y1:230,y2:260,label:o[H],stale:M[H],flashing:l[`learning-${H}`]})),t("g",{transform:"translate(0, 260)"},t("rect",{x:"30",y:"0",width:"840",height:"24",rx:"4",fill:"url(#feedback-flow)"}),t("rect",{x:"30",y:"0",width:"840",height:"24",rx:"4",fill:"none",stroke:"var(--status-healthy)","stroke-width":S,opacity:"0.4",style:"transition: stroke-width 0.5s ease;"}),t("text",{x:"450",y:"16","text-anchor":"middle",fill:"var(--status-healthy)","font-size":"9","font-family":"var(--font-mono)"},"FEEDBACK BUS  [accuracy] [hit_rate] [suggestions] [drift] [corrections]"),t("circle",{r:"3",fill:"var(--status-healthy)"},t("animateMotion",{dur:"4s",repeatCount:"indefinite",path:"M870,12 L30,12"}))),n.map((L,H)=>t(Bn,{key:`fa${H}`,x:L+90,y1:284,y2:310,stale:_[H]})),k("action",300),t("g",{transform:"translate(310, 390)"},t("rect",{x:"0",y:"0",width:"280",height:"35",rx:"4",fill:"var(--bg-inset)",stroke:"var(--accent)","stroke-width":"2"}),t("text",{x:"140",y:"22","text-anchor":"middle",fill:"var(--accent)","font-size":"12","font-weight":"bold","font-family":"var(--font-mono)"},"YOU:  Label \xB7 Curate \xB7 Review \xB7 Advance")),t("circle",{r:"4",fill:"var(--status-healthy)",opacity:"0.9",filter:"url(#tracer-glow)"},t("animateMotion",{dur:"10s",repeatCount:"indefinite",path:O}),t("animate",{attributeName:"r",values:"4;6;4",dur:"10s",repeatCount:"indefinite"})),t("circle",{r:"7",fill:"var(--status-healthy)",opacity:"0.25",filter:"url(#tracer-glow)"},t("animateMotion",{dur:"10s",repeatCount:"indefinite",path:O,begin:"0.5s"}),t("animate",{attributeName:"r",values:"7;10;7",dur:"10s",repeatCount:"indefinite",begin:"0.5s"}))))}function bv({maturity:e,shadowStage:a}){let r=e&&e.phase||"collecting",n=ko.indexOf(r);return t("section",{class:"t-frame","data-label":"system maturity"},t("div",{class:"flex items-center gap-1 mb-2"},ko.map((s,o)=>{let l="var(--bg-inset)";return o<n?l="var(--status-healthy)":o===n&&(l="var(--accent)"),t("div",{key:s,class:"h-2 flex-1",style:`border-radius: var(--radius); background: ${l};`})})),t("div",{class:"flex justify-between text-xs"},ko.map((s,o)=>{let l="var(--text-tertiary)",i="normal";return o<n?l="var(--status-healthy)":o===n&&(l="var(--accent)",i="500"),t("span",{key:s,style:`color: ${l}; font-weight: ${i};`},dv[o])})),t("p",{class:"text-xs mt-2",style:"color: var(--text-tertiary)"},n>=0&&n<rd.length?rd[n]:"",a?` \u2014 Pipeline: ${a}`:""))}function hv({activity:e,intraday:a}){let r=e&&e.data&&e.data.data||null,n=r&&r.websocket||null,s=r&&r.activity_rate||null,o=s?s.current:null,l=r&&r.occupancy||null,i=Array.isArray(a)&&a.length>0?a[a.length-1]:null,u=i?i.lights_on??null:null,d=i?i.power_watts??null:null;return t("section",{class:"t-frame","data-label":"live metrics"},t("div",{class:"flex flex-wrap items-center gap-x-5 gap-y-2 text-sm"},t("div",{class:"flex items-center gap-1.5"},t("span",{style:"color: var(--text-tertiary)"},"Occupancy"),t("span",{class:"font-medium",style:"color: var(--text-primary)"},l&&l.anyone_home?"Home":l?"Away":"\u2014")),t("div",{class:"flex items-center gap-1.5"},t("span",{style:"color: var(--text-tertiary)"},"Events"),t("span",{class:"data-mono font-medium",style:"color: var(--text-primary)"},o!=null?`${o}/min`:"\u2014")),t("div",{class:"flex items-center gap-1.5"},t("span",{style:"color: var(--text-tertiary)"},"Lights"),t("span",{class:"data-mono font-medium",style:"color: var(--text-primary)"},u!=null?`${u} on`:"\u2014")),t("div",{class:"flex items-center gap-1.5"},t("span",{style:"color: var(--text-tertiary)"},"Power"),t("span",{class:"data-mono font-medium",style:"color: var(--text-primary)"},d!=null?`${Math.round(d)} W`:"\u2014")),t("div",{class:"flex items-center gap-1.5"},t("span",{class:"w-2 h-2 rounded-full",style:`background: ${n&&n.connected?"var(--status-healthy)":"var(--status-error)"};`}),t("span",{style:"color: var(--text-tertiary)"},"WebSocket"),t("span",{class:"font-medium",style:"color: var(--text-primary)"},n&&n.connected?"Connected":n===null?"\u2014":"Disconnected"))))}function Ao(){let e=We("intelligence"),a=We("activity_summary"),r=We("entities"),[n,s]=N(null),[o,l]=N(null),[i,u]=N(null),[d,g]=N(null),[f,m]=N(null),[b,h]=N(null);le(()=>{Promise.all([ce("/health").catch(()=>null),ce("/api/shadow/accuracy").catch(()=>null),ce("/api/pipeline").catch(()=>null),ce("/api/curation/summary").catch(()=>null),ce("/api/capabilities/feedback/health").catch(()=>null),ce("/api/activity/current").catch(()=>null)]).then(([O,L,H,R,W,B])=>{s(O),l(L),u(H),g(R),m(W)}).catch(O=>h(O.message||String(O)))},[]);let C=e.loading||a.loading||r.loading,A=e.error||a.error||r.error,M=pe(()=>!e.data||!e.data.data?null:e.data.data.data_maturity||null,[e.data]),_=pe(()=>!e.data||!e.data.data?null:e.data.data.intraday_trend||null,[e.data]),S=pe(()=>i&&i.current_stage||null,[i]),k=pe(()=>({capabilities:r.data,pipeline:{data:i},shadow_accuracy:{data:o},activity_labels:a.data,feedback_health:f}),[r.data,i,o,a.data,f]);return C&&!e.data?t("div",{class:"space-y-6"},t("div",{class:"t-frame","data-label":"aria"},t(pr,{className:"w-24 mb-1",color:"var(--text-primary)"}),t("p",{class:"text-sm",style:"color: var(--text-tertiary); font-family: var(--font-mono);"},"Live system overview \u2014 data flow, module health, and your next steps.")),t(Pe,{type:"full"})):A?t("div",{class:"space-y-6"},t("div",{class:"t-frame","data-label":"aria"},t(pr,{className:"w-24 mb-1",color:"var(--text-primary)"}),t("p",{class:"text-sm",style:"color: var(--text-tertiary); font-family: var(--font-mono);"},"Live system overview \u2014 data flow, module health, and your next steps.")),t(we,{error:A,onRetry:()=>{e.refetch(),a.refetch(),r.refetch()}})):b?t("div",{class:"space-y-6"},t(ve,{page:"HOME",subtitle:"Live system overview \u2014 data flow, module health, and your next steps."}),t(we,{error:b})):t("div",{class:"space-y-6 animate-page-enter"},t(ve,{page:"HOME",subtitle:"Live system overview \u2014 data flow, module health, and your next steps."}),t(ze,{value:i?i.current_stage:"starting",label:"pipeline stage",delta:M?`Day ${M.days_of_data} \xB7 ${M.phase}`:null}),t(bv,{maturity:M,shadowStage:S}),t(hv,{activity:a,intraday:_}),t(xv,{moduleStatuses:n?.modules||{},cacheData:k,feedbackHealth:f}))}function Co({items:e}){return!e||e.length===0?null:t("div",{class:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3"},e.map((a,r)=>t("div",{key:r,class:"t-frame",style:`padding: 12px 16px;${a.warning?" border-left: 3px solid var(--status-warning);":""}`},t("div",{class:"data-mono",style:`font-size: var(--type-data); font-weight: 600; color: ${a.warning?"var(--status-warning)":"var(--accent)"};`},a.value),t("div",{class:"t-bracket",style:"margin-top: 4px;"},a.label),a.subtitle&&t("div",{class:"text-xs",style:"color: var(--text-tertiary); margin-top: 2px;"},a.subtitle))))}function To(e,a,r=200){let[n,s]=N(""),[o,l]=N(""),i=Pt(null);le(()=>(i.current!=null&&clearTimeout(i.current),i.current=setTimeout(()=>{l(n)},r),()=>{i.current!=null&&clearTimeout(i.current)}),[n,r]);let u=Oe(()=>{if(!e||!Array.isArray(e))return[];if(!o||!a||a.length===0)return e;let d=o.toLowerCase();return e.filter(g=>a.some(f=>{let m=g[f];return m==null?!1:String(m).toLowerCase().includes(d)}))},[e,o,a]);return{searchTerm:n,setSearchTerm:s,filteredData:u}}function Mo(e,a=50){let[r,n]=N(0),s=e?e.length:0;le(()=>{n(0)},[s]);let o=Math.max(1,Math.ceil(s/a)),l=Oe(()=>{if(!e||e.length===0)return[];let f=r*a;return e.slice(f,f+a)},[e,r,a]),i=s===0?0:r*a+1,u=Math.min((r+1)*a,s);function d(){n(f=>Math.min(f+1,o-1))}function g(){n(f=>Math.max(f-1,0))}return{page:r,pageData:l,nextPage:d,prevPage:g,totalPages:o,total:s,startIndex:i,endIndex:u}}function Wn({columns:e,data:a,searchFields:r=[],pageSize:n=50,searchPlaceholder:s="Search...",filterContent:o}){let l=a||[],{searchTerm:i,setSearchTerm:u,filteredData:d}=To(l,r),[g,f]=N({key:null,direction:"asc"});function m(R){f(W=>W.key===R?{key:R,direction:W.direction==="asc"?"desc":"asc"}:{key:R,direction:"asc"})}let b=Oe(()=>g.key?[...d].sort((R,W)=>{let B=R[g.key],$=W[g.key];if(B==null&&$==null)return 0;if(B==null)return 1;if($==null)return-1;let q;return typeof B=="number"&&typeof $=="number"?q=B-$:q=String(B).localeCompare(String($),void 0,{numeric:!0,sensitivity:"base"}),g.direction==="asc"?q:-q}):d,[d,g.key,g.direction]),{pageData:h,nextPage:C,prevPage:A,totalPages:M,total:_,startIndex:S,endIndex:k,page:O}=Mo(b,n),L=O>0,H=O<M-1;return t("div",{class:"t-card",style:"overflow: hidden;"},t("div",{class:"px-4 py-3",style:"border-bottom: 1px solid var(--border-subtle);"},t("div",{class:"flex flex-col sm:flex-row sm:items-center gap-3"},t("div",{class:"relative flex-1 max-w-sm"},t("input",{type:"text",value:i,onInput:R=>u(R.target.value),placeholder:s,class:"t-input w-full px-3 py-1.5 text-sm"}),i&&t("span",{class:"absolute right-2 top-1/2 -translate-y-1/2 text-xs",style:"color: var(--text-tertiary);"},d.length," / ",l.length))),o&&t("div",{class:"mt-3"},o)),t("div",{class:"overflow-x-auto"},t("table",{class:"w-full"},t("thead",null,t("tr",{style:"background: var(--bg-surface-raised);"},e.map(R=>t("th",{key:R.key,class:`px-4 py-2 text-left ${R.sortable?"cursor-pointer select-none":""} ${R.className||""}`,style:"color: var(--text-tertiary); font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.05em; font-weight: 500;",onClick:R.sortable?()=>m(R.key):void 0},t("span",{class:"inline-flex items-center gap-1"},R.label,R.sortable&&t(_v,{active:g.key===R.key,direction:g.direction})))))),t("tbody",null,h.length===0?t("tr",null,t("td",{colSpan:e.length,class:"px-4 py-12 text-center text-sm",style:"color: var(--text-tertiary);"},l.length===0?"No data available":"No results match your filters")):h.map((R,W)=>t("tr",{key:R.id||R.entity_id||W,style:"border-bottom: 1px solid var(--border-subtle);"},e.map(B=>t("td",{key:B.key,class:`px-4 py-2 text-sm ${B.className||""}`,style:"color: var(--text-secondary);"},B.render?B.render(R[B.key],R):R[B.key]!=null?R[B.key]:"\u2014"))))))),_>0&&t("div",{class:"px-4 py-3 flex items-center justify-between",style:"border-top: 1px solid var(--border-subtle);"},t("span",{class:"text-sm",style:"color: var(--text-tertiary);"},"Showing ",S,"\\u2013",k," of ",_),t("div",{class:"flex gap-2"},t("button",{onClick:A,disabled:!L,class:"px-3 py-1 text-sm disabled:opacity-50 disabled:cursor-not-allowed",style:"color: var(--text-secondary); background: var(--bg-surface-raised); border: 1px solid var(--border-primary); border-radius: var(--radius);"},"Previous"),t("button",{onClick:C,disabled:!H,class:"px-3 py-1 text-sm disabled:opacity-50 disabled:cursor-not-allowed",style:"color: var(--text-secondary); background: var(--bg-surface-raised); border: 1px solid var(--border-primary); border-radius: var(--radius);"},"Next"))))}function _v({active:e,direction:a}){return e?a==="asc"?t("svg",{class:"w-3 h-3",style:"color: var(--text-primary);",viewBox:"0 0 12 12",fill:"currentColor"},t("path",{d:"M6 2l3 4H3z"})):t("svg",{class:"w-3 h-3",style:"color: var(--text-primary);",viewBox:"0 0 12 12",fill:"currentColor"},t("path",{d:"M6 10l-3-4h6z"})):t("svg",{class:"w-3 h-3",style:"color: var(--text-tertiary);",viewBox:"0 0 12 12",fill:"currentColor"},t("path",{d:"M6 2l3 4H3z"}),t("path",{d:"M6 10l-3-4h6z"}))}function Eo({data:e,total:a}){if(!e||e.length===0)return null;let r=e[0]?.count||1;return t("div",{class:"space-y-2"},e.map(n=>{let s=a>0?(n.count/a*100).toFixed(1):0,o=r>0?n.count/r*100:0;return t("div",{key:n.domain,class:"flex items-center gap-2"},t("span",{class:"w-28 text-sm text-right truncate",style:"color: var(--text-secondary);",title:n.domain},n.domain),t("div",{class:"flex-1 h-6 overflow-hidden",style:"background: var(--bg-inset); border-radius: var(--radius);"},t("div",{class:"h-full transition-all",style:`background: var(--accent); border-radius: var(--radius); width: ${o}%;`})),t("span",{class:"w-20 text-sm data-mono",style:"color: var(--text-tertiary);"},n.count," (",s,"%)"))}))}function Jr({state:e}){let a=(e||"").toLowerCase(),r;return a==="on"||a==="home"?r="t-status-healthy":a==="unavailable"||a==="unknown"?r="t-status-error":e!=null&&e!==""&&!isNaN(Number(e))?r="t-status-healthy":r="t-status-waiting",t("span",{class:`t-status ${r}`},t("span",{style:"display: inline-block; width: 5px; height: 5px; border-radius: 50%; background: currentColor;"}),e)}var jn={};function Po(e,a){if(e.area_id)return e.area_id;if(e.device_id){let r=a[e.device_id];if(r&&r.area_id)return r.area_id}return null}function Lo(){let e=We("entities"),a=We("devices"),r=We("areas"),n=We("capabilities"),[s,o]=N(""),[l,i]=N(""),[u,d]=N(""),g=e.loading||a.loading||r.loading||n.loading,f=e.error||a.error||r.error||n.error,m=e.data?.data||jn,b=a.data?.data||jn,h=r.data?.data||jn,C=n.data?.data||jn,A=pe(()=>Object.entries(m).map(([E,P])=>({entity_id:E,...P})),[m]),M=pe(()=>{let E=A.filter(re=>re.state==="unavailable"),P=E.length,ae=Date.now(),he=E.filter(re=>{if(!re.last_changed)return!1;let me=new Date(re.last_changed).getTime();return ae-me>1440*60*1e3}).length;return{total:P,longUnavailable:he}},[A]),_=M.total,S=pe(()=>e.data?[{label:"Entities",value:A.length.toLocaleString()},{label:"Devices",value:Object.keys(b).length.toLocaleString()},{label:"Areas",value:Object.keys(h).length.toLocaleString()},{label:"Capabilities",value:Object.keys(C).length.toLocaleString()},{label:"Unavailable",value:_,subtitle:M.longUnavailable>0?`${M.longUnavailable} > 24h`:void 0,warning:_>100}]:null,[e.data,A,b,h,C,_,M]),k=pe(()=>{let E={};for(let P of A){let ae=P.domain||P.entity_id?.split(".")[0]||"unknown";E[ae]=(E[ae]||0)+1}return Object.entries(E).map(([P,ae])=>({domain:P,count:ae})).sort((P,ae)=>ae.count-P.count)},[A]),O=pe(()=>{let E={};for(let P of A){let ae=Po(P,b);ae&&(E[ae]=(E[ae]||0)+1)}return Object.entries(h).map(([P,ae])=>({area_id:P,name:ae.name||P,count:E[P]||0})).sort((P,ae)=>ae.count-P.count)},[A,h,b]),L=pe(()=>[...new Set(A.map(P=>P.domain||P.entity_id?.split(".")[0]))].sort(),[A]),H=pe(()=>[...new Set(A.map(P=>P.state).filter(Boolean))].sort(),[A]),R=pe(()=>Object.entries(h).map(([E,P])=>({id:E,name:P.name||E})).sort((E,P)=>E.name.localeCompare(P.name)),[h]),W=Oe(()=>{let E=A;return s&&(E=E.filter(P=>(P.domain||P.entity_id?.split(".")[0])===s)),l&&(E=E.filter(P=>P.state===l)),u&&(E=E.filter(P=>Po(P,b)===u)),E},[A,s,l,u,b]),B=[{key:"friendly_name",label:"Entity",sortable:!0,render:(E,P)=>t("div",null,t("div",{class:"font-semibold",style:"color: var(--text-primary)"},P.friendly_name||P.entity_id),t("div",{class:"text-xs data-mono",style:"color: var(--text-tertiary)"},P.entity_id))},{key:"state",label:"State",sortable:!0,render:(E,P)=>t("span",{class:"inline-flex items-center gap-1"},t(Jr,{state:E}),P.unit_of_measurement&&t("span",{class:"text-xs",style:"color: var(--text-tertiary)"},P.unit_of_measurement))},{key:"domain",label:"Domain",sortable:!0,render:(E,P)=>{let ae=E||P.entity_id?.split(".")[0]||"\u2014";return t("span",{class:"inline-block px-2 py-0.5 text-xs font-medium",style:"background: var(--bg-inset); color: var(--text-primary); border-radius: var(--radius);"},ae)}},{key:"device_class",label:"Class",sortable:!0,render:E=>E||"\u2014"},{key:"area_id",label:"Area",sortable:!0,render:(E,P)=>{let ae=Po(P,b);if(!ae)return"\u2014";let he=h[ae];return he?he.name:ae}},{key:"device_id",label:"Device",sortable:!0,render:E=>{if(!E)return"\u2014";let P=b[E];return P?P.name:E}}],$=pe(()=>Object.entries(b).map(([E,P])=>({device_id:E,...P,area_name:P.area_id&&h[P.area_id]?h[P.area_id].name:P.area_id||"\u2014"})),[b,h]),q=[{key:"name",label:"Name",sortable:!0,render:(E,P)=>t("div",null,t("div",{class:"font-semibold",style:"color: var(--text-primary)"},E||P.device_id),t("div",{class:"text-xs data-mono",style:"color: var(--text-tertiary)"},P.device_id))},{key:"manufacturer",label:"Manufacturer",sortable:!0,render:E=>E||"\u2014"},{key:"model",label:"Model",sortable:!0,render:E=>E||"\u2014"},{key:"area_name",label:"Area",sortable:!0,render:E=>E||"\u2014"}],G=t("div",{class:"flex flex-wrap gap-3"},t("select",{value:s,onChange:E=>o(E.target.value),class:"t-input px-2 py-1.5 text-sm"},t("option",{value:""},"All domains"),L.map(E=>t("option",{key:E,value:E},E))),t("select",{value:l,onChange:E=>i(E.target.value),class:"t-input px-2 py-1.5 text-sm"},t("option",{value:""},"All states"),t("option",{value:"on"},"on"),t("option",{value:"off"},"off"),t("option",{value:"unavailable"},"unavailable"),H.filter(E=>E!=="on"&&E!=="off"&&E!=="unavailable").map(E=>t("option",{key:E,value:E},E))),t("select",{value:u,onChange:E=>d(E.target.value),class:"t-input px-2 py-1.5 text-sm"},t("option",{value:""},"All areas"),R.map(E=>t("option",{key:E.id,value:E.id},E.name))),(s||l||u)&&t("button",{onClick:()=>{o(""),i(""),d("")},class:"px-2 py-1.5 text-sm",style:"color: var(--accent);"},"Clear filters")),Z="Everything the hub found by scanning your Home Assistant instance. Rescans automatically every 24 hours.";if(g&&!e.data)return t("div",{class:"space-y-6"},t("div",null,t("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Discovery"),t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},Z)),t(Pe,{type:"full"}));if(f)return t("div",{class:"space-y-6"},t("div",null,t("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Discovery"),t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},Z)),t(we,{error:f,onRetry:()=>{e.refetch(),a.refetch(),r.refetch(),n.refetch()}}));let Y=Object.keys(h).length;return t("div",{class:"space-y-6 animate-page-enter"},t(ve,{page:"DISCOVERY",subtitle:"Every entity, device, and area in your home."}),t(ze,{value:A.length.toLocaleString(),label:"entities discovered",delta:`across ${Y} area${Y!==1?"s":""}`,loading:g}),S?t(Co,{items:S}):t(Pe,{type:"stats"}),t("section",null,t("div",{class:"t-section-header mb-4",style:"padding-bottom: 6px;"},t("h2",{class:"text-lg font-semibold",style:"color: var(--text-primary)"},"Domain Breakdown"),t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"How your entities are distributed across HA domains. Larger bars = more entities in that domain.")),t("div",{class:"t-frame","data-label":"domains",style:"padding: 1rem;"},t(Eo,{data:k,total:A.length}))),O.length>0&&t("section",null,t("div",{class:"t-section-header mb-4",style:"padding-bottom: 6px;"},t("h2",{class:"text-lg font-semibold",style:"color: var(--text-primary)"},"Areas"),t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Physical locations defined in Home Assistant, with entity counts per area.")),t("div",{class:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-4"},O.map(E=>t("div",{key:E.area_id,class:"t-frame","data-label":E.name,style:"padding: 1rem;"},t("div",{class:"font-semibold text-sm truncate",style:"color: var(--text-primary)",title:E.name},E.name),t("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},E.count," entities"))))),t("section",null,t("div",{class:"t-section-header mb-4",style:"padding-bottom: 6px;"},t("h2",{class:"text-lg font-semibold",style:"color: var(--text-primary)"},"Entities"),t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Every entity registered in HA \u2014 sensors, switches, lights, and more. Filter by domain, state, or area.")),t(Wn,{columns:B,data:W,searchFields:["entity_id","friendly_name","domain","device_class"],pageSize:50,searchPlaceholder:"Search entities...",filterContent:G})),t("section",null,t("div",{class:"t-section-header mb-4",style:"padding-bottom: 6px;"},t("h2",{class:"text-lg font-semibold",style:"color: var(--text-primary)"},"Devices"),t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Physical devices registered in HA. Each device groups multiple entities (e.g., a thermostat has temperature, humidity, and mode entities).")),t(Wn,{columns:q,data:$,searchFields:["name","device_id","manufacturer","model"],pageSize:50,searchPlaceholder:"Search devices..."})))}function vt({title:e,subtitle:a,summary:r,defaultOpen:n=!0,loading:s=!1,children:o}){let[l,i]=N(n),u="cursor-idle";s?u="cursor-working":l&&(u="cursor-active");function d(){s||i(!l)}return t("section",null,t("button",{type:"button",onClick:d,class:`${u} w-full text-left flex items-center justify-between`,style:"padding: 8px 0; cursor: pointer; background: none; border: none; border-bottom: 1px solid var(--border-subtle);","aria-expanded":l,"aria-label":`${l?"Collapse":"Expand"} ${e}`},t("div",{class:"flex-1 min-w-0"},t("h2",{style:"font-size: var(--type-headline); color: var(--text-primary); font-family: var(--font-mono); font-weight: 700;"},e),a&&!l&&r&&t("span",{class:"t-bracket",style:"margin-left: 8px;"},r),a&&l&&t("p",{style:"font-size: var(--type-label); color: var(--text-tertiary); margin-top: 2px;"},a))),l&&t("div",{class:"animate-page-enter",style:"padding-top: 12px;"},o))}function Zr({value:e,label:a,sublabel:r}){let n=Math.max(0,Math.min(100,e||0)),s=n>=70?"var(--status-healthy)":n>=40?"var(--status-warning)":"var(--status-error)";return t("div",{class:"space-y-1"},t("div",{class:"flex items-center justify-between"},t("span",{style:"font-size: var(--type-label); color: var(--text-secondary); font-family: var(--font-mono);"},a),t("span",{style:"font-size: var(--type-label); font-family: var(--font-mono);"},r&&t("span",{style:"color: var(--text-tertiary); margin-right: 6px;"},r),t("span",{style:`color: ${s};`},Math.round(n),"%"))),t("div",{style:"height: 6px; border-radius: 3px; background: var(--bg-inset); overflow: hidden;"},t("div",{style:`height: 100%; width: ${n}%; background: ${s}; border-radius: 3px; transition: width 0.3s ease;`})))}function sd(e){if(!e)return"\u2014";try{return new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}catch{return e}}function $o({name:e,capability:a,onAction:r}){let[n,s]=N(!1),[o,l]=N(null),i=a.usefulness_components||{},u=a.entities||[],d=a.temporal_pattern||{},g=a.status||"promoted",f=[{key:"predictability",label:"Predictability"},{key:"stability",label:"Stability"},{key:"coverage",label:"Coverage"},{key:"activity",label:"Activity"},{key:"cohesion",label:"Cohesion"}],m=[{key:"description",label:"Description"},{key:"source",label:"Source"},{key:"layer",label:"Layer"},{key:"naming_method",label:"Naming"},{key:"first_seen",label:"First seen",format:sd},{key:"promoted_at",label:"Promoted",format:sd}];async function b(A){l(A);try{await fa(`/api/capabilities/${e}/${A}`),r&&r()}catch(M){console.error(`Failed to ${A} capability:`,M)}finally{l(null)}}let h=n?u:u.slice(0,5),C=u.length>5;return t("div",{class:"space-y-4",style:"padding-top: 12px; border-top: 1px solid var(--border-subtle);"},Object.keys(i).length>0&&t("div",{class:"space-y-2"},t("span",{style:"font-size: var(--type-label); color: var(--text-tertiary); font-family: var(--font-mono); text-transform: uppercase;"},"Usefulness breakdown"),f.map(({key:A,label:M})=>i[A]!=null?t(Zr,{key:A,value:i[A],label:M}):null)),t("div",{class:"space-y-1"},m.map(({key:A,label:M,format:_})=>{let S=a[A];if(S==null)return null;let k=_?_(S):String(S);return t("div",{key:A,class:"flex justify-between",style:"font-size: var(--type-label); font-family: var(--font-mono);"},t("span",{style:"color: var(--text-tertiary);"},M),t("span",{style:"color: var(--text-secondary);"},k))})),(d.peak_hours||d.weekday_bias)&&t("div",{class:"space-y-1"},t("span",{style:"font-size: var(--type-label); color: var(--text-tertiary); font-family: var(--font-mono); text-transform: uppercase;"},"Temporal pattern"),d.peak_hours&&t("div",{class:"flex justify-between",style:"font-size: var(--type-label); font-family: var(--font-mono);"},t("span",{style:"color: var(--text-tertiary);"},"Peak hours"),t("span",{style:"color: var(--text-secondary);"},Array.isArray(d.peak_hours)?d.peak_hours.join(", "):String(d.peak_hours))),d.weekday_bias&&t("div",{class:"flex justify-between",style:"font-size: var(--type-label); font-family: var(--font-mono);"},t("span",{style:"color: var(--text-tertiary);"},"Weekday bias"),t("span",{style:"color: var(--text-secondary);"},String(d.weekday_bias)))),u.length>0&&t("div",null,t("span",{style:"font-size: var(--type-label); color: var(--text-tertiary); font-family: var(--font-mono); text-transform: uppercase;"},"Entities (",u.length,")"),t("ul",{class:"space-y-0.5",style:"margin-top: 4px;"},h.map(A=>t("li",{key:A,class:"truncate data-mono",style:"font-size: var(--type-label); color: var(--text-tertiary);"},A))),C&&t("button",{onClick:()=>s(!n),class:"cursor-pointer",style:"font-size: var(--type-label); color: var(--accent); background: none; border: none; padding: 0; margin-top: 4px; font-family: var(--font-mono);"},n?"Show less":`Show all ${u.length}`)),t("div",{class:"flex gap-2",style:"padding-top: 8px;"},g!=="promoted"&&t("button",{onClick:()=>b("promote"),disabled:o!==null,class:"cursor-pointer",style:`font-size: var(--type-label); font-family: var(--font-mono); padding: 4px 12px; border: 1px solid var(--status-healthy); color: var(--status-healthy); background: var(--status-healthy-glow); border-radius: 4px; opacity: ${o?"0.5":"1"};`},o==="promote"?"Promoting...":"Promote"),g!=="archived"&&t("button",{onClick:()=>b("archive"),disabled:o!==null,class:"cursor-pointer",style:`font-size: var(--type-label); font-family: var(--font-mono); padding: 4px 12px; border: 1px solid var(--text-tertiary); color: var(--text-tertiary); background: none; border-radius: 4px; opacity: ${o?"0.5":"1"};`},o==="archive"?"Archiving...":"Archive")))}function od(e){let a=(e||"").replace(/_/g," ");return a.charAt(0).toUpperCase()+a.slice(1)}var wv={power_monitoring:{why:"Power usage follows daily patterns \u2014 morning coffee, evening TV, overnight baseline. ARIA learns your typical wattage curves and flags unusual spikes or drops.",on:"ARIA will predict your expected power draw and alert when it deviates.",off:"Power predictions disabled. ARIA will still track power but won't flag anomalies."},lighting:{why:"Lights follow routines \u2014 on at sunset, off at bedtime. ARIA learns which lights are typically on at what time of day.",on:"ARIA will predict which lights should be on and notice unexpected changes.",off:"Light predictions disabled. ARIA will still count lights but won't predict patterns."},occupancy:{why:"Presence follows your schedule \u2014 leave for work, come home in the evening. ARIA learns your typical comings and goings.",on:"ARIA will predict when you're likely home and notice unexpected absences or arrivals.",off:"Occupancy predictions disabled. ARIA will still track presence but won't predict it."},climate:{why:"Thermostats follow schedules and seasons. ARIA learns your comfort patterns and heating/cooling cycles.",on:"ARIA will predict temperature trends and notice when climate behavior changes.",off:"Climate predictions disabled. ARIA will still monitor temperature data."},battery_devices:{why:"Batteries drain predictably \u2014 sensors last weeks, tablets last hours. ARIA learns each device's discharge curve.",on:"ARIA will predict when batteries need charging and flag unusual drain.",off:"Battery predictions disabled. Levels are still tracked."},motion:{why:"Motion sensors are inherently reactive \u2014 they fire when someone walks by. Individual triggers are hard to predict, but daily patterns (busy mornings, quiet nights) can be learned.",on:"ARIA will learn your typical motion patterns and flag unusual quiet or busy periods.",off:"Motion predictions off. This is the default because individual motion events are noisy."},doors_windows:{why:"Door and window sensors track openings. Some follow routines (garage door at 8am), others are random (bathroom door). Predictions work best when you have consistent habits.",on:"ARIA will learn your door/window patterns and notice unusual activity.",off:"Door/window predictions off. This is the default because contact events vary widely."},locks:{why:"Smart locks often follow routines \u2014 lock at bedtime, unlock in the morning. If your lock usage is consistent, predictions can spot when something breaks the pattern.",on:"ARIA will learn your locking patterns and notice when they change.",off:"Lock predictions off. This is the default because lock events are security-sensitive."},media:{why:"Media playback depends on mood, not schedule. But if you have routines (morning news, bedtime podcast), ARIA can learn those patterns.",on:"ARIA will learn your media habits and predict typical playback times.",off:"Media predictions off. This is the default because playback is usually on-demand."},vacuum:{why:"Robot vacuums usually run on their own schedule, set in the robot's app. ARIA can learn when cleaning typically happens.",on:"ARIA will learn your vacuum schedule and notice missed or extra runs.",off:"Vacuum predictions off. Most vacuums have their own scheduling."}},kv={why:"ARIA can attempt to learn patterns for this capability based on your historical data.",on:"Predictions enabled \u2014 ARIA will look for patterns.",off:"Predictions disabled \u2014 ARIA will still track data but won't predict."};function Sv({name:e,canPredict:a,onToggle:r}){let[n,s]=N(!1),[o,l]=N(!1),i=wv[e]||kv;async function u(){s(!0);try{await r(e,!a)}finally{s(!1)}}return t("div",{class:"space-y-2"},t("div",{class:"flex items-center justify-between"},t("div",{class:"flex items-center gap-2"},t("span",{class:"text-sm font-medium",style:"color: var(--text-secondary)"},"Predictions"),t("button",{onClick:()=>l(!o),class:"text-xs cursor-pointer",style:"color: var(--accent); background: none; border: none; padding: 0;",title:"Why?"},o?"hide":"why?")),t("button",{onClick:u,disabled:n,class:"relative inline-flex items-center h-6 w-11 rounded-full cursor-pointer transition-colors",style:`background: ${a?"var(--accent)":"var(--bg-inset)"}; border: 2px solid ${a?"var(--accent)":"var(--border-subtle)"}; opacity: ${n?"0.5":"1"};`,title:a?"Click to disable predictions":"Click to enable predictions"},t("span",{class:"inline-block h-4 w-4 rounded-full transition-transform",style:`background: ${a?"var(--bg-base)":"var(--text-tertiary)"}; transform: translateX(${a?"20px":"2px"});`}))),t("p",{class:"text-xs",style:`color: ${a?"var(--status-healthy)":"var(--text-tertiary)"}`},a?i.on:i.off),o&&t("div",{class:"t-callout p-2 text-xs",style:"color: var(--text-secondary); line-height: 1.5;"},i.why))}function Do({name:e,capability:a,onTogglePredict:r,onAction:n}){let[s,o]=N(!1),l=a.entities||[],i=a.entity_count||l.length,u=a.can_predict??!1,d=a.usefulness??null,g=a.source||null,f=a.layer||null,m=a.status||"promoted",b=a.stability_streak??null;return t("div",{class:"t-frame","data-label":od(e),style:"padding: 1rem; cursor: pointer;",onClick:()=>o(!s)},t("div",{class:"flex items-center justify-between mb-2",style:"flex-wrap: wrap; gap: 4px;"},t("h3",{class:"text-base font-bold",style:"color: var(--text-primary); margin: 0;"},od(e)),t("div",{class:"flex items-center gap-1",style:"flex-wrap: wrap;"},t("span",{class:"inline-block px-2 py-0.5 rounded-full text-xs font-medium",style:"background: var(--accent-glow); color: var(--accent); white-space: nowrap;"},i," ",i===1?"entity":"entities"),g&&t("span",{class:"inline-block px-2 py-0.5 rounded-full text-xs font-medium",style:`white-space: nowrap; ${g==="organic"?"background: var(--status-healthy-glow); color: var(--status-healthy);":"background: var(--bg-surface-raised); color: var(--text-tertiary);"}`},g),f&&t("span",{class:"inline-block px-2 py-0.5 rounded-full text-xs font-medium",style:`white-space: nowrap; ${f==="behavioral"?"background: color-mix(in srgb, var(--accent-purple) 15%, transparent); color: var(--accent-purple);":"background: var(--bg-surface-raised); color: var(--text-secondary);"}`},f))),d!=null&&t("div",{style:"margin-bottom: 8px;"},t(Zr,{value:d,label:"Usefulness"})),m==="candidate"&&b!=null&&t("div",{style:"font-size: var(--type-label); color: var(--text-tertiary); font-family: var(--font-mono); margin-bottom: 8px;"},"Stability streak: ",t("span",{style:`color: ${b>=7?"var(--status-healthy)":"var(--text-secondary)"};`},b,"d")),m==="promoted"&&t("div",{class:"mb-2 pb-2",style:"border-bottom: 1px solid var(--border-subtle);",onClick:h=>h.stopPropagation()},t(Sv,{name:e,canPredict:u,onToggle:r})),s&&t("div",{onClick:h=>h.stopPropagation()},t($o,{name:e,capability:a,onAction:n})))}function Av({data:e}){if(!e)return null;let a=e.discovery_metadata||e.metadata||{},r=a.last_organic_run||a.last_run||null,n=a.autonomy_mode||null,s=a.naming_backend||null;return!r&&!n&&!s?null:t("div",{class:"t-frame","data-label":"Discovery",style:"padding: 0.75rem;"},t("div",{class:"flex items-center gap-4",style:"flex-wrap: wrap; font-size: var(--type-label); font-family: var(--font-mono);"},r&&t("span",{style:"color: var(--text-secondary);"},"Last run: ",t("span",{style:"color: var(--text-primary);"},Cv(r))),n&&t("span",{style:"color: var(--text-secondary);"},"Mode: ",t("span",{style:"color: var(--accent);"},n)),s&&t("span",{style:"color: var(--text-secondary);"},"Naming: ",t("span",{style:"color: var(--text-primary);"},s))))}function Cv(e){if(!e)return"\u2014";try{let a=new Date(e),n=new Date-a,s=Math.floor(n/6e4);if(s<1)return"just now";if(s<60)return`${s}m ago`;let o=Math.floor(s/60);return o<24?`${o}h ago`:a.toLocaleDateString(void 0,{month:"short",day:"numeric"})}catch{return e}}function ld(e){switch(e){case"stable":return"var(--status-healthy)";case"experimental":return"var(--status-warning)";case"planned":return"var(--text-tertiary)";default:return"var(--text-secondary)"}}function id(e){switch(e){case"stable":return"var(--status-healthy-glow)";case"experimental":return"var(--status-warning-glow)";case"planned":return"var(--bg-surface-raised)";default:return"var(--bg-surface-raised)"}}function cd(e){switch(e){case"hub":return"var(--accent)";case"engine":return"var(--accent-purple)";case"dashboard":return"var(--status-warning)";default:return"var(--text-secondary)"}}function Tv(){let[e,a]=N(null),[r,n]=N(!0),[s,o]=N(null);if(le(()=>{ce("/api/capabilities/registry").then(d=>{a(d),n(!1)}).catch(d=>{o(d.message),n(!1)})},[]),r)return t(vt,{title:"System Registry",subtitle:"Code-declared capability inventory for regression tracking.",summary:"Loading...",defaultOpen:!1},t(Pe,{type:"table"}));if(s)return t(vt,{title:"System Registry",subtitle:"Code-declared capability inventory for regression tracking.",summary:"Error",defaultOpen:!1},t("div",{class:"t-callout p-3 text-sm",style:"color: var(--status-error);"},s));if(!e)return null;let l=e.capabilities||[],i=e.by_layer||{},u=e.by_status||{};return t(vt,{title:"System Registry",subtitle:"Code-declared capability inventory for regression tracking.",summary:`${e.total} capabilities`,defaultOpen:!1},t("div",{class:"flex flex-wrap gap-2 mb-4"},Object.entries(i).map(([d,g])=>t("span",{key:d,class:"inline-block px-2 py-1 rounded text-xs font-medium",style:`color: ${cd(d)}; background: var(--bg-surface-raised); font-family: var(--font-mono);`},d,": ",g)),t("span",{style:"color: var(--border-subtle);"},"|"),Object.entries(u).map(([d,g])=>t("span",{key:d,class:"inline-block px-2 py-1 rounded text-xs font-medium",style:`color: ${ld(d)}; background: ${id(d)};`},d,": ",g))),t("div",{style:"overflow-x: auto;"},t("table",{style:"width: 100%; border-collapse: collapse; font-size: var(--type-body);"},t("thead",null,t("tr",{style:"border-bottom: 1px solid var(--border-subtle);"},t("th",{style:"text-align: left; padding: 8px 12px; color: var(--text-tertiary); font-weight: 600; font-size: var(--type-label);"},"ID"),t("th",{style:"text-align: left; padding: 8px 12px; color: var(--text-tertiary); font-weight: 600; font-size: var(--type-label);"},"Name"),t("th",{style:"text-align: left; padding: 8px 12px; color: var(--text-tertiary); font-weight: 600; font-size: var(--type-label);"},"Layer"),t("th",{style:"text-align: left; padding: 8px 12px; color: var(--text-tertiary); font-weight: 600; font-size: var(--type-label);"},"Status"),t("th",{style:"text-align: right; padding: 8px 12px; color: var(--text-tertiary); font-weight: 600; font-size: var(--type-label);"},"Tests"),t("th",{style:"text-align: right; padding: 8px 12px; color: var(--text-tertiary); font-weight: 600; font-size: var(--type-label);"},"Config"),t("th",{style:"text-align: left; padding: 8px 12px; color: var(--text-tertiary); font-weight: 600; font-size: var(--type-label);"},"Deps"))),t("tbody",null,l.map(d=>t("tr",{key:d.id,style:"border-bottom: 1px solid var(--border-subtle);"},t("td",{style:"padding: 8px 12px; font-family: var(--font-mono); color: var(--text-primary);"},d.id),t("td",{style:"padding: 8px 12px; color: var(--text-secondary);"},d.name),t("td",{style:"padding: 8px 12px;"},t("span",{class:"inline-block px-1.5 py-0.5 rounded text-xs",style:`color: ${cd(d.layer)}; background: var(--bg-surface-raised);`},d.layer)),t("td",{style:"padding: 8px 12px;"},t("span",{class:"inline-block px-1.5 py-0.5 rounded text-xs",style:`color: ${ld(d.status)}; background: ${id(d.status)};`},d.status)),t("td",{style:"padding: 8px 12px; text-align: right; font-family: var(--font-mono); color: var(--text-secondary);"},(d.test_paths||[]).length),t("td",{style:"padding: 8px 12px; text-align: right; font-family: var(--font-mono); color: var(--text-secondary);"},(d.config_keys||[]).length),t("td",{style:"padding: 8px 12px; font-family: var(--font-mono); font-size: var(--type-label); color: var(--text-tertiary);"},(d.depends_on||[]).length>0?d.depends_on.join(", "):"\u2014")))))))}function Io(){let{data:e,loading:a,error:r,refetch:n}=We("capabilities"),s=pe(()=>{if(!e||!e.data)return[];let m=e.data;return Object.entries(m).map(([b,h])=>({name:b,...h}))},[e]),o=pe(()=>s.filter(m=>m.status==="promoted"||!m.status),[s]),l=pe(()=>s.filter(m=>m.status==="candidate"),[s]),i=pe(()=>s.filter(m=>m.status==="archived"),[s]),u=pe(()=>s.reduce((m,b)=>m+(b.entity_count||(b.entities||[]).length),0),[s]);async function d(m,b){try{await fa(`/api/capabilities/${m}/can-predict`,{can_predict:b}),n()}catch(h){console.error("Failed to toggle can_predict:",h)}}function g(){n()}let f=`${o.length} promoted \xB7 ${l.length} candidate${l.length!==1?"s":""} \xB7 ${u} entities`;return a&&!e?t("div",{class:"space-y-6"},t(ve,{page:"CAPABILITIES",subtitle:"Detected home capabilities and features."}),t(Pe,{type:"cards"})):r?t("div",{class:"space-y-6"},t(ve,{page:"CAPABILITIES",subtitle:"Detected home capabilities and features."}),t(we,{error:r,onRetry:n})):t("div",{class:"space-y-6 animate-page-enter"},t(ve,{page:"CAPABILITIES",subtitle:"Detected home capabilities and features."}),t(ze,{value:s.length,label:"capabilities",delta:f,loading:a}),t(Av,{data:e}),t("div",{class:"t-callout p-3 text-sm",style:"color: var(--text-secondary); line-height: 1.5;"},"ARIA automatically detects what your home can do by scanning your entities. Each capability can be toggled for ",t("strong",{style:"color: var(--text-primary)"},"predictions")," \u2014 when enabled, ARIA learns the patterns for that capability and flags when something changes. Organic discovery finds new groupings automatically; candidates are promoted once they prove stable."),s.length===0?t("div",{class:"t-callout",style:"padding: 0.75rem;"},t("span",{class:"text-sm",style:"color: var(--text-secondary)"},"No capabilities detected yet. Capabilities are identified during discovery by matching entity domains and device classes. They appear after the first successful discovery scan.")):t("div",{class:"space-y-6"},o.length>0&&t(vt,{title:"Promoted",subtitle:"Active capabilities tracked by ARIA.",summary:`${o.length} capabilities`,defaultOpen:!0,loading:a},t("div",{class:"grid grid-cols-1 lg:grid-cols-2 gap-4 stagger-children"},o.map(m=>t(Do,{key:m.name,name:m.name,capability:m,onTogglePredict:d,onAction:g})))),l.length>0&&t(vt,{title:"Candidates",subtitle:"Organically discovered capabilities awaiting promotion.",summary:`${l.length} candidates`,defaultOpen:!0,loading:a},t("div",{class:"grid grid-cols-1 lg:grid-cols-2 gap-4 stagger-children"},l.map(m=>t(Do,{key:m.name,name:m.name,capability:m,onTogglePredict:d,onAction:g})))),i.length>0&&t(vt,{title:"Archived",subtitle:"Capabilities removed from active tracking.",summary:`${i.length} archived`,defaultOpen:!1,loading:a},t("div",{class:"grid grid-cols-1 lg:grid-cols-2 gap-4 stagger-children"},i.map(m=>t(Do,{key:m.name,name:m.name,capability:m,onTogglePredict:d,onAction:g}))))),t(Tv,null))}function dd(e){return e>=70?"color: var(--status-healthy)":e>=40?"color: var(--status-warning)":"color: var(--status-error)"}function ud(e){return e>=.7?"background: var(--status-healthy-glow); color: var(--status-healthy);":e>=.4?"background: var(--status-warning-glow); color: var(--status-warning);":"background: var(--status-error-glow); color: var(--status-error);"}var Un=20,Vn=100,pd=20,fd=10,vd=360*60*1e3,md=3600*1e3;var Ro=["collecting","baselines","ml-training","ml-active"],yd=["Collecting","Baselines","ML Training","ML Active"];function Mv({prediction:e}){let[a,r]=N(!1),n=e.confidence??0,s=Math.round(n*100);return t("div",{class:"t-frame","data-label":e.entity_id||e.metric||"prediction",style:"padding: 1rem;"},t("div",{class:"flex items-center justify-between mb-3"},t("h3",{class:"text-sm font-bold truncate mr-2 data-mono",style:"color: var(--text-primary)"},e.entity_id),t("span",{class:"inline-block px-2 py-0.5 rounded-full text-xs font-medium whitespace-nowrap",style:ud(n)},s,"%")),t("div",{class:"flex items-center gap-2 mb-3"},t("span",{class:"text-xs",style:"color: var(--text-tertiary)"},"Predicted:"),t(Jr,{state:String(e.predicted_value??"")}),e.current_value!=null&&t("span",{class:"text-xs ml-2",style:"color: var(--text-tertiary)"},"current: ",e.current_value)),t("div",{class:"mb-3"},t("div",{class:"flex items-center justify-between text-xs mb-1",style:"color: var(--text-tertiary)"},t("span",null,"Confidence"),t("span",null,s,"%")),t("div",{class:"h-2 rounded-full",style:"background: var(--bg-inset)"},t("div",{class:"h-2 rounded-full transition-all",style:`background: var(--accent); width: ${s}%`}))),t("div",{class:"text-xs space-y-0.5",style:"color: var(--text-tertiary)"},e.model&&t("div",null,"Model: ",t("span",{style:"color: var(--text-secondary)"},e.model)),e.prediction_time&&t("div",null,"Time: ",t("span",{style:"color: var(--text-secondary)"},new Date(e.prediction_time).toLocaleString()))),e.features&&t("div",{class:"mt-3"},t("button",{onClick:()=>r(!a),class:"text-sm cursor-pointer",style:"color: var(--accent)"},a?"Hide details":"Show details"),a&&t("pre",{class:"mt-2 p-3 text-xs overflow-x-auto",style:"background: var(--bg-inset); color: var(--text-primary); border-radius: var(--radius); font-family: var(--font-mono)"},JSON.stringify(e.features,null,2))))}function No(){let{data:e,loading:a,error:r,refetch:n}=We("ml_predictions"),{metadata:s,predictions:o}=pe(()=>{if(!e||!e.data)return{metadata:null,predictions:[]};let i=e.data;return{metadata:i.metadata||null,predictions:i.predictions||[]}},[e]),l="ML model predictions for individual entity states. Each card shows what the model expects and how confident it is.";return a&&!e?t("div",{class:"space-y-6"},t("div",null,t("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Predictions"),t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},l)),t(Pe,{type:"cards"})):r?t("div",{class:"space-y-6"},t("div",null,t("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Predictions"),t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},l)),t(we,{error:r,onRetry:n})):t("div",{class:"space-y-6 animate-page-enter"},t(ve,{page:"PREDICTIONS",subtitle:"ML model outputs with confidence scores."}),t(ze,{value:o.length,label:"predictions",delta:o.length>0?`${o.filter(i=>(i.confidence??0)>=.7).length} high confidence`:null,loading:a}),s&&t("div",{class:"flex flex-wrap gap-3 text-sm",style:"color: var(--text-tertiary)"},s.model_version&&t("span",{style:"background: var(--bg-surface-raised); border-radius: var(--radius); padding: 0.25rem 0.5rem;"},"v",s.model_version),s.features_used!=null&&t("span",{style:"background: var(--bg-surface-raised); border-radius: var(--radius); padding: 0.25rem 0.5rem;"},s.features_used," features"),s.generated_at&&t("span",{style:"background: var(--bg-surface-raised); border-radius: var(--radius); padding: 0.25rem 0.5rem;"},"Generated: ",new Date(s.generated_at).toLocaleString())),o.length===0?t("div",{class:"t-callout",style:"padding: 0.75rem;"},t("span",{class:"text-sm",style:"color: var(--text-secondary)"},"No entity-level predictions yet. The ML engine trains models after 14+ days of data, then predicts individual entity states. Until then, aggregate predictions are available on the Intelligence page.")):t("div",{class:"grid grid-cols-1 lg:grid-cols-2 gap-4 stagger-children"},o.map((i,u)=>t(Mv,{key:i.entity_id||u,prediction:i}))))}function Ev(e){switch((e||"").toLowerCase()){case"temporal":return"background: var(--accent-glow); color: var(--accent);";case"correlation":return"background: var(--accent-purple-glow); color: var(--accent-purple);";case"sequence":return"background: var(--status-warning-glow); color: var(--status-warning);";case"anomaly":return"background: var(--status-error-glow); color: var(--status-error);";default:return"background: var(--bg-surface-raised); color: var(--text-secondary);"}}function Pv({pattern:e}){let[a,r]=N(!1),n=e.confidence??0,s=Math.round(n*100),o=e.entities||[];return t("div",{class:"t-frame","data-label":e.name||"pattern",style:"padding: 1.25rem;"},t("div",{class:"flex items-center justify-between mb-2"},t("h3",{class:"text-base font-bold",style:"color: var(--text-primary)"},e.name||"Unnamed pattern"),e.type&&t("span",{class:"inline-block px-2 py-0.5 rounded-full text-xs font-medium",style:Ev(e.type)},e.type)),e.description&&t("p",{class:"text-sm mb-3",style:"color: var(--text-secondary)"},e.description),t("div",{class:"grid grid-cols-2 gap-x-6 gap-y-2 text-sm mb-3"},e.frequency&&t("div",null,t("span",{style:"color: var(--text-tertiary)"},"Frequency"),t("div",{class:"font-medium",style:"color: var(--text-secondary)"},e.frequency)),o.length>0&&t("div",null,t("span",{style:"color: var(--text-tertiary)"},"Entities"),t("div",{class:"font-medium",style:"color: var(--text-secondary)"},o.length)),t("div",null,t("span",{style:"color: var(--text-tertiary)"},"Confidence"),t("div",{class:"font-medium",style:"color: var(--text-secondary)"},s,"%")),e.time_window&&t("div",null,t("span",{style:"color: var(--text-tertiary)"},"Time window"),t("div",{class:"font-medium",style:"color: var(--text-secondary)"},e.time_window)),e.support!=null&&t("div",null,t("span",{style:"color: var(--text-tertiary)"},"Support"),t("div",{class:"font-medium",style:"color: var(--text-secondary)"},Math.round(e.support*100),"%"))),o.length>0&&t("div",{class:"flex flex-wrap gap-1 mb-3"},o.map(l=>t("span",{key:l,class:"inline-block px-1.5 py-0.5 text-xs data-mono",style:"background: var(--bg-surface-raised); border-radius: var(--radius); color: var(--text-secondary)"},l))),e.raw_data&&t("div",null,t("button",{onClick:()=>r(!a),class:"text-sm cursor-pointer",style:"color: var(--accent)"},a?"Hide raw data":"Show raw data"),a&&t("pre",{class:"mt-2 p-3 text-xs overflow-x-auto",style:"background: var(--bg-inset); color: var(--text-primary); border-radius: var(--radius); font-family: var(--font-mono)"},JSON.stringify(e.raw_data,null,2))))}function Oo(){let{data:e,loading:a,error:r,refetch:n}=We("patterns"),{metadata:s,patterns:o}=pe(()=>{if(!e||!e.data)return{metadata:null,patterns:[]};let i=e.data;return{metadata:i.metadata||null,patterns:i.patterns||[]}},[e]),l="Recurring behaviors the system has found \u2014 things that happen at the same time, in the same sequence, or that correlate with each other.";return a&&!e?t("div",{class:"space-y-6"},t("div",null,t("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Patterns"),t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},l)),t(Pe,{type:"cards"})):r?t("div",{class:"space-y-6"},t("div",null,t("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Patterns"),t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},l)),t(we,{error:r,onRetry:n})):t("div",{class:"space-y-6 animate-page-enter"},t(ve,{page:"PATTERNS",subtitle:"Recurring event sequences from your logbook."}),t(ze,{value:o.length,label:"patterns detected",loading:a}),s&&t("div",{class:"flex flex-wrap gap-3 text-sm",style:"color: var(--text-tertiary)"},s.time_range&&t("span",{style:"background: var(--bg-surface-raised); border-radius: var(--radius); padding: 0.25rem 0.5rem;"},"Range: ",s.time_range),s.pattern_count!=null&&t("span",{style:"background: var(--bg-surface-raised); border-radius: var(--radius); padding: 0.25rem 0.5rem;"},s.pattern_count," patterns"),s.analyzed_at&&t("span",{style:"background: var(--bg-surface-raised); border-radius: var(--radius); padding: 0.25rem 0.5rem;"},"Analyzed: ",new Date(s.analyzed_at).toLocaleString())),o.length===0?t("div",{class:"t-callout",style:"padding: 0.75rem;"},t("span",{class:"text-sm",style:"color: var(--text-secondary)"},"No patterns detected yet. The pattern recognition module analyzes HA logbook sequences to find temporal, correlation, and sequence patterns. It needs several days of logbook data with meaningful device events to identify reliable patterns.")):t("div",{class:"space-y-4 stagger-children"},o.map((i,u)=>t(Pv,{key:i.name||u,pattern:i}))))}function Lv(e){switch((e||"").toLowerCase()){case"approved":return"background: var(--status-healthy-glow); color: var(--status-healthy);";case"rejected":return"background: var(--status-error-glow); color: var(--status-error);";default:return"background: var(--status-warning-glow); color: var(--status-warning);"}}function Ho({obj:e}){return e?typeof e=="string"?t("span",{class:"text-sm",style:"color: var(--text-secondary)"},e):t("dl",{class:"text-xs space-y-0.5",style:"color: var(--text-secondary)"},Object.entries(e).map(([a,r])=>t("div",{key:a,class:"flex gap-2"},t("dt",{class:"min-w-[80px]",style:"color: var(--text-tertiary)"},a,":"),t("dd",{class:"break-all",style:"color: var(--text-secondary)"},typeof r=="object"?JSON.stringify(r):String(r))))):null}function $v({suggestion:e,onStatusChange:a,updating:r}){let n=e.confidence??0,s=Math.round(n*100),o=(e.status||"pending").toLowerCase(),l=o==="approved"?"border-left: 4px solid var(--status-healthy);":o==="rejected"?"border-left: 4px solid var(--status-error); opacity: 0.6;":"";return t("div",{class:"t-frame","data-label":e.name||e.trigger||"suggestion",style:`padding: 1.25rem; ${l}`},t("div",{class:"flex items-center justify-between mb-2"},t("h3",{class:"text-base font-bold",style:"color: var(--text-primary)"},e.name||"Unnamed automation"),t("span",{class:"inline-block px-2 py-0.5 rounded-full text-xs font-medium",style:Lv(o)},o)),e.description&&t("p",{class:"text-sm mb-3",style:"color: var(--text-secondary)"},e.description),t("div",{class:"mb-4"},t("div",{class:"flex items-center justify-between text-xs mb-1",style:"color: var(--text-tertiary)"},t("span",null,"Confidence"),t("span",null,s,"%")),t("div",{class:"h-2 rounded-full",style:"background: var(--bg-inset)"},t("div",{class:"h-2 rounded-full transition-all",style:`background: var(--accent); width: ${s}%`}))),e.trigger&&t("div",{class:"mb-3"},t("h4",{class:"text-xs font-semibold uppercase tracking-wide mb-1",style:"color: var(--text-tertiary)"},"Trigger"),t(Ho,{obj:e.trigger})),e.conditions&&e.conditions.length>0&&t("div",{class:"mb-3"},t("h4",{class:"text-xs font-semibold uppercase tracking-wide mb-1",style:"color: var(--text-tertiary)"},"Conditions"),t("div",{class:"space-y-1"},e.conditions.map((i,u)=>t(Ho,{key:u,obj:i})))),e.actions&&e.actions.length>0&&t("div",{class:"mb-3"},t("h4",{class:"text-xs font-semibold uppercase tracking-wide mb-1",style:"color: var(--text-tertiary)"},"Actions"),t("div",{class:"space-y-1"},e.actions.map((i,u)=>t(Ho,{key:u,obj:i})))),e.yaml&&t("details",{class:"mb-3"},t("summary",{class:"text-sm cursor-pointer",style:"color: var(--accent)"},"Show YAML"),t("pre",{class:"mt-2 p-3 text-xs overflow-x-auto",style:"background: var(--bg-inset); color: var(--text-primary); border-radius: var(--radius); font-family: var(--font-mono)"},e.yaml)),o==="pending"&&t("div",{class:"flex gap-2 mt-4"},t("button",{onClick:()=>a(e.id,"approved"),disabled:r,class:"t-btn px-4 py-1.5 text-sm font-medium disabled:opacity-50 transition-colors",style:"background: var(--status-healthy); color: var(--text-inverse); border: none;"},"Approve"),t("button",{onClick:()=>a(e.id,"rejected"),disabled:r,class:"t-btn px-4 py-1.5 text-sm font-medium disabled:opacity-50 transition-colors",style:"background: var(--status-error); color: var(--text-inverse); border: none;"},"Reject")))}function zo(){let{data:e,loading:a,error:r,refetch:n}=We("automation_suggestions"),[s,o]=N(!1),[l,i]=N(null),[u,d]=N({}),{metadata:g,suggestions:f}=pe(()=>{if(!e||!e.data)return{metadata:null,suggestions:[]};let C=e.data;return{metadata:C.metadata||null,suggestions:C.suggestions||[]}},[e]),m=pe(()=>f.map(C=>u[C.id]?{...C,status:u[C.id]}:C),[f,u]);async function b(C,A){o(!0),i(null),d(M=>({...M,[C]:A}));try{let M=f.map(k=>k.id===C?{...k,status:A}:k),_={...e.data||{},suggestions:M},S=await fetch(`${pa}/api/cache/automation_suggestions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:_})});if(!S.ok)throw new Error(`HTTP ${S.status}: ${S.statusText}`);d(k=>{let O={...k};return delete O[C],O}),n()}catch(M){d(_=>{let S={..._};return delete S[C],S}),i(M.message||String(M))}finally{o(!1)}}let h="Automation ideas generated from discovered patterns. Review, approve, or reject \u2014 approved automations can be exported to HA.";return a&&!e?t("div",{class:"space-y-6"},t("div",null,t("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Automations"),t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},h)),t(Pe,{type:"cards"})):r?t("div",{class:"space-y-6"},t("div",null,t("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Automations"),t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},h)),t(we,{error:r,onRetry:n})):t("div",{class:"space-y-6 animate-page-enter"},t(ve,{page:"AUTOMATIONS",subtitle:"LLM-suggested Home Assistant automation YAML."}),t(ze,{value:m.length,label:"automation suggestions",loading:a}),g&&t("div",{class:"flex flex-wrap gap-3 text-sm",style:"color: var(--text-tertiary)"},g.total_suggestions!=null&&t("span",{style:"background: var(--bg-surface-raised); border-radius: var(--radius); padding: 0.25rem 0.5rem;"},g.total_suggestions," suggestions"),g.model&&t("span",{style:"background: var(--bg-surface-raised); border-radius: var(--radius); padding: 0.25rem 0.5rem;"},"Model: ",g.model),g.generated_at&&t("span",{style:"background: var(--bg-surface-raised); border-radius: var(--radius); padding: 0.25rem 0.5rem;"},"Generated: ",new Date(g.generated_at).toLocaleString())),l&&t(we,{error:l,onRetry:()=>i(null)}),m.length===0?t("div",{class:"t-callout",style:"padding: 0.75rem;"},t("span",{class:"text-sm",style:"color: var(--text-secondary)"},"No automation suggestions yet. The orchestrator generates suggestions when it finds patterns with high enough confidence and matching capabilities. This requires the pattern recognition and discovery modules to have populated data first.")):t("div",{class:"grid grid-cols-1 lg:grid-cols-2 gap-4 stagger-children"},m.map((C,A)=>t($v,{key:C.id||A,suggestion:C,onStatusChange:b,updating:s}))))}function gd(e){return e==="high"?"background: var(--status-healthy-glow); color: var(--status-healthy);":e==="medium"?"background: var(--status-warning-glow); color: var(--status-warning);":"background: var(--status-error-glow); color: var(--status-error);"}function Qt(e){if(!e)return"\u2014";let a=Date.now()-new Date(e).getTime(),r=Math.floor(a/6e4);if(r<1)return"just now";if(r<60)return`${r}m ago`;let n=Math.floor(r/60);return n<24?`${n}h ago`:`${Math.floor(n/24)}d ago`}function Fo(e){if(!e)return"";let a=Date.now()-new Date(e).getTime(),r=Math.floor(a/6e4);if(r<60)return`${r}m`;let n=Math.floor(r/60),s=r%60;return s>0?`${n}h ${s}m`:`${n}h`}function oe({title:e,subtitle:a,summary:r,defaultOpen:n=!0,loading:s,children:o}){return t(vt,{title:e,subtitle:a,summary:r,defaultOpen:n,loading:s},o)}function Ce({children:e}){return t("div",{class:"t-callout p-3 text-sm"},e)}var Fa={light:"Lights",switch:"Switches",binary_sensor:"Sensors",lock:"Locks",media_player:"Media",cover:"Covers",climate:"Climate",vacuum:"Vacuum",person:"People",device_tracker:"Trackers",fan:"Fans",sensor:"Power"},xd={arrive:"\u25B6",depart:"\u25C0",person:"\u25CF",unlock:"\u25CB",lock:"\u25CF",motion:"\u25B8",clear:"\xB7",door:"\u25A0",window:"\u25A1",light_on:"\u25CF",light_off:"\xB7",switch:"\u25C6",sensor:"\u25B8",media:"\u25B6",climate:"\u223F",cover:"\u25A1",default:"\xB7"};function bd(e){let a=e.friendly_name||e.entity||"?",r=e.domain||"",n=e.device_class||"",s=e.to||"",o=e.from||"";return r==="person"||r==="device_tracker"?s==="home"?{text:`${a} arrived home`,icon:"arrive"}:o==="home"?{text:`${a} left`,icon:"depart"}:{text:`${a}: ${s}`,icon:"person"}:r==="lock"?s==="unlocked"?{text:`${a} unlocked`,icon:"unlock"}:s==="locked"?{text:`${a} locked`,icon:"lock"}:{text:`${a}: ${s}`,icon:"lock"}:r==="binary_sensor"?n==="motion"?s==="on"?{text:`Motion in ${a}`,icon:"motion"}:{text:`${a} cleared`,icon:"clear"}:n==="door"?s==="on"?{text:`${a} opened`,icon:"door"}:{text:`${a} closed`,icon:"door"}:n==="window"?s==="on"?{text:`${a} opened`,icon:"window"}:{text:`${a} closed`,icon:"window"}:n==="occupancy"?s==="on"?{text:`${a} occupied`,icon:"motion"}:{text:`${a} clear`,icon:"clear"}:s==="on"?{text:`${a} active`,icon:"sensor"}:{text:`${a} inactive`,icon:"clear"}:r==="light"?s==="on"?{text:`${a} on`,icon:"light_on"}:{text:`${a} off`,icon:"light_off"}:r==="switch"?s==="on"?{text:`${a} on`,icon:"switch"}:{text:`${a} off`,icon:"switch"}:r==="media_player"?s==="playing"?{text:`${a} playing`,icon:"media"}:s==="paused"?{text:`${a} paused`,icon:"media"}:s==="idle"||s==="off"?{text:`${a} stopped`,icon:"media"}:{text:`${a}: ${s}`,icon:"media"}:r==="climate"?{text:`${a} set to ${s}`,icon:"climate"}:r==="cover"?s==="open"?{text:`${a} opened`,icon:"cover"}:s==="closed"?{text:`${a} closed`,icon:"cover"}:{text:`${a}: ${s}`,icon:"cover"}:{text:`${a}: ${o} \u2192 ${s}`,icon:"default"}}function hd({maturity:e,shadowStage:a,shadowAccuracy:r}){if(!e)return null;let n=Ro.indexOf(e.phase),s=Math.max((n+1)/Ro.length*100,10),o=n<2?'The system needs enough data to tell the difference between "normal Tuesday" and "something unusual." More days = better predictions.':"The system has enough data to predict your home's behavior and flag anomalies.";return t(oe,{title:"Learning Progress",summary:e.phase},t("div",{class:"t-frame p-4 space-y-4","data-label":"learning"},t("div",null,t("div",{class:"flex justify-between text-xs mb-1",style:"color: var(--text-tertiary)"},yd.map((l,i)=>{let u=i<n?"color: var(--status-healthy)":i===n?"color: var(--accent); font-weight: 700":"";return t("span",{key:l,style:u},l)})),t("div",{class:"h-3 rounded-full",style:"background: var(--bg-inset)"},t("div",{class:"h-3 rounded-full transition-all",style:`background: var(--accent); width: ${s}%`}))),t("p",{class:"text-sm",style:"color: var(--text-secondary)"},e.description),t("p",{class:"text-xs italic",style:"color: var(--text-tertiary)"},o),t("div",{class:"flex flex-wrap gap-3 text-sm"},t("span",{class:"rounded px-2 py-1",style:"background: var(--bg-surface-raised)"},e.days_of_data," day",e.days_of_data!==1?"s":""," of data"),t("span",{class:"rounded px-2 py-1",style:"background: var(--bg-surface-raised)"},e.intraday_count," intraday snapshot",e.intraday_count!==1?"s":""),e.first_date&&t("span",{class:"rounded px-2 py-1",style:"background: var(--bg-surface-raised)"},"Since ",e.first_date)),e.next_milestone&&e.phase!=="ml-active"&&t("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"Next: ",e.next_milestone),a&&t("div",{class:"flex items-center gap-2 text-xs pt-1",style:"color: var(--text-tertiary); border-top: 1px solid var(--border-subtle)"},t("span",{class:"font-medium rounded-full px-2 py-0.5 capitalize",style:"background: var(--accent-glow); color: var(--accent)"},a),t("span",null,"Shadow engine",r!=null?` \u2014 ${Math.round(r*100)}% accuracy`:""))))}function wd({intraday:e,baselines:a}){if(!e||e.length===0)return null;let r=e[e.length-1],n=new Date().toLocaleDateString("en-US",{weekday:"long"}),s=a&&a[n];function o(u,d){if(d==null||!s||!s[u])return null;let g=s[u].mean;if(g==null)return null;let f=d-g,m=g>0?Math.round(f/g*100):0;return Math.abs(m)<10?{text:"typical",style:"color: var(--text-tertiary)"}:m>0?{text:`+${m}% vs ${n}`,style:"color: var(--status-warning)"}:{text:`${m}% vs ${n}`,style:"color: var(--accent)"}}let l=[{label:"Power (W)",value:r.power_watts!=null?r.power_watts:"\u2014",note:o("power_watts",r.power_watts)},{label:"Lights On",value:r.lights_on!=null?r.lights_on:"\u2014",note:o("lights_on",r.lights_on)},{label:"Devices Home",value:r.devices_home!=null?r.devices_home:"\u2014"},{label:"Unavailable",value:r.unavailable!=null?r.unavailable:"\u2014",warning:(r.unavailable||0)>100,note:(r.unavailable||0)>100?{text:"High \u2014 check devices",style:"color: var(--status-warning)"}:null}],i=s?`Latest snapshot compared to your typical ${n}. Updated every 4 hours (more often when home is active).`:"Latest snapshot of your home. Comparisons to baseline will appear after 7 days of data.";return t(oe,{title:"Home Right Now",subtitle:i,summary:l.length+" metrics"},t("div",{class:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-4"},l.map((u,d)=>t("div",{key:d,class:"t-frame p-4","data-label":u.label,style:u.warning?"border: 2px solid var(--status-warning)":""},t("div",{class:"text-2xl font-bold",style:u.warning?"color: var(--status-warning)":"color: var(--accent)"},u.value),t("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},u.label),u.note&&t("div",{class:"text-xs mt-1",style:u.note.style},u.note.text)))))}var kd={light:"var(--accent-warm)",switch:"var(--accent)",binary_sensor:"var(--accent-purple)",person:"var(--status-healthy)",device_tracker:"var(--status-healthy)"};function Dv({events:e}){if(!e||e.length===0)return null;let a=new Date,r=new Date(a-md),n=e.map(d=>{let[g,f]=(d.time||"").split(":").map(Number),m=new Date;return m.setHours(g,f,0,0),m>a&&m.setDate(m.getDate()-1),{...d,_date:m}}).filter(d=>d._date>=r&&d._date<=a);if(n.length===0)return null;let s={};n.forEach(d=>{let g=d.domain||"unknown";s[g]||(s[g]=[]),s[g].push(d)});let o=Object.keys(s);if(o.length===0)return null;let l=a-r,i=r.toTimeString().slice(0,5),u=a.toTimeString().slice(0,5);return t("div",{class:"t-frame p-4","data-label":"swim lanes"},t("p",{class:"text-xs mb-2",style:"color: var(--text-tertiary)"},"What happened in the last hour, organized by device type. Each dot is one state change. Hover a dot to see which device changed."),t("div",{style:"display: grid; grid-template-columns: 60px 1fr; gap: 0;"},o.map(d=>t("div",{key:d,style:"display: contents;"},t("div",{style:"height: 20px; margin-bottom: 2px; display: flex; align-items: center; font-size: 10px; color: var(--text-tertiary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"},Fa[d]||d),t("div",{style:"height: 20px; margin-bottom: 2px; position: relative; background: var(--bg-inset); border-radius: 2px;"},s[d].map((g,f)=>{let m=(g._date-r)/l*100,b=kd[d]||"var(--text-tertiary)";return t("div",{key:f,title:`${g.friendly_name||g.entity} \u2014 ${g.state} at ${g.time}`,style:{position:"absolute",left:`${m}%`,top:"6px",width:"8px",height:"8px",borderRadius:"50%",backgroundColor:b,transform:"translateX(-4px)"}})}),t("div",{style:"position: absolute; right: 0; top: 0; bottom: 0; border-right: 2px dashed var(--text-tertiary); opacity: 0.5;"})))),t("div",{style:"height: 14px;"}),t("div",{style:"height: 14px; position: relative; display: flex; justify-content: space-between; font-size: 10px; color: var(--text-tertiary);"},t("span",null,i),t("span",null,"now"))),t("div",{class:"flex flex-wrap items-center gap-3 mt-2 pt-2",style:"border-top: 1px solid var(--border-subtle); font-size: 10px; color: var(--text-tertiary);"},o.map(d=>t("div",{key:d,class:"flex items-center gap-1"},t("span",{style:`display: inline-block; width: 8px; height: 8px; border-radius: 50%; background: ${kd[d]||"var(--text-tertiary)"};`}),t("span",null,Fa[d]||d))),t("div",{class:"flex items-center gap-1"},t("span",{style:"display: inline-block; width: 1px; height: 10px; border-left: 2px dashed var(--text-tertiary); opacity: 0.5;"}),t("span",null,"Now"))))}function Iv({windows:e}){if(!e||e.length===0)return null;let a=new Date,r=new Date(a-vd).toISOString(),n=e.filter(u=>u.window_start>=r);if(n.length===0)return null;let s=Math.max(...n.map(u=>u.event_count),1),o=n.reduce((u,d)=>u+d.event_count,0),l=n.filter(u=>u.occupancy).length,i=n.length>0?Math.round(l/n.length*100):0;return t("div",{class:"space-y-2"},t("div",{class:"flex justify-between items-baseline"},t("div",{class:"text-xs font-medium",style:"color: var(--text-secondary)"},"Activity Timeline (6h)"),t("div",{class:"text-xs",style:"color: var(--text-tertiary)"},o," events, home ",i,"% of the time")),t("div",{class:"flex items-end gap-0.5 h-16"},n.map((u,d)=>{let g=Math.max(u.event_count/s*100,4),f=u.occupancy?"var(--accent-purple)":"var(--text-tertiary)",m=u.window_start.slice(11,16);return t("div",{key:d,class:"flex-1 rounded-t transition-all",style:{height:`${g}%`,backgroundColor:f,minWidth:"3px"},title:`${m} \u2014 ${u.event_count} events${u.occupancy?"":" (away)"}`})})),t("div",{class:"flex justify-between",style:"font-size: 10px; color: var(--text-tertiary)"},t("span",null,n[0]?.window_start?.slice(11,16)),t("div",{class:"flex items-center gap-2"},t("span",{class:"inline-block w-2 h-2 rounded-sm",style:{backgroundColor:"var(--accent-purple)"}})," home",t("span",{class:"inline-block w-2 h-2 rounded-sm",style:"background: var(--text-tertiary)"})," away"),n.length>1&&t("span",null,n[n.length-1]?.window_start?.slice(11,16))))}function Rv({ws:e}){if(!e)return null;let a=e.connected;return t("div",{class:"flex items-center gap-2 text-xs"},t("span",{class:"inline-block w-2.5 h-2.5 rounded-full",style:`background: ${a?"var(--status-healthy)":"var(--status-error)"}`}),t("span",{style:`color: ${a?"var(--status-healthy)":"var(--status-error)"}`},a?"Connected":"Disconnected"),e.disconnect_count>0&&t("span",{style:"color: var(--text-tertiary)"},"(",e.disconnect_count," reconnect",e.disconnect_count!==1?"s":"",")"),e.total_disconnect_s>0&&t("span",{style:"color: var(--text-tertiary)"},Math.round(e.total_disconnect_s),"s downtime"))}function Sd({activity:e}){if(!e)return t(oe,{title:"Activity Monitor",subtitle:"Waiting for WebSocket to connect to Home Assistant..."},t(Ce,null,"Activity monitoring is starting up. State changes will appear here once the WebSocket connection is established."));let a=e.activity_summary,r=e.activity_log;if(!a&&!r)return t(oe,{title:"Activity Monitor",subtitle:"Waiting for first events..."},t(Ce,null,"Activity monitoring is starting up. State changes will appear here once the WebSocket connection is established."));let n=a?.occupancy||{},s=a?.activity_rate||{},o=a?.snapshot_status||{},l=a?.domains_active_1h||{},i=a?.recent_activity||[],u=r?.windows||[],d=a?.websocket||{},g=a?.event_predictions||{},f=a?.patterns||[],m=a?.occupancy_prediction||{},b=a?.anomalies||[],h=[];if(n.anyone_home){let _=Fo(n.since),S=(n.people||[]).join(" & ")||"Someone";h.push(_?`${S} home for ${_}`:`${S} home`)}else h.push("Nobody home");s.trend==="increasing"?h.push("activity picking up"):s.trend==="decreasing"&&h.push("quieting down");let C=r?.events_today;C!=null&&h.push(`${C} events today`);let A=h.join(" \xB7 "),M="";return o.today_count>0?M=`${o.today_count} adaptive snapshot${o.today_count!==1?"s":""} captured today \u2014 the system saw enough activity to grab extra data points.`:n.anyone_home?M="Watching for sustained activity to trigger an adaptive snapshot. Cooldown and event thresholds are configurable in Settings.":M="Adaptive snapshots only trigger when someone is home.",t(oe,{title:"Activity Monitor",subtitle:A,summary:n.anyone_home?"Home":"Away"},t("div",{class:"space-y-4"},t("div",{class:"flex items-center justify-between"},t(Rv,{ws:d}),g.predicted_next_domain&&t("div",{class:"text-xs",style:"color: var(--text-tertiary)"},"Next likely: ",t("span",{class:"font-medium",style:"color: var(--text-secondary)"},Fa[g.predicted_next_domain]||g.predicted_next_domain)," ","(",Math.round(g.probability*100),"%)")),b.length>0&&b.map((_,S)=>t(Ce,{key:S},_.message)),t("div",{class:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-4"},t("div",{class:"t-frame p-4",style:`border-left: 4px solid ${n.anyone_home?"var(--status-healthy)":"var(--border-subtle)"}`},t("div",{class:"text-2xl font-bold",style:`color: ${n.anyone_home?"var(--status-healthy)":"var(--text-tertiary)"}`},n.anyone_home?"Home":"Away"),t("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},"Occupancy"),n.anyone_home&&n.since&&t("div",{class:"text-xs mt-1",style:"color: var(--text-tertiary)"},"for ",Fo(n.since)),!n.anyone_home&&m.predicted_arrival&&m.status==="predicted"&&t("div",{class:"text-xs mt-1",style:"color: var(--accent)"},"ETA ~",m.predicted_arrival,t("span",{style:"color: var(--text-tertiary)"}," (",m.confidence,", ",m.based_on," samples)")),!n.anyone_home&&m.status==="past_predicted"&&t("div",{class:"text-xs mt-1",style:"color: var(--text-tertiary)"},"Typical arrival (",m.predicted_arrival,") passed")),t("div",{class:"t-frame p-4"},t("div",{class:"text-2xl font-bold",style:"color: var(--accent)"},s.current!=null?s.current:"\u2014"),t("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},"Events (15m window)"),s.avg_1h>0&&t("div",{class:"text-xs mt-1",style:`color: ${s.trend==="increasing"?"var(--status-warning)":s.trend==="decreasing"?"var(--accent)":"var(--text-tertiary)"}`},s.trend==="increasing"?"Above":s.trend==="decreasing"?"Below":"Near"," avg (",s.avg_1h,"/window)")),t("div",{class:"t-frame p-4"},t("div",{class:"text-2xl font-bold",style:"color: var(--accent)"},C??"\u2014"),t("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},"Events Today")),t("div",{class:"t-frame p-4"},t("div",{class:"text-2xl font-bold",style:"color: var(--accent)"},o.today_count!=null?`${o.today_count}/${o.daily_cap}`:"\u2014"),t("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},"Adaptive Snapshots"),o.cooldown_remaining_s>0&&t("div",{class:"text-xs mt-1",style:"color: var(--text-tertiary)"},"Next eligible in ",Math.ceil(o.cooldown_remaining_s/60),"m"))),t("div",{class:"text-xs italic px-1",style:"color: var(--text-tertiary)"},M),t("div",{class:"grid grid-cols-1 sm:grid-cols-1 lg:grid-cols-3 gap-4"},t("div",{class:"lg:col-span-2 t-frame p-4","data-label":"recent"},t("div",{class:"text-xs font-bold uppercase mb-2",style:"color: var(--text-tertiary)"},"What Just Happened"),t(Dv,{events:i}),i.length===0?t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Waiting for state changes..."):t("div",{class:"sr-only space-y-0.5 max-h-64 overflow-y-auto"},i.map((_,S)=>{let k=bd(_),O=xd[k.icon]||"\xB7",L=["lock","person","device_tracker"].includes(_.domain)||_.domain==="binary_sensor"&&["door","window"].includes(_.device_class),H=`${_.entity||_.friendly_name}-${_.time}-${S}`;return t("div",{key:H,class:"flex items-center gap-2 py-1 px-1 rounded",style:L?"background: var(--status-warning-glow)":""},t("span",{class:"w-5 text-center text-sm flex-shrink-0"},O),t("span",{class:`flex-1 text-sm ${L?"font-medium":""}`,style:`color: ${L?"var(--text-primary)":"var(--text-secondary)"}`},k.text),t("span",{class:"text-xs flex-shrink-0",style:"color: var(--text-tertiary)"},_.time))}))),t("div",{class:"t-frame p-4","data-label":"domains"},t("div",{class:"text-xs font-bold uppercase mb-2",style:"color: var(--text-tertiary)"},"Active Domains (1h)"),Object.keys(l).length===0?t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"No activity yet."):t("div",{class:"space-y-2"},(()=>{let _=Math.max(...Object.values(l),1);return Object.entries(l).map(([S,k])=>{let O=Fa[S]||S,L=k/_*100;return t("div",{key:S,class:"space-y-0.5"},t("div",{class:"flex justify-between text-xs"},t("span",{style:"color: var(--text-secondary)"},O),t("span",{style:"color: var(--text-tertiary)"},k)),t("div",{class:"h-1.5 rounded-full",style:"background: var(--bg-inset)"},t("div",{class:"h-1.5 rounded-full",style:`background: var(--accent-dim); width: ${L}%`})))})})()))),f.length>0&&t("div",{class:"t-frame p-4","data-label":"patterns"},t("div",{class:"text-xs font-bold uppercase mb-2",style:"color: var(--text-tertiary)"},"Detected Patterns (24h)"),t("p",{class:"text-xs mb-2",style:"color: var(--text-tertiary)"},"Recurring event sequences that suggest routines or automations."),t("div",{class:"space-y-1.5"},f.map((_,S)=>t("div",{key:S,class:"flex items-center gap-2 text-sm"},t("div",{class:"flex items-center gap-1"},_.sequence.map((k,O)=>t("span",{key:O},t("span",{class:"rounded px-1.5 py-0.5 text-xs font-medium",style:"background: var(--accent-glow); color: var(--accent)"},Fa[k]||k),O<_.sequence.length-1&&t("span",{class:"mx-0.5",style:"color: var(--text-tertiary)"},"\u2192")))),t("span",{class:"text-xs ml-auto flex-shrink-0",style:"color: var(--text-tertiary)"},_.count,"x",_.last_seen?`, last ${_.last_seen.slice(11,16)||_.last_seen}`:""))))),t("div",{class:"t-frame p-4","data-label":"timeline"},t(Iv,{windows:u}),u.length===0&&t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Timeline will appear after the first 15-minute window.")),o.log_today&&o.log_today.length>0&&t("details",{class:"t-frame"},t("summary",{class:"px-4 py-3 cursor-pointer text-sm font-medium",style:"color: var(--text-secondary)"},"Snapshot Log \\u2014 ",o.log_today.length," adaptive snapshot",o.log_today.length!==1?"s":""," today"),t("div",{class:"overflow-x-auto"},t("table",{class:"w-full text-sm"},t("thead",null,t("tr",{class:"text-left text-xs",style:"border-bottom: 1px solid var(--border-subtle); color: var(--text-tertiary)"},t("th",{class:"px-4 py-1"},"#"),t("th",{class:"px-4 py-1"},"Time"),t("th",{class:"px-4 py-1"},"Events"),t("th",{class:"px-4 py-1"},"People"),t("th",{class:"px-4 py-1"},"What Triggered It"))),t("tbody",null,o.log_today.map((_,S)=>t("tr",{key:S,style:"border-bottom: 1px solid var(--border-subtle)"},t("td",{class:"px-4 py-1.5",style:"color: var(--text-tertiary)"},_.number),t("td",{class:"px-4 py-1.5",style:"color: var(--text-secondary)"},_.timestamp?.slice(11,16)),t("td",{class:"px-4 py-1.5"},_.buffered_events," buffered"),t("td",{class:"px-4 py-1.5",style:"color: var(--text-secondary)"},(_.people||[]).join(", ")||"\u2014"),t("td",{class:"px-4 py-1.5"},t("div",{class:"flex flex-wrap gap-1"},Object.entries(_.domains||{}).slice(0,4).map(([k,O])=>t("span",{key:k,class:"rounded px-1.5 py-0.5 text-xs",style:"background: var(--bg-surface-raised)"},Fa[k]||k,": ",O))))))))))))}function Qr(e,a,r){let n=e.map(o=>{if(a==="date")return Math.floor(new Date(o.date).getTime()/1e3);{let l=new Date;return Math.floor(new Date(l.getFullYear(),l.getMonth(),l.getDate(),o.hour).getTime()/1e3)}}),s=e.map(o=>o[r]??null);return[n,s]}function Xr({label:e,data:a,color:r,height:n=80}){return t("div",null,t("div",{class:"text-xs font-bold uppercase",style:{color:"var(--text-tertiary)"}},e),t(Ha,{data:a,series:[{label:e,color:r}],height:n}))}function Ad({trendData:e,intradayTrend:a}){let r=e&&e.length>0,n=a&&a.length>0;if(!r&&!n)return t(oe,{title:"Trends Over Time",subtitle:"Spot when something changed \u2014 a new device, a routine shift, or a problem building."},t(Ce,null,"No trend data yet. Daily snapshots are collected each night at 11:30 PM."));let s=null;if(r&&e.length>=2){let o=e[e.length-1],l=e[e.length-2],i=[];if(o.power_watts!=null&&l.power_watts!=null){let u=o.power_watts-l.power_watts;Math.abs(u)>50&&i.push(`Power ${u>0?"up":"down"} ${Math.abs(Math.round(u))}W vs yesterday`)}if(o.unavailable!=null&&l.unavailable!=null){let u=o.unavailable-l.unavailable;u>10&&i.push(`${u} more entities unavailable than yesterday \u2014 check your network`)}i.length>0&&(s=i.join(". ")+".")}return t(oe,{title:"Trends Over Time",subtitle:"Spot when something changed \u2014 a new device, a routine shift, or a problem building."},s&&t(Ce,null,s),t("p",{class:"text-xs",style:{color:"var(--text-secondary)",marginBottom:"0.75rem"}},"Each chart tracks one measurement over time. Power is your home's total electricity usage. Lights is how many are on. Unavailable means devices that stopped reporting \u2014 a spike usually means a network issue."),t("div",{class:"t-frame","data-label":"trends"},r&&t("div",{class:"space-y-2"},t("div",{class:"text-xs font-bold uppercase",style:{color:"var(--text-tertiary)"}},"Daily (30d)"),t(Xr,{label:"Power (W)",data:Qr(e,"date","power_watts"),color:"var(--accent)"}),t(Xr,{label:"Lights On",data:Qr(e,"date","lights_on"),color:"var(--accent-warm)"}),t(Xr,{label:"Unavailable",data:Qr(e,"date","unavailable"),color:"var(--status-error)"})),n&&t("div",{class:"space-y-2"},t("div",{class:"text-xs font-bold uppercase",style:{color:"var(--text-tertiary)"}},"Today (Intraday)"),t(Xr,{label:"Power (W)",data:Qr(a,"hour","power_watts"),color:"var(--accent-dim)"}),t(Xr,{label:"Unavailable",data:Qr(a,"hour","unavailable"),color:"var(--status-error)"}))))}function Cd({predictions:e,intradayTrend:a}){if(!e||!e.target_date)return t(oe,{title:"Predictions vs Actuals",subtitle:"Once active, large deltas here mean something unusual is happening \\u2014 worth investigating."},t(Ce,null,'Predictions need at least 7 days of data. The system is still learning what "normal" looks like for each day of the week.'));let r=a&&a.length>0?a[a.length-1]:{},n=["power_watts","lights_on","devices_home","unavailable","useful_events"],s=null;return n.forEach(o=>{let l=e[o]||{},i=r[o];if(i!=null&&l.predicted!=null&&l.predicted>0){let u=Math.abs((i-l.predicted)/l.predicted*100);u>30&&(!s||u>s.pct)&&(s={metric:o.replace(/_/g," "),pct:Math.round(u),actual:i,predicted:l.predicted})}}),t(oe,{title:"Predictions vs Actuals",subtitle:"Large deltas mean something unusual is happening. Small deltas mean the system understands your patterns.",summary:e.target_date},s&&t(Ce,null,s.metric," is ",s.pct,"% off prediction (",s.actual," actual vs ",s.predicted," predicted). Worth a look?"),t("div",{class:"t-frame overflow-x-auto","data-label":"predictions"},t("table",{class:"w-full text-sm"},t("thead",null,t("tr",{class:"text-left text-xs uppercase",style:"border-bottom: 1px solid var(--border-subtle); color: var(--text-tertiary)"},t("th",{class:"px-4 py-2"},"Metric"),t("th",{class:"px-4 py-2"},"Predicted"),t("th",{class:"px-4 py-2"},"Actual"),t("th",{class:"px-4 py-2"},"Delta"),t("th",{class:"px-4 py-2"},"Confidence"))),t("tbody",null,n.map(o=>{let l=e[o]||{},i=r[o],u=i!=null&&l.predicted!=null?Math.round((i-l.predicted)*10)/10:null,d=u!=null&&l.predicted>0&&Math.abs(u/l.predicted)>.3;return t("tr",{key:o,style:`border-bottom: 1px solid var(--border-subtle)${d?"; background: var(--status-warning-glow)":""}`},t("td",{class:"px-4 py-2 font-medium",style:"color: var(--text-secondary)"},o.replace(/_/g," ")),t("td",{class:"px-4 py-2"},l.predicted!=null?l.predicted:"\u2014"),t("td",{class:"px-4 py-2"},i??"\u2014"),t("td",{class:"px-4 py-2"},u!=null?(u>=0?"+":"")+u:"\u2014"),t("td",{class:"px-4 py-2"},t("span",{class:"inline-block px-2 py-0.5 rounded-full text-xs font-medium",style:gd(l.confidence)},l.confidence||"n/a")))})))))}var Td=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Nv={Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat",Sunday:"Sun"},Gn=[{key:"power_watts",label:"Power",unit:"W",color:"var(--accent)",isNegative:!1},{key:"lights_on",label:"Lights",unit:"",color:"var(--accent)",isNegative:!1},{key:"devices_home",label:"Devices",unit:"",color:"var(--accent)",isNegative:!1},{key:"unavailable",label:"Unavail",unit:"",color:"var(--status-error)",isNegative:!0}];function Ov(e){let a={};for(let r of Gn){let n=1/0,s=-1/0;for(let o of Td){let l=e[o];if(!l)continue;let i=l[r.key]?.mean;i!=null&&(i<n&&(n=i),i>s&&(s=i))}a[r.key]={min:n===1/0?0:n,max:s===-1/0?0:s}}return a}function Hv(e,a,r){return r===a?.5:Math.max(0,Math.min(1,(e-a)/(r-a)))}function zv(e,a){return e==null?"\u2014":a.key==="power_watts"?Math.round(e).toLocaleString():Math.round(e).toString()}function Fv({value:e,std:a,metric:r,range:n}){let s=e!=null,o=s?Hv(e,n.min,n.max):0,l=zv(e,r),i=s&&a!=null?`${r.label}: ${l}${r.unit?" "+r.unit:""} \xB1 ${Math.round(a*10)/10}`:r.label;return t("div",{class:"relative flex items-center justify-center rounded",style:"min-height: 2.5rem; min-width: 3.5rem;",title:i},t("div",{class:"absolute inset-0 rounded",style:`background: ${s?r.color:"var(--bg-surface-raised)"}; opacity: ${s?.12+o*.55:.15};`}),t("span",{class:"relative z-10 font-mono",style:"font-size: var(--type-micro); color: var(--text-primary);"},l))}function Md({baselines:e}){if(!e||Object.keys(e).length===0)return t(oe,{title:"Baselines",subtitle:"This is what 'normal' looks like for each day. Deviations from these numbers trigger anomaly detection."},t(Ce,null,"No baselines yet. The first baseline is calculated after the first daily snapshot."));let a=new Date().toLocaleDateString("en-US",{weekday:"long"}),r=Ov(e);return t(oe,{title:"Baselines",subtitle:"This is 'normal' for each day of the week. The system flags deviations from these averages. More samples = tighter predictions.",summary:Object.keys(e).length+" days"},t("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"Each cell shows what's typical for that day and metric. Darker color = higher value. Hover any cell to see the exact number with its margin of error. The 'n' column is how many readings were averaged."),t("div",{class:"t-frame","data-label":"baselines"},t("div",{style:`
            display: grid;
            grid-template-columns: auto repeat(${Gn.length}, 1fr) auto;
            gap: 0.25rem;
            padding: 0.5rem;
          `},t("div",null),Gn.map(n=>t("div",{key:n.key,class:"text-center text-xs uppercase",style:"color: var(--text-tertiary); padding-bottom: 0.25rem;"},n.label)),t("div",{class:"text-center text-xs uppercase",style:"color: var(--text-tertiary); padding-bottom: 0.25rem; padding-left: 0.5rem;"},"n"),Td.map(n=>{let s=e[n],o=n===a;return[t("div",{key:n+"-label",class:"flex items-center text-xs font-medium pr-2",style:`
                  color: ${o?"var(--accent)":"var(--text-secondary)"};
                  ${o?"border-left: 2px solid var(--accent); padding-left: 0.375rem;":"padding-left: calc(2px + 0.375rem);"}
                `},Nv[n]),...Gn.map(l=>t(Fv,{key:n+"-"+l.key,value:s?.[l.key]?.mean,std:s?.[l.key]?.stddev,metric:l,range:r[l.key]})),t("div",{key:n+"-samples",class:"flex items-center justify-center text-xs",style:"color: var(--text-tertiary); padding-left: 0.5rem;"},s?.sample_count??"\u2014")]})),t("div",{class:"flex flex-wrap items-center gap-3 mt-2 pt-2",style:"border-top: 1px solid var(--border-subtle); font-size: var(--type-micro); color: var(--text-tertiary); padding: 0 0.5rem 0.5rem;"},t("div",{class:"flex items-center gap-1"},t("span",{style:"display: inline-block; width: 12px; height: 12px; border-radius: 2px; background: var(--accent); opacity: 0.2;"}),t("span",null,"Low")),t("div",{class:"flex items-center gap-1"},t("span",{style:"display: inline-block; width: 12px; height: 12px; border-radius: 2px; background: var(--accent); opacity: 0.65;"}),t("span",null,"High")),t("div",{class:"flex items-center gap-1"},t("span",{style:"display: inline-block; width: 12px; height: 12px; border-radius: 2px; background: var(--status-error); opacity: 0.65;"}),t("span",null,"High unavail (bad)")),t("span",{style:"color: var(--accent);"},"\\u25C0 today"))))}function Ed({insight:e}){if(!e)return t(oe,{title:"Daily Insight",subtitle:"An AI-generated analysis of your home's patterns. Generated each night at 11:30 PM from the day's data."},t(Ce,null,"No insight report yet. The first report is generated after the first full pipeline run."));let a=(e.report||"").split(`
`);return t(oe,{title:"Daily Insight",subtitle:"AI analysis of what happened yesterday and what to watch for. Generated nightly from your full data set.",summary:e.date},t("div",{class:"t-frame p-4","data-label":"insight"},t("span",{class:"inline-block rounded px-2 py-0.5 text-xs mb-3",style:"background: var(--bg-surface-raised); color: var(--text-tertiary)"},e.date),t("div",{class:"space-y-2",style:"color: var(--text-secondary)"},a.map((r,n)=>r.startsWith("###")?t("h3",{key:n,class:"text-sm font-bold mt-3",style:"color: var(--text-primary)"},r.replace(/^###\s*/,"")):r.trim()===""?null:t("p",{key:n,class:"text-sm leading-relaxed"},r)))))}function Sr(e){let a=e.indexOf(".");return a>=0?e.slice(a+1):e}var Bv={very_strong:.9,strong:.7,moderate:.5,weak:.3};function Wv(e){let a=e.conditional_prob_a_given_b,r=e.conditional_prob_b_given_a;return a!=null&&r!=null?(a+r)/2/100:typeof e.strength=="string"?Bv[e.strength]??.5:parseFloat(e.strength!=null?e.strength:e[2])||0}function jv(e){let a=e.map(o=>({a:o.entity_a||o[0],b:o.entity_b||o[1],strength:Wv(o)})),r={};for(let o of a)for(let l of[o.a,o.b])r[l]||(r[l]={sum:0,count:0}),r[l].sum+=Math.abs(o.strength),r[l].count+=1;let n=Object.keys(r).sort((o,l)=>{let i=r[o].sum/r[o].count;return r[l].sum/r[l].count-i}),s={};for(let o of a)s[o.a+"|"+o.b]=o.strength,s[o.b+"|"+o.a]=o.strength;return{entities:n,pairMap:s}}function Uv(e){let a=Math.abs(e);if(e===1&&a===1)return"var(--bg-surface-raised)";if(a<=.3)return"var(--bg-surface)";let r=(.3+(a-.3)*(.7/.7)).toFixed(2);return e>0?`color-mix(in srgb, var(--accent) ${Math.round(r*100)}%, transparent)`:`color-mix(in srgb, var(--accent-purple) ${Math.round(r*100)}%, transparent)`}function Pd({correlations:e}){let a=e&&e.length>0;return t(oe,{title:"Correlations",subtitle:a?"Devices that change together. Strong correlations suggest automation opportunities or shared failure modes.":"Devices that tend to change together \u2014 useful for creating automations or finding shared failure points.",summary:a?e.length+" pairs":null},a?t(V,null,t("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"This grid shows which devices tend to change at the same time. Blue means they move together (both turn on/off). Purple means they move opposite (one on, the other off). Faded cells are too weak to matter. Numbers closer to 1.0 or -1.0 are stronger relationships."),t(Vv,{correlations:e})):t(Ce,null,"No correlations yet. Needs enough data to detect statistically reliable relationships between devices."))}function Vv({correlations:e}){let{entities:a,pairMap:r}=jv(e),n=a.length,s={display:"grid",gridTemplateColumns:`auto repeat(${n}, minmax(2.5rem, 1fr))`,gridTemplateRows:`auto repeat(${n}, minmax(2rem, 1fr))`,gap:"1px",overflowX:"auto"};return t("div",{class:"t-frame overflow-x-auto","data-label":"correlation-matrix"},t("div",{style:s},t("div",{style:{gridRow:1,gridColumn:1}}),a.map((o,l)=>t("div",{key:"ch-"+l,style:{gridRow:1,gridColumn:l+2,display:"flex",alignItems:"flex-end",justifyContent:"flex-start",height:"5rem",overflow:"visible",paddingBottom:"0.25rem"}},t("span",{class:"data-mono",style:{fontSize:"var(--type-micro)",color:"var(--text-secondary)",transform:"rotate(-45deg)",transformOrigin:"bottom left",whiteSpace:"nowrap",display:"inline-block"}},Sr(o)))),a.map((o,l)=>t(V,null,t("div",{key:"rh-"+l,class:"data-mono",style:{gridRow:l+2,gridColumn:1,display:"flex",alignItems:"center",paddingRight:"0.5rem",fontSize:"var(--type-micro)",color:"var(--text-secondary)",whiteSpace:"nowrap"}},Sr(o)),a.map((i,u)=>{let d=l===u,g=d?1:r[o+"|"+i]??null,f=g!==null,m=f?Math.abs(g):0,b=f&&!d&&m<=.3;return t("div",{key:l+"-"+u,style:{gridRow:l+2,gridColumn:u+2,background:f?Uv(g):"transparent",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"2px",minHeight:"2rem"},title:f?`${Sr(o)} \u2194 ${Sr(i)}: ${g.toFixed(2)}`:`${Sr(o)} \u2194 ${Sr(i)}: no data`},f&&t("span",{style:{fontSize:"var(--type-micro)",color:b?"var(--text-tertiary)":m>.6?"var(--text-primary)":"var(--text-secondary)",fontVariantNumeric:"tabular-nums"}},d?"":g.toFixed(2)))})))),t("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid var(--border-subtle)",fontSize:"var(--type-micro)",color:"var(--text-tertiary)",flexWrap:"wrap"}},t("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"}},t("span",{style:{display:"inline-block",width:"12px",height:"12px",borderRadius:"2px",background:"color-mix(in srgb, var(--accent-purple) 70%, transparent)"}}),t("span",null,"Negative")),t("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"}},t("span",{style:{display:"inline-block",width:"12px",height:"12px",borderRadius:"2px",background:"var(--bg-surface)"}}),t("span",null,"Weak (|r| \u2264 0.3)")),t("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"}},t("span",{style:{display:"inline-block",width:"12px",height:"12px",borderRadius:"2px",background:"color-mix(in srgb, var(--accent) 70%, transparent)"}}),t("span",null,"Positive"))))}function Ld({runLog:e,mlModels:a,metaLearning:r}){let n=e&&e.some(l=>l.status==="error"),s=e&&e.length>0?e[0]:null,o=n?"Errors detected in recent runs \u2014 the pipeline may be missing data.":s?`Last run ${Qt(s.timestamp)}. Everything healthy.`:"No runs recorded yet.";return t(oe,{title:"System Status",subtitle:`If something is red here, the intelligence pipeline is broken and won't catch issues in your home. ${o}`,summary:n?"errors":"healthy"},t("div",{class:"space-y-4"},t("div",{class:"t-frame overflow-x-auto","data-label":"run-log"},t("div",{class:"px-4 py-2 text-xs font-bold uppercase",style:"border-bottom: 1px solid var(--border-subtle); color: var(--text-tertiary)"},"Run Log"),!e||e.length===0?t("div",{class:"px-4 py-3 text-sm",style:"color: var(--text-tertiary)"},"No runs recorded yet."):t("table",{class:"w-full text-sm"},t("thead",null,t("tr",{class:"text-left text-xs",style:"border-bottom: 1px solid var(--border-subtle); color: var(--text-tertiary)"},t("th",{class:"px-4 py-1"},"When"),t("th",{class:"px-4 py-1"},"Type"),t("th",{class:"px-4 py-1"},"Status"))),t("tbody",null,e.map((l,i)=>t("tr",{key:i,style:"border-bottom: 1px solid var(--border-subtle)"},t("td",{class:"px-4 py-1.5",style:"color: var(--text-secondary)",title:l.timestamp},Qt(l.timestamp)),t("td",{class:"px-4 py-1.5"},t("span",{class:"rounded px-1.5 py-0.5 text-xs",style:"background: var(--bg-surface-raised)"},l.type)),t("td",{class:"px-4 py-1.5"},t("span",{class:"inline-block w-2 h-2 rounded-full",style:`background: ${l.status==="ok"?"var(--status-healthy)":"var(--status-error)"}`}),l.message&&t("span",{class:"ml-1 text-xs",style:"color: var(--status-error)"},l.message))))))),t("div",{class:"t-frame p-4","data-label":"ml-models"},t("div",{class:"text-xs font-bold uppercase mb-2",style:"color: var(--text-tertiary)"},"ML Models"),!a||a.count===0?t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"ML models activate after 14 days of data. Until then, predictions use statistical baselines only."):t("div",{class:"space-y-2"},t("div",{class:"flex gap-3 text-sm"},t("span",{class:"rounded px-2 py-0.5",style:"background: var(--bg-surface-raised)"},a.count," model",a.count!==1?"s":""),a.last_trained&&t("span",{style:"color: var(--text-tertiary)"},"Last trained: ",Qt(a.last_trained))),a.scores&&Object.keys(a.scores).length>0&&t("table",{class:"w-full text-xs"},t("thead",null,t("tr",{class:"text-left",style:"color: var(--text-tertiary)"},t("th",{class:"py-1"},"Model"),t("th",null,"R2"),t("th",null,"MAE"))),t("tbody",null,Object.entries(a.scores).map(([l,i])=>t("tr",{key:l},t("td",{class:"py-1 data-mono"},l),t("td",null,i.r2!=null?i.r2.toFixed(3):"\u2014"),t("td",null,i.mae!=null?i.mae.toFixed(2):"\u2014"))))))),t("div",{class:"t-frame p-4","data-label":"meta-learning"},t("div",{class:"text-xs font-bold uppercase mb-2",style:"color: var(--text-tertiary)"},"Meta-Learning"),!r||r.applied_count===0?t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Meta-learning reviews model performance weekly and auto-tunes feature selection. Activates after the first training cycle."):t("div",{class:"space-y-2"},t("div",{class:"flex gap-3 text-sm"},t("span",{class:"rounded px-2 py-0.5",style:"background: var(--bg-surface-raised)"},r.applied_count," suggestion",r.applied_count!==1?"s":""," applied"),r.last_applied&&t("span",{style:"color: var(--text-tertiary)"},"Last: ",Qt(r.last_applied))),r.suggestions&&r.suggestions.length>0&&t("ul",{class:"text-xs space-y-1 list-disc ml-4",style:"color: var(--text-secondary)"},r.suggestions.map((l,i)=>t("li",{key:i},l.description||l.action||JSON.stringify(l))))))))}function $d({drift:e}){if(!e||e.days_analyzed===0)return t(oe,{title:"Drift Detection",subtitle:"Concept drift means your home's patterns have changed \u2014 maybe a new schedule, seasonal shift, or new devices. ARIA uses Page-Hinkley and ADWIN algorithms to detect this automatically."},t(Ce,null,"Drift detection data is not yet available. It will populate after ARIA runs its drift check (aria check-drift) with enough prediction history."));let a=Object.keys(e.rolling_mae||{});return t(oe,{title:"Drift Detection",subtitle:"Concept drift means your home's patterns have changed \u2014 maybe a new schedule, seasonal shift, or new devices. ARIA uses Page-Hinkley and ADWIN algorithms to detect this and retrains when needed.",summary:e.needs_retrain?"drift detected":"stable"},t("div",{class:"space-y-3"},t("div",{class:"t-frame p-4","data-label":"status"},t("div",{class:"flex items-center gap-3"},t("span",{class:"inline-block w-3 h-3 rounded-full",style:`background: ${e.needs_retrain?"var(--status-warning)":"var(--status-healthy)"}`}),t("span",{class:"text-sm font-bold",style:`color: ${e.needs_retrain?"var(--status-warning)":"var(--status-healthy)"}`},e.needs_retrain?"Drift Detected":"Stable"),t("span",{class:"text-xs",style:"color: var(--text-tertiary)"},e.days_analyzed," days analyzed")),e.reason&&e.reason!=="no data"&&t("p",{class:"text-xs mt-2",style:"color: var(--text-secondary)"},e.reason)),a.length>0&&t("div",{class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"},a.map(r=>{let n=(e.drifted_metrics||[]).includes(r),s=e.rolling_mae[r],o=e.current_mae?.[r],l=e.threshold?.[r],i=e.page_hinkley?.[r];return t("div",{key:r,class:"t-frame p-3","data-label":r.replace(/_/g," "),style:n?"border-left: 3px solid var(--status-warning)":""},t("div",{class:"flex items-center justify-between mb-2"},t("span",{class:"text-xs font-bold",style:"color: var(--text-primary)"},r.replace(/_/g," ")),t("span",{class:"inline-block w-2 h-2 rounded-full",style:`background: ${n?"var(--status-warning)":"var(--status-healthy)"}`})),t("div",{class:"space-y-1 text-xs",style:"color: var(--text-secondary)"},t("div",{class:"flex justify-between"},t("span",{style:"color: var(--text-tertiary)"},"Rolling MAE"),t("span",{class:"data-mono"},s??"\u2014")),o!=null&&t("div",{class:"flex justify-between"},t("span",{style:"color: var(--text-tertiary)"},"Current MAE"),t("span",{class:"data-mono",style:o>(l||1/0)?"color: var(--status-warning)":""},o)),l!=null&&t("div",{class:"flex justify-between"},t("span",{style:"color: var(--text-tertiary)"},"Threshold"),t("span",{class:"data-mono"},l)),i&&i.drift_detected&&t("div",{class:"text-xs mt-1",style:"color: var(--status-warning)"},"Page-Hinkley: drift at point ",i.drift_point," (score: ",i.drift_score,")")))})),t("div",{class:"flex items-center gap-4 text-xs pt-2",style:"color: var(--text-tertiary)"},t("div",{class:"flex items-center gap-1"},t("span",{class:"inline-block w-2 h-2 rounded-full",style:"background: var(--status-healthy)"}),t("span",null,"Stable")),t("div",{class:"flex items-center gap-1"},t("span",{class:"inline-block w-2 h-2 rounded-full",style:"background: var(--status-warning)"}),t("span",null,"Drift detected")))))}function Dd({anomalies:e}){if(!e)return t(oe,{title:"Anomaly Detection",subtitle:"Anomaly detection flags things that look unusual compared to your home's normal patterns \u2014 like high power draw at 3 AM or unexpected device activity."},t(Ce,null,"Anomaly detection data is not yet available. It will appear after the first ML training cycle."));let a=e.anomalies||[],r=e.autoencoder,n=e.isolation_forest;return t(oe,{title:"Anomaly Detection",subtitle:"Anomaly detection flags things that look unusual compared to your home's normal patterns \u2014 like high power draw at 3 AM or unexpected device activity.",summary:a.length>0?`${a.length} anomal${a.length===1?"y":"ies"}`:"clear"},t("div",{class:"space-y-3"},t("div",{class:"flex items-center gap-3"},n&&t("span",{class:"text-xs font-medium rounded-full px-2.5 py-0.5",style:`background: ${n.contamination?"var(--accent-glow)":"var(--bg-inset)"}; color: ${n.contamination?"var(--accent)":"var(--text-tertiary)"}`},"Isolation Forest",n.contamination?` (${(n.contamination*100).toFixed(1)}%)`:""),r&&t("span",{class:"text-xs font-medium rounded-full px-2.5 py-0.5",style:`background: ${r.enabled?"var(--accent-glow)":"var(--bg-inset)"}; color: ${r.enabled?"var(--accent)":"var(--text-tertiary)"}`},"Autoencoder ",r.enabled?"active":"inactive")),a.length===0?t(Ce,null,"No anomalies detected. This means your home's behavior matches its normal patterns."):t("div",{class:"space-y-2"},a.map((s,o)=>t("div",{key:o,class:"t-frame p-3","data-label":"anomaly",style:"border-left: 3px solid var(--status-warning)"},t("div",{class:"flex items-center justify-between"},t("div",{class:"flex items-center gap-2"},t("span",{class:"inline-block w-2 h-2 rounded-full",style:"background: var(--status-warning)"}),t("span",{class:"text-xs font-bold",style:"color: var(--text-primary)"},s.entity_id||s.metric||"unknown")),t("span",{class:"text-xs",style:"color: var(--text-tertiary)"},Qt(s.timestamp))),t("div",{class:"flex items-center gap-4 mt-1 text-xs",style:"color: var(--text-secondary)"},t("span",null,"Score: ",t("span",{class:"data-mono",style:"color: var(--status-warning)"},typeof(s.score??s.severity)=="number"?(s.score??s.severity).toFixed(3):s.score??s.severity)),t("span",{class:"text-xs rounded-full px-2 py-0.5",style:"background: var(--bg-inset); color: var(--text-tertiary)"},s.type))))),t("div",{class:"flex items-center gap-4 text-xs pt-2",style:"color: var(--text-tertiary)"},t("div",{class:"flex items-center gap-1"},t("span",{class:"inline-block w-2 h-2 rounded-full",style:"background: var(--status-warning)"}),t("span",null,"Anomalous")),t("span",null,"Lower scores = more unusual"))))}function Id({shap:e}){if(!e||!e.available)return t(oe,{title:"Feature Attributions (SHAP)",subtitle:"SHAP values explain WHY ARIA made a prediction. Each bar shows how much a feature pushed the prediction up or down. Longer bars = more influence."},t(Ce,null,"SHAP attributions are not yet available. They require trained ML models and are computed during prediction generation."));let a=e.attributions||[],r=Math.max(...a.map(n=>Math.abs(n.contribution)),.001);return t(oe,{title:"Feature Attributions (SHAP)",subtitle:"SHAP values explain WHY ARIA made a prediction. Each bar shows how much a feature pushed the prediction up or down. Longer bars = more influence.",summary:e.model_type||"active"},t("div",{class:"space-y-3"},e.model_type&&t("div",null,t("span",{class:"text-xs font-medium rounded-full px-2.5 py-0.5",style:"background: var(--accent-glow); color: var(--accent)"},e.model_type)),a.length>0?t("div",{class:"t-frame p-4","data-label":"attributions"},t("div",{class:"space-y-1"},a.map((n,s)=>t("div",{key:s,class:"flex items-center gap-2",style:"height: 24px;"},t("span",{class:"text-xs w-32 text-right truncate",style:"color: var(--text-secondary); flex-shrink: 0;"},n.feature.replace(/_/g," ")),t("div",{class:"flex-1 flex items-center",style:"position: relative; min-width: 0;"},t("div",{style:"position: absolute; left: 50%; width: 1px; height: 100%; background: var(--border-subtle);"}),t("div",{style:`
                      position: absolute;
                      ${n.direction==="positive"?"left: 50%":"right: 50%"};
                      width: ${Math.abs(n.contribution)/r*50}%;
                      height: 16px;
                      background: ${n.direction==="positive"?"var(--accent)":"var(--accent-purple)"};
                      opacity: 0.7;
                      border-radius: 2px;
                    `})),t("span",{class:"text-xs w-12 data-mono",style:"color: var(--text-tertiary); flex-shrink: 0;"},n.contribution>0?"+":"",n.contribution.toFixed(3)))))):t(Ce,null,"No feature attributions computed yet."),t("div",{class:"flex items-center gap-4 text-xs pt-2",style:"color: var(--text-tertiary)"},t("div",{class:"flex items-center gap-1"},t("span",{class:"inline-block w-3 h-3 rounded",style:"background: var(--accent); opacity: 0.7;"}),t("span",null,"Pushes prediction up")),t("div",{class:"flex items-center gap-1"},t("span",{class:"inline-block w-3 h-3 rounded",style:"background: var(--accent-purple); opacity: 0.7;"}),t("span",null,"Pushes prediction down")))))}function Gv({shadowAccuracy:e,pipeline:a}){if(!e&&!a)return null;let r=e?.predictions_total??0,n=e?.predictions_correct??0,s=e?.overall_accuracy??0,o=a?.current_stage||e?.stage||"backtest",l=Math.round(s*100),i=l>=70?"color: var(--status-healthy)":l>=40?"color: var(--status-warning)":"color: var(--status-error)",u=r>0?`${l}% accuracy`:o;return t(oe,{title:"Shadow Engine",subtitle:"Predict-compare-score loop running alongside the main engine.",summary:u},t("div",{class:"t-frame p-4","data-label":"shadow"},t("div",{class:"flex items-center justify-between"},t("div",{class:"flex items-center gap-4"},t("span",{class:"text-xs font-medium rounded-full px-2.5 py-0.5 capitalize",style:"background: var(--accent-glow); color: var(--accent)"},o),r>0?t("span",{class:"text-sm",style:"color: var(--text-secondary)"},t("span",{class:"font-bold",style:i},l,"%")," accuracy (",n,"/",r,")"):t("span",{class:"text-sm",style:"color: var(--text-tertiary)"},"No predictions yet")),t("a",{href:"#/shadow",class:"text-sm font-medium",style:"color: var(--accent)"},"Full details \u2192")),a&&(()=>{let d=a.current_stage||"backtest",f=(a.gates||{})[d];if(!f)return null;let m=a[f.field]??0,b=Math.min(100,Math.round(m/f.threshold*100)),h=m>=f.threshold;return t("div",{class:"mt-3 pt-3",style:"border-top: 1px solid var(--border-subtle)"},t("div",{class:"flex items-center justify-between text-xs mb-1"},t("span",{style:"color: var(--text-tertiary)"},"Gate: ",f.label," \u2265 ",Math.round(f.threshold*100),"%"),t("span",{class:h?"font-medium":"",style:h?"color: var(--status-healthy)":"color: var(--text-tertiary)"},Math.round(m*100),"%")),t("div",{class:"h-1.5 rounded-full",style:"background: var(--bg-inset)"},t("div",{class:"h-1.5 rounded-full",style:`background: ${h?"var(--status-healthy)":"var(--accent)"}; width: ${b}%`})))})()))}function Wo(){let{data:e,loading:a,error:r,refetch:n}=We("intelligence"),[s,o]=N(null),[l,i]=N(null),[u,d]=N(null),[g,f]=N(null),[m,b]=N(null);le(()=>{ce("/api/shadow/accuracy").then(o).catch(()=>{}),ce("/api/pipeline").then(i).catch(()=>{}),ce("/api/ml/drift").then(d).catch(()=>{}),ce("/api/ml/anomalies").then(f).catch(()=>{}),ce("/api/ml/shap").then(b).catch(()=>{})},[]);let h=pe(()=>!e||!e.data?null:e.data,[e]);if(a&&!e)return t("div",{class:"space-y-6"},t("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Intelligence"),t(Pe,{type:"cards"}));if(r)return t("div",{class:"space-y-6"},t("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Intelligence"),t(we,{error:r,onRetry:n}));if(!h)return t("div",{class:"space-y-6"},t("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Intelligence"),t(Ce,null,"Intelligence data is loading. The engine collects its first snapshot automatically via cron."));let A=(h.intraday_trend?.length>0?h.intraday_trend[h.intraday_trend.length-1]:null)?.power_watts??null,M=null;if(A!=null&&h.baselines){let S=new Date().toLocaleDateString("en-US",{weekday:"long"}),k=h.baselines[S];if(k?.power_watts?.mean!=null){let O=A-k.power_watts.mean,L=k.power_watts.mean>0?Math.round(O/k.power_watts.mean*100):0;Math.abs(L)>=10?M=`${L>0?"+":""}${L}% vs ${S}`:M=`typical for ${S}`}}let _=Oe(()=>{let S=h.intraday_trend;if(!S||S.length<2)return null;let k=new Date;k.setHours(0,0,0,0);let O=Math.floor(k.getTime()/1e3),L=[],H=[];for(let R of S)L.push(O+(R.hour??0)*3600),H.push(R.power_watts??null);return[L,H]},[h.intraday_trend]);return t("div",{class:"space-y-8 animate-page-enter"},t(ve,{page:"INTELLIGENCE",subtitle:"Your home's learning engine \u2014 baselines, trends, correlations, and insights."}),t("div",{class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},t("div",{class:"sm:col-span-2"},t(ze,{value:A,label:"home right now",unit:"W",delta:M,sparkData:_})),t(hd,{maturity:h.data_maturity,shadowStage:l?.current_stage,shadowAccuracy:s?.overall_accuracy}),t(Gv,{shadowAccuracy:s,pipeline:l}),t("div",{class:"sm:col-span-2"},t(wd,{intraday:h.intraday_trend,baselines:h.baselines})),t("div",{class:"sm:col-span-2"},t(Sd,{activity:h.activity})),t(Ad,{trendData:h.trend_data,intradayTrend:h.intraday_trend}),t(Cd,{predictions:h.predictions,intradayTrend:h.intraday_trend}),t(Md,{baselines:h.baselines}),t(Ed,{insight:h.daily_insight}),t(Pd,{correlations:h.entity_correlations?.top_co_occurrences}),t(Ld,{runLog:h.run_log,mlModels:h.ml_models,metaLearning:h.meta_learning}),t($d,{drift:u}),t(Dd,{anomalies:g}),t("div",{class:"sm:col-span-2"},t(Id,{shap:m})),t("div",{class:"sm:col-span-2"},t(oe,{title:"Configuration",subtitle:"Engine parameters are now managed in Settings."},t("div",{class:"t-callout p-3 text-sm flex items-center justify-between"},t("span",null,"Engine settings have moved to the dedicated Settings page."),t("a",{href:"#/settings",class:"font-medium whitespace-nowrap",style:"color: var(--accent)"},"Settings \u2192"))))))}function Vo({children:e}){return t("div",{class:"t-callout p-3 text-sm"},e)}function qn({label:e,color:a}){return t("span",{class:"data-mono",style:`display: inline-block; font-size: var(--type-label); padding: 2px 8px; border-radius: var(--radius); background: ${a}; color: var(--bg-base); font-weight: 600;`},e)}function qv(e){switch(e){case"stable":return"var(--status-healthy)";case"behavioral_drift":return"var(--status-warning)";case"meta_learner_error":return"var(--status-error)";case"meta_learner_improvement":return"var(--accent)";default:return"var(--text-tertiary)"}}function Uo(e){if(!e)return"\u2014";let a=new Date(e);return isNaN(a.getTime())?"\u2014":a.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function jo(e){return e==null?"\u2014":`${(e*100).toFixed(1)}%`}function Yv({features:e,loading:a}){let r=e?.selected||[],n=e?.total||0,s=e?.method||"none",o=e?.last_computed,l=r.length===0,i={mrmr:"mRMR",importance:"Importance",none:"None"};return t(vt,{title:"Feature Selection",subtitle:"mRMR-ranked input signals",summary:l?"not yet computed":`${r.length} of ${n}`,defaultOpen:!0,loading:a},l?t(Vo,null,"Feature selection data is not yet available. It will populate once ML models are trained and mRMR feature ranking is computed."):t("div",{class:"space-y-4"},t(ze,{value:`${r.length} of ${n}`,label:"Selected Features"}),t("div",{class:"flex items-center gap-3 flex-wrap",style:"margin-top: 12px;"},t(qn,{label:i[s]||s,color:"var(--accent)"}),o&&t("span",{class:"data-mono",style:"font-size: var(--type-label); color: var(--text-tertiary);"},"computed ",Uo(o))),t("div",{class:"t-frame","data-label":"Ranked Features"},t("ol",{style:"list-style: none; padding: 0; margin: 0;"},r.map((u,d)=>t("li",{key:u,style:`display: flex; align-items: center; gap: 8px; padding: 6px 0; font-family: var(--font-mono); font-size: var(--type-body); color: var(--text-primary);${d>0?" border-top: 1px solid var(--border-subtle);":""}`},t("span",{class:"data-mono",style:"min-width: 28px; text-align: right; color: var(--text-tertiary); font-size: var(--type-label);"},d+1,"."),t("span",null,u))))),t("p",{style:"font-size: var(--type-label); color: var(--text-tertiary); line-height: 1.5; margin-top: 8px;"},"Feature selection picks the most informative signals from your home's data. Using mRMR (minimum Redundancy Maximum Relevance), ARIA selects features that are individually useful but not redundant with each other.")))}function Kv({models:e,loading:a}){let r=e?.reference,n=e?.incremental,s=e?.forecaster,o=!r&&!n&&!s;return t(vt,{title:"Model Health",subtitle:"Reference comparison, training mode, forecaster",summary:o?"awaiting data":r?.interpretation||"active",defaultOpen:!0,loading:a},o?t(Vo,null,"Model health data is not yet available. It will populate once ML models are trained and reference model comparison is active."):t("div",{class:"space-y-4"},r&&t("div",{class:"t-frame","data-label":"Reference Model"},t("div",{class:"flex items-center gap-3 flex-wrap",style:"margin-bottom: 12px;"},t(qn,{label:r.interpretation||"unknown",color:qv(r.interpretation)})),t("div",{class:"grid grid-cols-1 sm:grid-cols-3 gap-3"},t("div",{class:"t-frame","data-label":"Primary Trend"},t("span",{class:"data-mono",style:"font-size: var(--type-headline); color: var(--text-primary);"},r.primary_trend!=null?jo(r.primary_trend):"\u2014")),t("div",{class:"t-frame","data-label":"Reference Trend"},t("span",{class:"data-mono",style:"font-size: var(--type-headline); color: var(--text-primary);"},r.reference_trend!=null?jo(r.reference_trend):"\u2014")),t("div",{class:"t-frame","data-label":"Divergence"},t("span",{class:"data-mono",style:"font-size: var(--type-headline); color: var(--text-primary);"},(r.divergence??r.divergence_pct)!=null?jo(r.divergence??r.divergence_pct):"\u2014"))),t("p",{style:"font-size: var(--type-label); color: var(--text-tertiary); line-height: 1.5; margin-top: 12px;"},"A reference model runs alongside ARIA's main model without any meta-learning adjustments. Comparing the two reveals whether accuracy changes come from your home changing (drift) or from ARIA's learning process.")),n&&t("div",{class:"t-frame","data-label":"Incremental Training"},t("div",{class:"flex items-center gap-3 flex-wrap",style:"margin-bottom: 12px;"},t(qn,{label:n.mode==="incremental"?"Incremental":"Full Retrain",color:n.mode==="incremental"?"var(--accent)":"var(--text-secondary)"}),n.tree_count!=null&&t("span",{class:"data-mono",style:"font-size: var(--type-label); color: var(--text-tertiary);"},n.tree_count," / ",n.max_trees||"\u2014"," trees")),t("p",{style:"font-size: var(--type-label); color: var(--text-tertiary); line-height: 1.5;"},"Instead of rebuilding models from scratch, incremental training adds new trees to existing models \u2014 faster and preserves learned knowledge.")),s&&t("div",{class:"t-frame","data-label":"Forecaster Backend"},t("div",{class:"flex items-center gap-3 flex-wrap"},t(qn,{label:s.backend||"auto",color:"var(--accent)"}),s.backend==="neuralprophet"&&s.config&&t("span",{class:"data-mono",style:"font-size: var(--type-label); color: var(--text-tertiary);"},"AR(",s.config.ar_order||"?",") \xB7 ",s.config.epochs||"?"," epochs \xB7 lr ",s.config.learning_rate||"?")))))}function Jv({models:e,loading:a}){let r=e?.ml_models,n=!r,s=r?.last_trained,o=r?.scores,l=o&&typeof o=="object"&&Object.keys(o).length>0;return t(vt,{title:"Training History",subtitle:"Last retrain and model accuracy",summary:n?"no data":s?Uo(s):"pending",defaultOpen:!0,loading:a},n?t(Vo,null,"Training history is not yet available. It will populate after ARIA completes its first model training run."):t("div",{class:"space-y-4"},s&&t("div",{class:"t-frame","data-label":"Last Trained"},t("span",{class:"data-mono",style:"font-size: var(--type-headline); color: var(--accent);"},Uo(s))),l&&t("div",{class:"t-frame","data-label":"Model Scores"},t("div",{style:"overflow-x: auto;"},t("table",{style:"width: 100%; border-collapse: collapse; font-family: var(--font-mono); font-size: var(--type-body);"},t("thead",null,t("tr",{style:"border-bottom: 2px solid var(--border-subtle);"},t("th",{style:"text-align: left; padding: 8px 12px; color: var(--text-secondary); font-weight: 600;"},"Model"),t("th",{style:"text-align: right; padding: 8px 12px; color: var(--text-secondary); font-weight: 600;"},"R\xB2"),t("th",{style:"text-align: right; padding: 8px 12px; color: var(--text-secondary); font-weight: 600;"},"MAE"))),t("tbody",null,Object.entries(o).map(([i,u])=>t("tr",{key:i,style:"border-bottom: 1px solid var(--border-subtle);"},t("td",{style:"padding: 8px 12px; color: var(--text-primary);"},i),t("td",{style:"text-align: right; padding: 8px 12px; color: var(--accent);"},u?.r2!=null?u.r2.toFixed(3):"\u2014"),t("td",{style:"text-align: right; padding: 8px 12px; color: var(--text-primary);"},u?.mae!=null?u.mae.toFixed(3):"\u2014"))))))),t("p",{style:"font-size: var(--type-label); color: var(--text-tertiary); line-height: 1.5; margin-top: 8px;"},"Training history shows when ARIA last retrained its models and how accurate they are. R\xB2 measures how well the model explains variance (1.0 = perfect), MAE measures average prediction error (lower = better).")))}function Go(){let[e,a]=N(null),[r,n]=N(null),[s,o]=N(null),[l,i]=N(!0),[u,d]=N(null);function g(){i(!0),d(null),Promise.all([ce("/api/ml/features"),ce("/api/ml/models"),ce("/api/ml/drift")]).then(([f,m,b])=>{a(f),n(m),o(b)}).catch(f=>d(f)).finally(()=>i(!1))}return le(()=>{g()},[]),u?t("div",{class:"space-y-6"},t(ve,{page:"MLENGINE"}),t(we,{error:u,onRetry:g})):l?t("div",{class:"space-y-6"},t(ve,{page:"MLENGINE"}),t(Pe,{type:"full"})):t("div",{class:"space-y-6 animate-page-enter"},t(ve,{page:"MLENGINE",subtitle:"Feature selection, model health, and training history"}),t(Yv,{features:e,loading:!1}),t(Kv,{models:r,loading:!1}),t(Jv,{models:r,loading:!1}))}var Rd=["backtest","shadow","suggest","autonomous"],Nd={next_domain_action:"background: var(--accent-glow); color: var(--accent);",room_activation:"background: var(--accent-purple-glow); color: var(--accent-purple);",routine_trigger:"background: var(--status-warning-glow); color: var(--status-warning);"},Od={next_domain_action:"Domain",room_activation:"Room",routine_trigger:"Routine"},Zv={correct:"background: var(--status-healthy-glow); color: var(--status-healthy);",disagreement:"background: var(--status-warning-glow); color: var(--status-warning);",nothing:"background: var(--bg-surface-raised); color: var(--text-tertiary);"},Hd={backtest:{field:"backtest_accuracy",threshold:.4,label:"backtest accuracy"},shadow:{field:"shadow_accuracy_7d",threshold:.5,label:"7-day shadow accuracy"},suggest:{field:"suggest_approval_rate_14d",threshold:.7,label:"14-day approval rate"}};function Qv({pipeline:e,onAdvance:a,onRetreat:r,advanceError:n}){let s=e?.stages||Rd,o=e?.gates||Hd,l=e?.current_stage||"backtest",i=s.indexOf(l),u=Math.max((i+1)/s.length*100,10),d=e?.stage_entered_at,g=o[l],f=g?e?.[g.field]??0:null,m=g?f>=g.threshold:!1,b=i<s.length-1?s[i+1]:null;return t("section",{class:"space-y-3"},t("div",{class:"t-section-header",style:"padding-bottom: 6px;"},t("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Pipeline Stage")),t("div",{class:"t-frame","data-label":`stage: ${l}`,style:"padding: 1rem;"},t("div",{class:"space-y-4"},t("div",null,t("div",{class:"flex justify-between text-xs mb-1",style:"color: var(--text-tertiary)"},s.map((h,C)=>t("span",{key:h,class:"capitalize",style:C<=i?"font-weight: 700; color: var(--accent)":""},h))),t("div",{class:"h-3 rounded-full",style:"background: var(--bg-inset)"},t("div",{class:"h-3 rounded-full transition-all",style:`background: var(--accent); width: ${u}%`}))),d&&t("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"In ",l," since ",new Date(d).toLocaleDateString()),t("div",{class:"flex items-center gap-2 mt-3"},t("button",{onClick:r,disabled:i===0,class:"t-btn t-btn-secondary text-xs px-3 py-1.5"},"\u2190 Retreat"),t("button",{onClick:a,disabled:i===s.length-1,class:"t-btn t-btn-primary text-xs px-3 py-1.5"},"Advance \u2192")),g&&t("p",{class:"text-xs",style:m?"color: var(--status-healthy)":"color: var(--status-error)"},"Advance",b?` to ${b}`:""," requires >",Math.round(g.threshold*100),"% ",g.label," ","(current: ",Math.round(f*100),"%)"),n&&t("p",{class:"text-xs font-medium",style:"color: var(--status-error)"},n))))}function Xv({accuracy:e,pipeline:a}){let r=e?.overall_accuracy??0,n=e?.predictions_total??0,s=e?.predictions_correct??0,o=e?.predictions_disagreement??0,l=e?.predictions_nothing??0,i=a?.current_stage||"backtest",u=[{label:"Accuracy",value:`${Math.round(r*100)}%`,colorStyle:dd(r*100)},{label:"Total Predictions",value:n},{label:"Correct",value:s},{label:"Disagreements",value:o}];return t("section",{class:"space-y-3"},t("div",{class:"flex items-center gap-3 t-section-header",style:"padding-bottom: 6px;"},t("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Accuracy"),t("span",{class:"text-xs font-medium rounded-full px-2.5 py-0.5 capitalize",style:"background: var(--accent-glow); color: var(--accent)"},i)),t("div",{class:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-4"},u.map((d,g)=>t("div",{key:g,class:"t-frame","data-label":d.label.toLowerCase(),style:"padding: 1rem;"},t("div",{class:"text-2xl font-bold",style:d.colorStyle||"color: var(--accent)"},d.value),t("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},d.label)))),l>0&&t("p",{class:"text-xs px-1",style:"color: var(--text-tertiary)"},l," prediction",l!==1?"s":""," had no matching outcome (expired with no activity)."))}function em({accuracy:e}){let a=e?.thompson_sampling;if(!a||!a.buckets||Object.keys(a.buckets).length===0)return t("section",{class:"space-y-3"},t("div",{class:"t-section-header",style:"padding-bottom: 6px;"},t("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Thompson Sampling")),t("div",{class:"t-callout",style:"padding: 0.75rem;"},t("span",{class:"text-sm",style:"color: var(--text-secondary)"},"Thompson sampling stats will appear after the shadow engine has made predictions.")));let r=Object.keys(a.buckets);return t("section",{class:"space-y-3"},t("div",{class:"t-section-header",style:"padding-bottom: 6px;"},t("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Thompson Sampling")),t("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"Thompson Sampling decides which predictions to try. Each time-of-day slot builds its own confidence \u2014 ARIA explores more in uncertain slots and exploits what works in confident ones."),t("div",{class:"flex items-center gap-3 flex-wrap"},t("span",{class:"text-xs font-medium rounded-full px-2.5 py-0.5 capitalize",style:"background: var(--accent-glow); color: var(--accent)"},a.strategy),t("span",{class:"text-xs",style:"color: var(--text-tertiary)"},"discount: ",t("span",{style:"color: var(--text-secondary); font-weight: 600;"},a.discount_factor)),t("span",{class:"text-xs",style:"color: var(--text-tertiary)"},"window: ",t("span",{style:"color: var(--text-secondary); font-weight: 600;"},a.window_size))),t("div",{class:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3"},r.map(n=>{let s=a.buckets[n],o=s.explore_rate>.5?"color: var(--status-warning)":"color: var(--status-healthy)";return t("div",{key:n,class:"t-frame","data-label":n,style:"padding: 0.75rem;"},t("div",{class:"text-lg font-bold",style:"color: var(--accent)"},s.alpha,"/",s.beta),t("div",{class:"text-xs mt-1",style:"color: var(--text-tertiary)"},"alpha/beta"),t("div",{class:"text-sm font-bold mt-2",style:o},Math.round(s.explore_rate*100),"%"),t("div",{class:"text-xs",style:"color: var(--text-tertiary)"},"explore rate"),t("div",{class:"text-xs mt-1",style:"color: var(--text-secondary)"},s.samples," samples"))})))}function tm({propagation:e}){if(!e||e.enabled===!1)return t("section",{class:"space-y-3"},t("div",{class:"t-section-header",style:"padding-bottom: 6px;"},t("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Correction Propagation")),t("div",{class:"t-callout",style:"padding: 0.75rem;"},t("span",{class:"text-sm",style:"color: var(--text-secondary)"},"Correction propagation is not active. It will activate once the shadow engine has enough prediction data to propagate corrections.")));let a=e.stats||{},r=a.replay_buffer_size??0,n=a.replay_buffer_capacity??1,s=n>0?Math.round(r/n*100):0;return t("section",{class:"space-y-3"},t("div",{class:"flex items-center gap-3 t-section-header",style:"padding-bottom: 6px;"},t("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Correction Propagation"),t("span",{class:"text-xs font-medium rounded-full px-2.5 py-0.5",style:"background: var(--status-healthy-glow); color: var(--status-healthy)"},"enabled")),t("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"When ARIA gets a prediction wrong, it propagates the correction to similar situations nearby in time and space. The replay buffer stores recent corrections for learning."),t("div",{class:"grid grid-cols-1 sm:grid-cols-3 gap-4"},t("div",{class:"t-frame","data-label":"replay buffer",style:"padding: 1rem;"},t("div",{class:"text-2xl font-bold",style:"color: var(--accent)"},r," / ",n),t("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},"replay buffer"),t("div",{class:"h-1.5 rounded-full mt-2",style:"background: var(--bg-inset)"},t("div",{class:"h-1.5 rounded-full",style:`background: var(--accent); width: ${s}%`}))),t("div",{class:"t-frame","data-label":"cell observations",style:"padding: 1rem;"},t("div",{class:"text-2xl font-bold",style:"color: var(--accent)"},a.cell_observations??0),t("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},"cell observations")),t("div",{class:"t-frame","data-label":"kernel bandwidth",style:"padding: 1rem;"},t("div",{class:"text-2xl font-bold",style:"color: var(--accent)"},a.bandwidth??0),t("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},"kernel bandwidth"))))}function am({trend:e,pipeline:a}){let r=a?.gates||Hd,n=a?.stages||Rd,s=a?.current_stage||"backtest",o=r[s],l=o?Math.round(o.threshold*100):null,i=n.indexOf(s),u=i<n.length-1?n[i+1]:null,{chartData:d,chartSeries:g}=Oe(()=>{if(!e||e.length===0)return{chartData:null,chartSeries:[]};let f=[],m=[],b=[];for(let C of e){let A=Math.floor(new Date(C.date+"T12:00:00Z").getTime()/1e3);f.push(A),m.push(C.accuracy??null),b.push(C.count??0)}let h=[];for(let C=0;C<m.length;C++){let A=Math.max(0,C-6),M=0,_=0;for(let S=A;S<=C;S++)m[S]!=null&&(M+=m[S],_++);h.push(_>0?M/_:null)}return{chartData:[f,h,b],chartSeries:[{label:"7-day Accuracy",color:"var(--accent)",width:2},{label:"Predictions",color:"var(--text-tertiary)",width:1}]}},[e]);return!e||e.length===0?t("section",{class:"space-y-3"},t("div",{class:"t-section-header",style:"padding-bottom: 6px;"},t("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Daily Trend")),t("div",{class:"t-callout",style:"padding: 0.75rem;"},t("span",{class:"text-sm",style:"color: var(--text-secondary)"},"Accuracy trends will appear after 24-48 hours of predictions."))):t("section",{class:"space-y-3"},t("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Daily Trend"),t("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"How accurate are ARIA's predictions over time? The line smooths out daily swings to show the real trend. Higher = better guesses."),t("div",{class:"t-frame","data-label":"accuracy trend",style:"padding: 1rem;"},t(Ha,{data:d,series:g,height:160}),t("div",{class:"flex flex-wrap items-center gap-3 mt-2 pt-2",style:"border-top: 1px solid var(--border-subtle); font-size: var(--type-micro); color: var(--text-tertiary);"},t("div",{class:"flex items-center gap-1"},t("span",{style:"display: inline-block; width: 16px; height: 2px; background: var(--accent);"}),t("span",null,"7-day rolling accuracy")),t("div",{class:"flex items-center gap-1"},t("span",{style:"display: inline-block; width: 16px; height: 2px; background: var(--text-tertiary);"}),t("span",null,"Predictions per day"))),l!=null&&t("p",{class:"text-xs mt-2",style:"color: var(--text-tertiary)"},"Gate threshold: ",t("span",{style:"color: var(--accent); font-weight: 600;"},l,"%")," ",o.label," required",u?` to advance to ${u}`:"")))}function rm({predictions:e}){let a=e?.predictions||[];return a.length===0?t("section",{class:"space-y-3"},t("div",{class:"t-section-header",style:"padding-bottom: 6px;"},t("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Recent Predictions")),t("div",{class:"t-callout",style:"padding: 0.75rem;"},t("span",{class:"text-sm",style:"color: var(--text-secondary)"},"No predictions yet. The shadow engine generates predictions when state changes occur."))):t("section",{class:"space-y-3"},t("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Recent Predictions"),t("div",{class:"t-frame","data-label":"recent predictions",style:"padding: 0;"},a.map((r,n)=>{let s=Nd[r.prediction_type]||"background: var(--bg-surface-raised); color: var(--text-secondary);",o=Od[r.prediction_type]||r.prediction_type,l=r.outcome?Zv[r.outcome]:null,i=r.confidence??0;return t("div",{key:n,class:"flex items-center gap-3 px-4 py-2.5",style:n>0?"border-top: 1px solid var(--border-subtle)":""},t("span",{class:"text-xs w-14 flex-shrink-0",style:"color: var(--text-tertiary)"},Qt(r.timestamp)),t("span",{class:"text-xs font-medium flex-shrink-0 px-1.5 py-0.5",style:`border-radius: var(--radius); ${s}`},o),t("span",{class:"text-sm flex-1 truncate",style:"color: var(--text-secondary)"},r.predicted_value||"\u2014"),t("div",{class:"w-16 flex-shrink-0"},t("div",{class:"h-1.5 rounded-full",style:"background: var(--bg-inset)"},t("div",{class:"h-1.5 rounded-full",style:`background: var(--accent-dim); width: ${Math.round(i*100)}%`}))),l&&t("span",{class:"text-xs font-medium flex-shrink-0 capitalize px-1.5 py-0.5",style:`border-radius: var(--radius); ${l}`},r.outcome))})))}function nm({disagreements:e}){let a=e?.disagreements||[];return a.length===0?t("section",{class:"space-y-3"},t("div",{class:"t-section-header",style:"padding-bottom: 6px;"},t("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Top Disagreements")),t("div",{class:"t-callout",style:"padding: 0.75rem;"},t("span",{class:"text-sm",style:"color: var(--status-healthy)"},"No disagreements recorded yet."))):t("section",{class:"space-y-3"},t("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Top Disagreements"),t("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"High-confidence wrong predictions \u2014 the most informative for learning."),t("div",{class:"space-y-2"},a.map((r,n)=>{let s=Nd[r.prediction_type]||"background: var(--bg-surface-raised); color: var(--text-secondary);",o=Od[r.prediction_type]||r.prediction_type,l=r.confidence??0;return t("div",{key:n,class:"t-frame p-3 space-y-1","data-label":"disagreement",style:"border-left: 4px solid var(--status-warning);"},t("div",{class:"flex items-center gap-2"},t("span",{class:"text-lg font-bold",style:"color: var(--status-warning)"},Math.round(l*100),"%"),t("span",{class:"text-xs font-medium px-1.5 py-0.5",style:`border-radius: var(--radius); ${s}`},o),t("span",{class:"text-xs ml-auto",style:"color: var(--text-tertiary)"},Qt(r.timestamp))),t("div",{class:"text-sm",style:"color: var(--text-secondary)"},t("span",{style:"color: var(--text-tertiary)"},"Predicted:")," ",r.predicted_value||"\u2014"),r.actual_value&&t("div",{class:"text-sm",style:"color: var(--text-secondary)"},t("span",{style:"color: var(--text-tertiary)"},"Actual:")," ",r.actual_value))})))}function qo(){let[e,a]=N(null),[r,n]=N(null),[s,o]=N(null),[l,i]=N(null),[u,d]=N(null),[g,f]=N(!0),[m,b]=N(null),[h,C]=N(null);async function A(){C(null);try{let S=await fetch(`${pa}/api/pipeline/advance`,{method:"POST",headers:{"Content-Type":"application/json"},body:"{}"});if(!S.ok){let k=await S.json().catch(()=>({}));k.error==="Gate not met"?C(`Gate not met: ${k.gate} requires ${Math.round(k.required*100)}%, current ${Math.round(k.current*100)}%`):C(k.detail||k.error||`HTTP ${S.status}`);return}await _()}catch(S){C(S.message||String(S))}}async function M(){C(null);try{let S=await fetch(`${pa}/api/pipeline/retreat`,{method:"POST",headers:{"Content-Type":"application/json"},body:"{}"});if(!S.ok){let k=await S.json().catch(()=>({}));C(k.detail||k.error||`HTTP ${S.status}`);return}await _()}catch(S){C(S.message||String(S))}}async function _(){f(!0),b(null);try{let[S,k,O,L,H]=await Promise.all([ce("/api/pipeline"),ce("/api/shadow/accuracy"),ce(`/api/shadow/predictions?limit=${pd}`),ce(`/api/shadow/disagreements?limit=${fd}`),ce("/api/shadow/propagation")]);a(S),n(k),o(O),i(L),d(H)}catch(S){b(S.message||String(S))}finally{f(!1)}}return le(()=>{_()},[]),g&&!e?t("div",{class:"space-y-6"},t("div",null,t("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Shadow Mode"),t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Prediction accuracy, pipeline progress, and learning insights.")),t(Pe,{type:"full"})):m?t("div",{class:"space-y-6"},t("div",null,t("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Shadow Mode"),t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Prediction accuracy, pipeline progress, and learning insights.")),t(we,{error:m,onRetry:_})):t("div",{class:"space-y-8 animate-page-enter"},t(ve,{page:"SHADOW",subtitle:"Predict-compare-score validation loop."}),t(ze,{value:Math.round((r?.overall_accuracy??0)*100),label:"shadow accuracy",unit:"%",delta:`${e?.current_stage||"backtest"} stage \u2022 ${r?.predictions_total??0} predictions`,sparkData:Oe(()=>{let S=r?.daily_trend;if(!S||S.length<2)return null;let k=[],O=[];for(let L of S)k.push(Math.floor(new Date(L.date+"T12:00:00Z").getTime()/1e3)),O.push(L.accuracy??null);return[k,O]},[r])}),t(Qv,{pipeline:e,onAdvance:A,onRetreat:M,advanceError:h}),t(Xv,{accuracy:r,pipeline:e}),t(em,{accuracy:r}),t(am,{trend:r?.daily_trend,pipeline:e}),t("div",{class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},t(rm,{predictions:s}),t(nm,{disagreements:l})),t(tm,{propagation:u}))}function sm(e){let a={};for(let r of e){let n=r.category||"Other";a[n]||(a[n]=[]),a[n].push(r)}return a}function om({config:e,onUpdate:a}){let[r,n]=N(e.value),[s,o]=N(!1),l=Pt(null),i=e.value===e.default_value;le(()=>{n(e.value)},[e.value]);function u(f){n(f),l.current&&clearTimeout(l.current),l.current=setTimeout(async()=>{o(!0);try{await fa(`/api/config/${e.key}`,{value:String(f)}),a()}catch(m){console.error("Config save failed:",m)}finally{o(!1)}},500)}async function d(){o(!0);try{await wn(`/api/config/reset/${e.key}`,{}),n(e.default_value),a()}catch(f){console.error("Config reset failed:",f)}finally{o(!1)}}let g=e.value_type;return t("div",{class:"flex flex-col sm:flex-row sm:items-center gap-2 py-3",style:"border-bottom: 1px solid var(--border-subtle)"},t("div",{class:"flex-1 min-w-0"},t("div",{class:"flex items-center gap-2"},t("span",{class:"text-sm font-medium",style:"color: var(--text-secondary)"},e.label||e.key),s&&t("span",{class:"text-xs",style:"color: var(--accent)"},"Saving...")),e.description&&t("p",{class:"text-xs mt-0.5",style:"color: var(--text-tertiary)"},e.description)),t("div",{class:"flex items-center gap-2 flex-shrink-0"},g==="number"&&t("div",{class:"flex items-center gap-2"},t("input",{type:"range",min:e.min_value??0,max:e.max_value??100,step:e.step??1,value:r,onInput:f=>u(f.target.value),class:"w-28",style:"accent-color: var(--accent)"}),t("span",{class:"text-sm w-16 text-right data-mono",style:"color: var(--text-secondary)"},r)),g==="boolean"&&t("button",{class:"relative w-10 h-5 rounded-full transition-colors",style:r==="true"||r==="1"?"background: var(--accent)":"background: var(--bg-inset)",onClick:()=>u(r==="true"||r==="1"?"false":"true")},t("span",{class:`absolute top-0.5 w-4 h-4 rounded-full shadow transition-transform ${r==="true"||r==="1"?"translate-x-5":"translate-x-0.5"}`,style:"background: var(--bg-surface)"})),g==="string"&&t("input",{type:"text",value:r,onInput:f=>u(f.target.value),class:"t-input px-2 py-1 text-sm w-48"}),g==="select"&&t("select",{value:r,onChange:f=>u(f.target.value),class:"t-input px-2 py-1 text-sm"},(e.options||"").split(",").map(f=>t("option",{key:f.trim(),value:f.trim()},f.trim()))),t("button",{onClick:d,disabled:i,class:"text-xs px-2 py-1",style:`border-radius: var(--radius); ${i?"color: var(--text-tertiary); cursor: default;":"color: var(--accent); cursor: pointer;"}`},"Reset")))}function lm({category:e,configs:a,onUpdate:r}){let[n,s]=N(!0);return t("section",{class:"t-frame","data-label":e.toLowerCase()},t("button",{class:"w-full flex items-center justify-between px-4 py-3 text-left",onClick:()=>s(!n)},t("h3",{class:"text-sm font-bold",style:"color: var(--text-secondary)"},e),t("span",{class:"text-xs",style:"color: var(--text-tertiary)"},n?"\u25B2":"\u25BC"," ",a.length," param",a.length!==1?"s":"")),n&&t("div",{class:"px-4 pb-3"},a.map(o=>t(om,{key:o.key,config:o,onUpdate:r}))))}function Yo(){let[e,a]=N([]),[r,n]=N(!0),[s,o]=N(null);async function l(){try{let d=await ce("/api/config");a(d.configs||[])}catch(d){o(d.message||String(d))}finally{n(!1)}}if(le(()=>{l()},[]),r&&e.length===0)return t("div",{class:"space-y-6"},t("div",null,t("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Settings"),t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Configure shadow engine, activity monitor, and data quality parameters.")),t(Pe,{type:"full"}));if(s)return t("div",{class:"space-y-6"},t("div",null,t("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Settings"),t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Configure shadow engine, activity monitor, and data quality parameters.")),t(we,{error:s,onRetry:l}));let i=sm(e),u=e.filter(d=>d.value!==d.default_value).length;return t("div",{class:"space-y-6 animate-page-enter"},t(ve,{page:"SETTINGS",subtitle:`${e.length} parameters across ${Object.keys(i).length} categories.${u>0?` ${u} modified from defaults.`:""}`}),t("div",{class:"space-y-4"},Object.entries(i).map(([d,g])=>t(lm,{key:d,category:d,configs:g,onUpdate:l}))))}var im={auto_excluded:"background: var(--bg-surface-raised); color: var(--text-tertiary);",excluded:"background: var(--status-error-glow); color: var(--status-error);",included:"background: var(--status-healthy-glow); color: var(--status-healthy);",promoted:"background: var(--accent-glow); color: var(--accent);"};function cm({summary:e}){let a=e?.total??0,r=e?.per_status??{},n=[{label:"Total",value:a,style:"color: var(--text-secondary)"},{label:"Auto-Excluded",value:r.auto_excluded??0,style:"color: var(--text-tertiary)"},{label:"Excluded",value:r.excluded??0,style:"color: var(--status-error)"},{label:"Included",value:r.included??0,style:"color: var(--status-healthy)"},{label:"Promoted",value:r.promoted??0,style:"color: var(--accent)"}];return t("div",{class:"grid grid-cols-2 sm:grid-cols-5 gap-3"},n.map(s=>t("div",{key:s.label,class:"t-frame","data-label":s.label,style:"padding: 0.75rem; text-align: center;"},t("div",{class:"text-xl font-bold",style:s.style},s.value),t("div",{class:"text-xs",style:"color: var(--text-tertiary)"},s.label))))}function Ko({tier:e,label:a,entities:r,defaultOpen:n,onOverride:s,onBulk:o}){let[l,i]=N(n),[u,d]=N(""),g=u?r.filter(m=>m.entity_id.toLowerCase().includes(u.toLowerCase())||(m.reason||"").toLowerCase().includes(u.toLowerCase())):r,f={};for(let m of g){let b=e===1?m.reason||"Other":m.group_id||m.entity_id;f[b]||(f[b]=[]),f[b].push(m)}return t("section",{class:"t-frame","data-label":`tier ${e}: ${a.toLowerCase()}`},t("button",{class:"w-full flex items-center justify-between px-4 py-3 text-left",onClick:()=>i(!l)},t("div",{class:"flex items-center gap-2"},t("h3",{class:"text-sm font-bold",style:"color: var(--text-secondary)"},"Tier ",e,": ",a),t("span",{class:"text-xs rounded-full px-2 py-0.5",style:"background: var(--bg-surface-raised); color: var(--text-tertiary)"},r.length)),t("span",{class:"text-xs",style:"color: var(--text-tertiary)"},l?"\u25B2":"\u25BC")),l&&t("div",{class:"px-4 pb-3 space-y-3"},r.length>10&&t("input",{type:"text",placeholder:"Search entity or reason...",value:u,onInput:m=>d(m.target.value),class:"t-input w-full px-3 py-1.5 text-sm"}),e<=2?Object.entries(f).map(([m,b])=>t("div",{key:m,class:"p-3 space-y-2",style:"border: 1px solid var(--border-subtle); border-radius: var(--radius)"},t("div",{class:"flex items-center justify-between"},t("span",{class:"text-xs font-medium truncate",style:"color: var(--text-secondary)"},m),t("div",{class:"flex gap-1 flex-shrink-0"},e===1&&t("button",{class:"t-btn text-xs px-2 py-0.5",style:"background: var(--status-healthy-glow); color: var(--status-healthy); border: none;",onClick:()=>o(b.map(h=>h.entity_id),"included")},"Include All"),e===2&&t(V,null,t("button",{class:"t-btn text-xs px-2 py-0.5",style:"background: var(--status-healthy-glow); color: var(--status-healthy); border: none;",onClick:()=>o(b.map(h=>h.entity_id),"included")},"Approve All"),t("button",{class:"t-btn text-xs px-2 py-0.5",style:"background: var(--status-error-glow); color: var(--status-error); border: none;",onClick:()=>o(b.map(h=>h.entity_id),"excluded")},"Reject All")))),t("div",{class:"space-y-1"},b.slice(0,Un).map(h=>t(zd,{key:h.entity_id,entity:h,onOverride:s,compact:!0})),b.length>Un&&t("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"...and ",b.length-Un," more")))):t("div",{class:"space-y-1"},g.slice(0,Vn).map(m=>t(zd,{key:m.entity_id,entity:m,onOverride:s})),g.length>Vn&&t("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"Showing ",Vn," of ",g.length,". Use search to narrow."))))}function zd({entity:e,onOverride:a,compact:r}){let n=im[e.status]||"background: var(--bg-surface-raised); color: var(--text-secondary);";return t("div",{class:`flex items-center gap-2 ${r?"py-0.5":"py-1.5"}`,style:r?"":"border-bottom: 1px solid var(--border-subtle)"},t("span",{class:"text-xs truncate flex-1 data-mono",style:"color: var(--text-secondary)"},e.entity_id),t("span",{class:"text-[10px] font-medium flex-shrink-0 px-1.5 py-0.5",style:`border-radius: var(--radius); ${n}`},e.status),e.human_override&&t("span",{class:"text-[10px] flex-shrink-0",style:"color: var(--accent-dim)"},"manual"),!r&&t("div",{class:"flex gap-1 flex-shrink-0"},e.status!=="included"&&t("button",{class:"text-[10px]",style:"color: var(--status-healthy)",onClick:()=>a(e.entity_id,"included")},"Include"),e.status!=="excluded"&&t("button",{class:"text-[10px]",style:"color: var(--status-error)",onClick:()=>a(e.entity_id,"excluded")},"Exclude")))}function Jo(){let[e,a]=N([]),[r,n]=N(null),[s,o]=N(!0),[l,i]=N(null);async function u(){o(!0),i(null);try{let[h,C]=await Promise.all([ce("/api/curation"),ce("/api/curation/summary")]);a(h.curations||[]),n(C)}catch(h){i(h.message||String(h))}finally{o(!1)}}async function d(h,C){try{await fa(`/api/curation/${h}`,{status:C}),await u()}catch(A){console.error("Override failed:",A)}}async function g(h,C){try{await wn("/api/curation/bulk",{entity_ids:h,status:C}),await u()}catch(A){console.error("Bulk update failed:",A)}}le(()=>{u()},[]);let f=e.filter(h=>h.tier===1),m=e.filter(h=>h.tier===2),b=e.filter(h=>h.tier===3);return s&&e.length===0?t("div",{class:"space-y-6"},t("div",null,t("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Data Curation"),t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Classify entities into include/exclude tiers for the shadow engine.")),t(Pe,{type:"full"})):l?t("div",{class:"space-y-6"},t("div",null,t("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Data Curation"),t("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Classify entities into include/exclude tiers for the shadow engine.")),t(we,{error:l,onRetry:u})):e.length===0?t("div",{class:"space-y-6"},t(ve,{page:"CURATION",subtitle:"Entity-level noise control and classification."}),t("div",{class:"t-callout",style:"padding: 1rem;"},t("span",{class:"text-sm",style:"color: var(--text-secondary)"},"No entity classifications yet. The data quality module will classify entities after discovery runs."))):t("div",{class:"space-y-6 animate-page-enter"},t(ve,{page:"CURATION",subtitle:"Entity-level noise control and classification."}),t(ze,{value:r?.per_status?.included??0,label:"entities included",delta:`${r?.per_status?.excluded??0} excluded`}),t(cm,{summary:r}),t("div",{class:"space-y-4 stagger-children"},t(Ko,{tier:1,label:"Auto-Excluded",entities:f,defaultOpen:!1,onOverride:d,onBulk:g}),t(Ko,{tier:2,label:"Edge Cases",entities:m,defaultOpen:!0,onOverride:d,onBulk:g}),t(Ko,{tier:3,label:"Included",entities:b,defaultOpen:!0,onOverride:d,onBulk:g})))}var Fd=[{day:"Day 1",title:"Collecting",desc:"Connects to Home Assistant and starts watching. Every light switch, door sensor, thermostat change, and motion event gets recorded. Zero configuration."},{day:"Days 2\u20133",title:"Baselines",desc:'After 24 hours, ARIA knows what "normal" looks like. Builds hourly averages for every metric \u2014 lights on at 8pm, power draw at noon, motion patterns.'},{day:"Days 3\u20137",title:"ML Training",desc:"Six ML algorithms start training \u2014 predicting which room activates next, when devices turn on, energy patterns. Models improve with every snapshot."},{day:"Week 2+",title:"Shadow Mode",desc:'Predicts silently and scores itself. "What I predicted" vs "what happened." Accuracy climbs daily. Nothing changes in your home yet.'},{day:"When ready",title:"Suggestions",desc:"Once accuracy gates pass, generates automation YAML. You review and approve each one. Nothing runs without your sign-off."}],dm=[{title:"Home",path:"/",desc:"Live pipeline flowchart \u2014 data flow, module health, status chips."},{title:"Discovery",path:"/discovery",desc:"Every entity, device, and area HA knows about. Unavailable devices flagged."},{title:"Capabilities",path:"/capabilities",desc:"Detected capabilities \u2014 lighting, climate, presence. Scopes automations to your setup."},{title:"Data Curation",path:"/data-curation",desc:"Include or exclude entities. Filter noisy sensors that confuse models."},{title:"Intelligence",path:"/intelligence",desc:"Baselines, predictions vs actuals, trends, correlations, daily LLM insights."},{title:"Predictions",path:"/predictions",desc:"ML outputs with confidence scores. Green/yellow/red. Improves daily."},{title:"Patterns",path:"/patterns",desc:"Recurring event sequences \u2014 basis for automation suggestions."},{title:"Shadow Mode",path:"/shadow",desc:"Accuracy tracking, disagreements, pipeline stage progression."},{title:"Automations",path:"/automations",desc:"Ready-to-use YAML from detected patterns. Review, approve, or reject."},{title:"Settings",path:"/settings",desc:"Engine parameters \u2014 thresholds, schedules, weights. Defaults work well."}],Bd=[{q:"Does ARIA send my data anywhere?",a:"No. scikit-learn for ML, optionally Ollama for LLM. Zero data leaves your network."},{q:"Will it change my HA setup?",a:"Never without permission. Read-only from HA. Suggestions require manual approval."},{q:"How long until it's useful?",a:"Baselines within 24h. Patterns in 2\u20133 days. ML predictions after a week. Solid suggestions in 2\u20133 weeks."},{q:'Why does everything show "Blocked"?',a:"Normal for the first few days. Each module waits for upstream data. Home page shows exactly what\u2019s needed."},{q:"What is Shadow Mode?",a:"Silent predictions compared to reality. Like a co-pilot building a track record before acting."},{q:"Do I need to configure anything?",a:"No. Auto-discovers devices, classifies entities, builds models. Data Curation lets you fine-tune if needed."}],um=[{term:"Entity",def:"Anything HA tracks \u2014 light, sensor, lock, motion detector."},{term:"Baseline",def:'Hourly averages of "normal." Flags when something is unusual for that time of day.'},{term:"Shadow Prediction",def:"Silent prediction scored against reality. Builds track record before action."},{term:"Pipeline",def:"Data path: collection \u2192 learning \u2192 action. Each stage gates the next."},{term:"Curation",def:"Choosing which entities ARIA watches. Filters noise so models learn clean signals."},{term:"Accuracy Gate",def:"Quality checkpoint. No suggestions until predictions hit minimum accuracy."}];function pm(){return t("div",{class:"relative overflow-hidden px-6 py-8 mb-6 t-terminal-bg",style:"background: var(--bg-surface); border-radius: var(--radius);"},t("div",{class:"absolute inset-0 pointer-events-none",style:"opacity: 0.04"},t("div",{class:"t1-scan-line",style:"width: 100%; height: 2px; background: var(--accent);"})),t("div",{class:"relative"},t(ve,{page:"GUIDE",subtitle:"How ARIA learns and what each page does."}),t("p",{class:"text-lg font-semibold leading-snug mb-3 animate-fade-in delay-200",style:"color: var(--text-primary);"},"Your home generates 22,000+ events every day."," ",t("span",{style:"color: var(--accent);"},"ARIA learns what they mean.")),t("p",{class:"text-sm leading-relaxed animate-fade-in delay-300",style:"color: var(--text-tertiary);"},"Local ML. No cloud. No subscriptions. Watches Home Assistant, learns patterns, generates automation suggestions.")))}function fm(){return t("div",{class:"px-4 py-3 mb-6",style:"background: var(--bg-surface-raised); border-left: 3px solid var(--accent); border-radius: var(--radius);"},t("p",{class:"text-sm",style:"color: var(--text-secondary);"},t("span",{class:"font-semibold",style:"color: var(--accent);"},"Fully local.")," ","ML via scikit-learn, optional LLM via Ollama. No API calls, no telemetry, no cloud accounts."))}function vm(){return t("div",{class:"mb-6 overflow-hidden",style:"background: var(--bg-surface-raised); border-radius: var(--radius);"},t("div",{class:"px-5 pt-4 pb-2"},t("h2",{class:"text-sm font-bold uppercase tracking-wider",style:"color: var(--accent); letter-spacing: 0.06em;"},"How ARIA Learns")),t("div",{class:"px-5 pb-4"},t("div",{class:"space-y-0 stagger-children"},Fd.map((e,a)=>t("div",{key:a,class:"flex gap-4 items-start py-3",style:a<Fd.length-1?"border-bottom: 1px solid var(--border-subtle);":""},t("div",{class:"shrink-0 w-6 h-6 flex items-center justify-center text-xs font-bold",style:"background: var(--accent); color: var(--bg-surface); border-radius: var(--radius);"},a+1),t("div",{class:"flex-1 min-w-0"},t("div",{class:"flex items-baseline gap-2 mb-0.5"},t("span",{class:"text-xs",style:"color: var(--accent-dim); font-family: var(--font-mono);"},e.day),t("span",{class:"text-sm font-semibold",style:"color: var(--text-primary);"},e.title)),t("p",{class:"text-sm leading-relaxed",style:"color: var(--text-tertiary);"},e.desc)))))))}function mm(){return t("div",{class:"mb-6 overflow-hidden",style:"background: var(--bg-surface-raised); border-radius: var(--radius);"},t("div",{class:"px-5 pt-4 pb-2"},t("h2",{class:"text-sm font-bold uppercase tracking-wider",style:"color: var(--accent); letter-spacing: 0.06em;"},"Key Concepts")),t("div",{class:"px-5 pb-4 grid grid-cols-1 sm:grid-cols-2 gap-3 stagger-children"},um.map((e,a)=>t("div",{key:a,class:"px-3 py-2.5",style:"background: var(--bg-surface); border: 1px solid var(--border-subtle); border-radius: var(--radius);"},t("h3",{class:"text-sm font-bold mb-0.5",style:"color: var(--accent);"},e.term),t("p",{class:"text-xs leading-relaxed",style:"color: var(--text-tertiary);"},e.def)))))}function ym(){return t("div",{class:"mb-6 overflow-hidden",style:"background: var(--bg-surface-raised); border-radius: var(--radius);"},t("div",{class:"px-5 pt-4 pb-2"},t("h2",{class:"text-sm font-bold uppercase tracking-wider",style:"color: var(--accent); letter-spacing: 0.06em;"},"Pages")),t("div",{class:"stagger-children"},dm.map((e,a)=>t("a",{key:a,href:`#${e.path}`,class:"flex items-baseline gap-3 px-5 py-2.5 transition-colors",style:"border-bottom: 1px solid var(--border-subtle);",onMouseEnter:r=>{r.currentTarget.style.background="var(--bg-surface)"},onMouseLeave:r=>{r.currentTarget.style.background="transparent"}},t("span",{class:"text-sm font-semibold shrink-0",style:"color: var(--accent); min-width: 7rem;"},e.title),t("span",{class:"text-sm",style:"color: var(--text-tertiary);"},e.desc)))))}function gm(){return t("div",{class:"mb-6 overflow-hidden",style:"background: var(--bg-surface-raised); border-radius: var(--radius);"},t("div",{class:"px-5 pt-4 pb-2"},t("h2",{class:"text-sm font-bold uppercase tracking-wider",style:"color: var(--accent); letter-spacing: 0.06em;"},"FAQ")),t("div",{class:"px-5 pb-4 space-y-0 stagger-children"},Bd.map((e,a)=>t("div",{key:a,class:"py-3",style:a<Bd.length-1?"border-bottom: 1px solid var(--border-subtle);":""},t("h3",{class:"text-sm font-semibold mb-1",style:"color: var(--text-primary);"},e.q),t("p",{class:"text-sm leading-relaxed",style:"color: var(--text-tertiary);"},e.a)))))}function Zo(){return t("div",{class:"max-w-3xl mx-auto animate-page-enter"},t(pm,null),t(fm,null),t(vm,null),t(mm,null),t(ym,null),t(gm,null),t("div",{class:"text-center pb-6"},t("a",{href:"#/",class:"inline-flex items-center gap-2 px-5 py-2.5 text-sm font-semibold transition-colors",style:"background: var(--accent); color: var(--bg-surface); border-radius: var(--radius);"},"Go to Dashboard")))}function xm(){let e=[];function a(){let s=(window.location.hash||"#/").replace(/^#/,"")||"/",o=s.indexOf("?");return{pathname:o>=0?s.slice(0,o):s,search:o>=0?s.slice(o):""}}function r(){let n=a();e.forEach(s=>s({location:n}))}return window.addEventListener("hashchange",r),window.location.hash||(window.location.hash="#/"),{get location(){return a()},listen(n){return e.push(n),()=>{let s=e.indexOf(n);s>=0&&e.splice(s,1)}},push(n){window.location.hash="#"+n},replace(n){let s=window.location.pathname+window.location.search+"#"+n;window.history.replaceState(null,"",s),window.dispatchEvent(new HashChangeEvent("hashchange"))}}}var bm=xm(),Qo=class extends Kt{state={error:null};componentDidCatch(a){this.setState({error:a})}render(){return this.state.error?t(we,{error:this.state.error,onRetry:()=>this.setState({error:null})}):this.props.children}};function Xo(){return le(()=>(Os(),()=>hi()),[]),t("div",{class:"min-h-screen",style:"background: var(--bg-base); color: var(--text-primary); transition: background 0.3s ease, color 0.3s ease;"},t(js,null),t("main",{class:"lg:ml-60 sm:ml-14 pb-16 sm:pb-0 min-h-screen"},t("div",{class:"max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8"},t(Qo,null,t(Ls,{history:bm},t(Ao,{path:"/"}),t(Lo,{path:"/discovery"}),t(Io,{path:"/capabilities"}),t(No,{path:"/predictions"}),t(Oo,{path:"/patterns"}),t(zo,{path:"/automations"}),t(Wo,{path:"/intelligence"}),t(Go,{path:"/ml-engine"}),t(qo,{path:"/shadow"}),t(Yo,{path:"/settings"}),t(Jo,{path:"/data-curation"}),t(Zo,{path:"/guide"}))))))}Vl(t(Xo,null),document.getElementById("app"));
